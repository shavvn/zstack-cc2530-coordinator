###############################################################################
#                                                                             #
# IAR C/C++ Compiler V7.60.1.40026 for 8051             08/Apr/2014  21:42:38 #
# Copyright (C) 2004-2010 IAR Systems AB.                                     #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\zigbee\projects\zstack-cc2530-coordinator\Compo #
#                          nents\stack\zdo\ZDApp.c                            #
#    Command line       =  -f D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \Tools\CC2530DB\f8wCoord.cfg (-DCPU32MHZ           #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8       #
#                          -DMAC_CFG_RX_MAX=5 -DZDO_COORDINATOR -DRTR_NWK)    #
#                          -f D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \Tools\CC2530DB\f8wConfig.cfg (-DZIGBEEPRO         #
#                          -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR       #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0x1111                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 D:\zigbee\projects\zstack-c #
#                          c2530-coordinator\Components\stack\zdo\ZDApp.c -D  #
#                          ZAPP_P1 -D MT_TASK -D MT_SYS_FUNC -D MT_ZDO_FUNC   #
#                          -D LCD_SUPPORTED=DEBUG -lC                         #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\Coordinator #
#                          EB\List\ -lA D:\zigbee\projects\zstack-cc2530-coor #
#                          dinator\Projects\zstack\Samples\GenericApp\CC2530D #
#                          B\CoordinatorEB\List\ --diag_suppress Pe001,Pa010  #
#                          -o D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\Coordina #
#                          torEB\Obj\ -e --require_prototypes                 #
#                          --no_code_motion --debug --core=plain --dptr=16,1  #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\ -I      #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\Source\  #
#                          -I D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \ZMain\TI2530DB\ -I D:\zigbee\projects\zstack-cc25 #
#                          30-coordinator\Projects\zstack\Samples\GenericApp\ #
#                          CC2530DB\..\..\..\..\..\Components\hal\include\    #
#                          -I D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \..\..\Components\hal\target\CC2530EB\ -I          #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\mac\include\ -I                     #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\mac\high_level\ -I                  #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\mac\low_level\srf04\ -I             #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\mac\low_level\srf04\single_chip\    #
#                          -I D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \..\..\Components\mt\ -I                           #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\osal\include\ -I                    #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\osal\mcu\ccsoc\ -I                  #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\services\saddr\ -I                  #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\services\sdata\ -I                  #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\af\ -I                        #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\nwk\ -I                       #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\sapi\ -I                      #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\sec\ -I                       #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\sys\ -I                       #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\zdo\ -I                       #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\zmac\ -I D:\zigbee\projects\zstack- #
#                          cc2530-coordinator\Projects\zstack\Samples\Generic #
#                          App\CC2530DB\..\..\..\..\..\Components\zmac\f8w\   #
#                          -I "C:\Program Files (x86)\IAR Systems\Embedded    #
#                          Workbench 5.4\8051\INC\" -I "C:\Program Files      #
#                          (x86)\IAR Systems\Embedded Workbench               #
#                          5.4\8051\INC\CLIB\" -Ohz                           #
#    List file          =  D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\Coordinator #
#                          EB\List\ZDApp.lst                                  #
#    Object file        =  D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\Coordinator #
#                          EB\Obj\ZDApp.r51                                   #
#                                                                             #
#                                                                             #
###############################################################################

D:\zigbee\projects\zstack-cc2530-coordinator\Components\stack\zdo\ZDApp.c
      1          /**************************************************************************************************
      2            Filename:       ZDApp.c
      3            Revised:        $Date: 2010-09-17 16:25:30 -0700 (Fri, 17 Sep 2010) $
      4            Revision:       $Revision: 23835 $
      5          
      6            Description:    This file contains the interface to the Zigbee Device Application. This is the
      7                            Application part that the user can change. This also contains the Task functions.
      8          
      9          
     10            Copyright 2004-2010 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com. 
     39          **************************************************************************************************/
     40          
     41          /*********************************************************************
     42           * INCLUDES
     43           */
     44          
     45          #include "ZComDef.h"
     46          #include "ZMac.h"
     47          #include "OSAL.h"
     48          #include "OSAL_Tasks.h"
     49          #include "OSAL_PwrMgr.h"
     50          #include "OSAL_Nv.h"
     51          #include "AF.h"
     52          #include "APSMEDE.h"
     53          #include "NLMEDE.h"
     54          #include "AddrMgr.h"
     55          #include "ZDProfile.h"
     56          #include "ZDObject.h"
     57          #include "ZDConfig.h"
     58          #include "ZDSecMgr.h"
     59          #include "ZDApp.h"
     60          #include "DebugTrace.h"
     61          #include "nwk_util.h"
     62          #include "OnBoard.h"
     63          #include "ZGlobals.h"
     64          #include "ZDNwkMgr.h"
     65          #include "rtg.h"
     66          
     67          #include "ssp.h"
     68          
     69          /* HAL */
     70          #include "hal_led.h"
     71          #include "hal_lcd.h"
     72          #include "hal_key.h"
     73          
     74          #if defined( MT_MAC_FUNC ) || defined( MT_MAC_CB_FUNC )
     75            #error "ERROR! MT_MAC functionalities should be disabled on ZDO devices"
     76          #endif
     77          
     78          /*********************************************************************
     79           * CONSTANTS
     80           */
     81          
     82          #if !defined( NWK_START_DELAY )
     83            #define NWK_START_DELAY             100   // in milliseconds
     84          #endif
     85          
     86          // Init ZDO, but hold and wait for application to start the joining or 
     87          // forming network
     88          #define ZDO_INIT_HOLD_NWK_START       0xFFFF  
     89          
     90          #if !defined( EXTENDED_JOINING_RANDOM_MASK )
     91            #define EXTENDED_JOINING_RANDOM_MASK 0x007F
     92          #endif
     93          
     94          #if !defined( BEACON_REQUEST_DELAY )
     95            #define BEACON_REQUEST_DELAY        100   // in milliseconds
     96          #endif
     97          
     98          #if !defined( BEACON_REQ_DELAY_MASK )
     99            #define BEACON_REQ_DELAY_MASK       0x007F
    100          #endif
    101          
    102          #define MAX_RESUME_RETRY            3
    103          
    104          #define MAX_DEVICE_UNAUTH_TIMEOUT   5000  // 5 seconds
    105          
    106          // Beacon Order Settings (see NLMEDE.h)
    107          #define DEFAULT_BEACON_ORDER        BEACON_ORDER_NO_BEACONS
    108          #define DEFAULT_SUPERFRAME_ORDER    DEFAULT_BEACON_ORDER
    109          
    110          #if !defined( MAX_NWK_FRAMECOUNTER_CHANGES )
    111            // The number of times the frame counter can change before
    112            // saving to NV
    113            #define MAX_NWK_FRAMECOUNTER_CHANGES    1000
    114          #endif
    115          
    116          // Leave control bits
    117          #define ZDAPP_LEAVE_CTRL_INIT 0
    118          #define ZDAPP_LEAVE_CTRL_SET  1
    119          #define ZDAPP_LEAVE_CTRL_RA   2
    120          
    121          // Address Manager Stub Implementation
    122          #define ZDApp_NwkWriteNVRequest AddrMgrWriteNVRequest
    123          
    124          
    125          #if !defined ZDO_NV_SAVE_RFDs
    126          #define ZDO_NV_SAVE_RFDs  TRUE
    127          #endif
    128          
    129          // Delay time before updating NWK NV data to force fewer writes during high activity.
    130          #if ZDO_NV_SAVE_RFDs
    131          #define ZDAPP_UPDATE_NWK_NV_TIME 700
    132          #else
    133          #define ZDAPP_UPDATE_NWK_NV_TIME 65000
    134          #endif
    135          
    136          /*********************************************************************
    137           * GLOBAL VARIABLES
    138           */
    139          
    140          #if defined( LCD_SUPPORTED )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    141            uint8 MatchRsps = 0;
   \                     MatchRsps:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    142          #endif
    143          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    144          uint8 zdoDiscCounter = 1;
   \                     zdoDiscCounter:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for zdoDiscCounter>`
   \   000001                REQUIRE __INIT_XDATA_I
    145          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    146          zAddrType_t ZDAppNwkAddr;
   \                     ZDAppNwkAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z
    147          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    148          uint8 zdappMgmtNwkDiscRspTransSeq;
   \                     zdappMgmtNwkDiscRspTransSeq:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    149          uint8 zdappMgmtNwkDiscReqInProgress = FALSE;
   \                     zdappMgmtNwkDiscReqInProgress:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    150          zAddrType_t zdappMgmtNwkDiscRspAddr;
   \                     zdappMgmtNwkDiscRspAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    151          uint8 zdappMgmtNwkDiscStartIndex;
   \                     zdappMgmtNwkDiscStartIndex:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    152          uint8 zdappMgmtSavedNwkState;
   \                     zdappMgmtSavedNwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    153          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    154          uint16 nwkFrameCounterChanges = 0;
   \                     nwkFrameCounterChanges:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    155          uint8 continueJoining = TRUE;
   \                     continueJoining:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for continueJoining>`
   \   000001                REQUIRE __INIT_XDATA_I
    156          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    157          uint8  _tmpRejoinState;
   \                     _tmpRejoinState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    158          
    159          // The extended PanID used in ZDO layer for rejoin.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    160          uint8 ZDO_UseExtendedPANID[Z_EXTADDR_LEN];
   \                     ZDO_UseExtendedPANID:
   \   000000                DS 8
   \   000008                REQUIRE __INIT_XDATA_Z
    161          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    162          pfnZdoCb zdoCBFunc[MAX_ZDO_CB_FUNC];
   \                     zdoCBFunc:
   \   000000                DS 10
   \   00000A                REQUIRE __INIT_XDATA_Z
    163          
    164          /*********************************************************************
    165           * EXTERNAL VARIABLES
    166           */
    167          
    168          /*********************************************************************
    169           * EXTERNAL FUNCTIONS
    170           */
    171          
    172          /*********************************************************************
    173           * LOCAL FUNCTIONS
    174           */
    175          
    176          void ZDApp_NetworkStartEvt( void );
    177          void ZDApp_DeviceAuthEvt( void );
    178          void ZDApp_SaveNetworkStateEvt( void );
    179          
    180          uint8 ZDApp_ReadNetworkRestoreState( void );
    181          uint8 ZDApp_RestoreNetworkState( void );
    182          void ZDAppDetermineDeviceType( void );
    183          void ZDApp_InitUserDesc( void );
    184          void ZDAppCheckForHoldKey( void );
    185          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr );
    186          void ZDApp_ProcessNetworkJoin( void );
    187          void ZDApp_SetCoordAddress( uint8 endPoint, uint8 dstEP );
    188          void ZDApp_SaveNwkKey( void );
    189          uint8 ZDApp_RestoreNwkKey( void );
    190          networkDesc_t* ZDApp_NwkDescListProcessing(void);  
    191          
    192          void ZDApp_SecInit( uint8 state );
    193          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events );
    194          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr );
    195          
    196          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf );
    197          
    198          void ZDApp_ResetTimerStart( uint16 delay );
    199          void ZDApp_ResetTimerCancel( void );
    200          void ZDApp_LeaveCtrlInit( void );
    201          void ZDApp_LeaveCtrlSet( uint8 ra );
    202          uint8 ZDApp_LeaveCtrlBypass( void );
    203          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay );
    204          void ZDApp_LeaveReset( uint8 ra );
    205          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
    206                                  uint8 removeChildren );
    207          void ZDApp_NodeProfileSync( uint8 stackProfile );
    208          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg );
    209          void ZDApp_RegisterCBs( void );
    210          void ZDApp_InitZdoCBFunc(void);
    211          
    212          /*********************************************************************
    213           * LOCAL VARIABLES
    214           */
    215          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    216          uint8 ZDAppTaskID;
   \                     ZDAppTaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    217          uint8 nwkStatus;
   \                     nwkStatus:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    218          endPointDesc_t *ZDApp_AutoFindMode_epDesc = (endPointDesc_t *)NULL;
   \                     ZDApp_AutoFindMode_epDesc:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    219          uint8 ZDApp_LeaveCtrl;
   \                     ZDApp_LeaveCtrl:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    220          
    221          #if defined( HOLD_AUTO_START )
    222            devStates_t devState = DEV_HOLD;
    223          #else

   \                                 In  segment XDATA_I, align 1, keep-with-next
    224            devStates_t devState = DEV_INIT;
   \                     devState:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for devState>`
   \   000001                REQUIRE __INIT_XDATA_I
    225          #endif
    226          
    227          #if ( ZG_BUILD_RTRONLY_TYPE ) || ( ZG_BUILD_ENDDEVICE_TYPE )
    228            devStartModes_t devStartMode = MODE_JOIN;     // Assume joining
    229            //devStartModes_t devStartMode = MODE_RESUME; // if already "directly joined"
    230                                  // to parent. Set to make the device do an Orphan scan.
    231          #else
    232            // Set the default to coodinator

   \                                 In  segment XDATA_I, align 1, keep-with-next
    233            devStartModes_t devStartMode = MODE_HARD;
   \                     devStartMode:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for devStartMode>`
   \   000001                REQUIRE __INIT_XDATA_I
    234          #endif
    235          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    236          uint8 retryCnt;
   \                     retryCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    237          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    238          endPointDesc_t ZDApp_epDesc =
   \                     ZDApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE `?<Initializer for ZDApp_epDesc>`
   \   000006                REQUIRE __INIT_XDATA_I
    239          {
    240            ZDO_EP,
    241            &ZDAppTaskID,
    242            (SimpleDescriptionFormat_t *)NULL,  // No Simple description for ZDO
    243            (afNetworkLatencyReq_t)0            // No Network Latency req
    244          };
    245          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    246          uint16 ZDApp_SavedPollRate = POLL_RATE;
   \                     ZDApp_SavedPollRate:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for ZDApp_SavedPollRate>`
   \   000002                REQUIRE __INIT_XDATA_I
    247          
    248          /*********************************************************************
    249           * @fn      ZDApp_Init
    250           *
    251           * @brief   ZDApp Initialization function.
    252           *
    253           * @param   task_id - ZDApp Task ID
    254           *
    255           * @return  None
    256           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    257          void ZDApp_Init( uint8 task_id )
   \                     ZDApp_Init:
    258          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    259            // Save the task ID
    260            ZDAppTaskID = task_id;
   \   000006   90....       MOV     DPTR,#ZDAppTaskID
   \   000009   F0           MOVX    @DPTR,A
    261          
    262            // Initialize the ZDO global device short address storage
    263            ZDAppNwkAddr.addrMode = Addr16Bit;
   \   00000A   7402         MOV     A,#0x2
   \   00000C   90....       MOV     DPTR,#(ZDAppNwkAddr + 8)
   \   00000F   F0           MOVX    @DPTR,A
    264            ZDAppNwkAddr.addr.shortAddr = INVALID_NODE_ADDR;
   \   000010   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000013   74FE         MOV     A,#-0x2
   \   000015   F0           MOVX    @DPTR,A
   \   000016   A3           INC     DPTR
   \   000017   74FF         MOV     A,#-0x1
   \   000019   F0           MOVX    @DPTR,A
    265            (void)NLME_GetExtAddr();  // Load the saveExtAddr pointer.
   \   00001A                ; Setup parameters for call to function NLME_GetExtAddr
   \   00001A   12....       LCALL   ??NLME_GetExtAddr?relay
    266          
    267            // Check for manual "Hold Auto Start"
    268            ZDAppCheckForHoldKey();
   \   00001D                ; Setup parameters for call to function ZDAppCheckForHoldKey
   \   00001D   12....       LCALL   ??ZDAppCheckForHoldKey?relay
    269          
    270            // Initialize ZDO items and setup the device - type of device to create.
    271            ZDO_Init();
   \   000020                ; Setup parameters for call to function ZDO_Init
   \   000020   12....       LCALL   ??ZDO_Init?relay
    272          
    273            // Register the endpoint description with the AF
    274            // This task doesn't have a Simple description, but we still need
    275            // to register the endpoint.
    276            afRegister( (endPointDesc_t *)&ZDApp_epDesc );
   \   000023                ; Setup parameters for call to function afRegister
   \   000023   7A..         MOV     R2,#(ZDApp_epDesc & 0xff)
   \   000025   7B..         MOV     R3,#((ZDApp_epDesc >> 8) & 0xff)
   \   000027   12....       LCALL   ??afRegister?relay
    277          
    278          #if defined( ZDO_USERDESC_RESPONSE )
    279            ZDApp_InitUserDesc();
   \   00002A                ; Setup parameters for call to function ZDApp_InitUserDesc
   \   00002A   12....       LCALL   ??ZDApp_InitUserDesc?relay
    280          #endif // ZDO_USERDESC_RESPONSE
    281          
    282            // Start the device?
    283            if ( devState != DEV_HOLD )
   \   00002D   90....       MOV     DPTR,#devState
   \   000030   E0           MOVX    A,@DPTR
   \   000031   6009         JZ      ??ZDApp_Init_0
    284            {
    285              ZDOInitDevice( 0 );
   \   000033                ; Setup parameters for call to function ZDOInitDevice
   \   000033   7A00         MOV     R2,#0x0
   \   000035   7B00         MOV     R3,#0x0
   \   000037   12....       LCALL   ??ZDOInitDevice?relay
   \   00003A   8014         SJMP    ??ZDApp_Init_1
    286            }
    287            else
    288            {
    289              ZDOInitDevice( ZDO_INIT_HOLD_NWK_START );
   \                     ??ZDApp_Init_0:
   \   00003C                ; Setup parameters for call to function ZDOInitDevice
   \   00003C   7AFF         MOV     R2,#-0x1
   \   00003E   7BFF         MOV     R3,#-0x1
   \   000040   12....       LCALL   ??ZDOInitDevice?relay
    290              // Blink LED to indicate HOLD_START
    291              HalLedBlink ( HAL_LED_4, 0, 50, 500 );
   \   000043                ; Setup parameters for call to function HalLedBlink
   \   000043   7CF4         MOV     R4,#-0xc
   \   000045   7D01         MOV     R5,#0x1
   \   000047   7B32         MOV     R3,#0x32
   \   000049   7A00         MOV     R2,#0x0
   \   00004B   7908         MOV     R1,#0x8
   \   00004D   12....       LCALL   ??HalLedBlink?relay
    292            }
    293            
    294            // Initialize the ZDO callback function pointers zdoCBFunc[]
    295            ZDApp_InitZdoCBFunc();
   \                     ??ZDApp_Init_1:
   \   000050                ; Setup parameters for call to function ZDApp_InitZdoCBFunc
   \   000050   12....       LCALL   ??ZDApp_InitZdoCBFunc?relay
    296            
    297            ZDApp_RegisterCBs();
   \   000053                ; Setup parameters for call to function ZDApp_RegisterCBs
   \   000053   12....       LCALL   ??ZDApp_RegisterCBs?relay
    298          } /* ZDApp_Init() */
   \   000056   02....       LJMP    ??Subroutine43_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine43_0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    299          
    300          /*********************************************************************
    301           * @fn          ZDApp_SecInit
    302           *
    303           * @brief       ZDApp initialize security.
    304           *
    305           * @param       state - device initialization state
    306           *
    307           * @return      none
    308           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    309          void ZDApp_SecInit( uint8 state )
   \                     ZDApp_SecInit:
    310          {  
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    311            uint8 zgPreConfigKey[SEC_KEY_LEN];
    312          
    313            if ( ZG_SECURE_ENABLED && ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    314            {
    315              // Set the Trust Center bit
    316              ZDO_Config_Node_Descriptor.ServerMask |= PRIM_TRUST_CENTER;
    317            }
    318          
    319            if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
    320            {
    321              ZDO_Config_Node_Descriptor.CapabilityFlags |= CAPINFO_SECURITY_CAPABLE;
    322            }
    323              
    324            // Initialize ZigBee Device Security Manager
    325            ZDSecMgrInit(state);
   \   000005                ; Setup parameters for call to function ZDSecMgrInit
   \   000005   12....       LCALL   ??ZDSecMgrInit?relay
    326          
    327            if ( ZG_SECURE_ENABLED )
    328            {
    329              if ( state != ZDO_INITDEV_RESTORED_NETWORK_STATE )
    330              {
    331                nwkFrameCounter = 0;
    332            
    333                if( _NIB.nwkKeyLoaded == FALSE )
    334                {
    335                  if ( ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE          ) ||
    336                       ( ( zgSecurityMode == ZG_SECURITY_RESIDENTIAL ) && zgPreConfigKeys )    )
    337                  {
    338                      ZDSecMgrReadKeyFromNv(ZCD_NV_PRECFGKEY, zgPreConfigKey);
    339                      SSP_UpdateNwkKey( zgPreConfigKey, 0);
    340                      SSP_SwitchNwkKey( 0 );
    341                      
    342                      // clear local copy of key
    343                      osal_memset(zgPreConfigKey, 0x00, SEC_KEY_LEN);
    344                  }
    345                }
    346              }
    347            }    
    348          }
   \   000008   02....       LJMP    ??Subroutine43_0 & 0xFFFF
    349          
    350          /*********************************************************************
    351           * @fn      ZDApp_event_loop()
    352           *
    353           * @brief   Main event loop for Zigbee device objects task. This function
    354           *          should be called at periodic intervals.
    355           *
    356           * @param   task_id - Task ID
    357           * @param   events  - Bitmap of events
    358           *
    359           * @return  none
    360           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    361          UINT16 ZDApp_event_loop( uint8 task_id, UINT16 events )
   \                     ZDApp_event_loop:
    362          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    363            uint8 *msg_ptr;
    364          
    365            if ( events & SYS_EVENT_MSG )
   \   000009   7480         MOV     A,#-0x80
   \   00000B   5F           ANL     A,R7
   \   00000C   F9           MOV     R1,A
   \   00000D   E4           CLR     A
   \   00000E   7001         JNZ     ??ZDApp_event_loop_0
   \   000010   E9           MOV     A,R1
   \                     ??ZDApp_event_loop_0:
   \   000011   7031         JNZ     ??ZDApp_event_loop_1
    366            {
    367              while ( (msg_ptr = osal_msg_receive( ZDAppTaskID )) )
    368              {
    369                ZDApp_ProcessOSALMsg( (osal_event_hdr_t *)msg_ptr );
    370          
    371                // Release the memory
    372                osal_msg_deallocate( msg_ptr );
    373              }
    374          
    375              // Return unprocessed events
    376              return (events ^ SYS_EVENT_MSG);
    377            }
    378          
    379            if ( events & ZDO_NETWORK_INIT )
   \   000013   EE           MOV     A,R6
   \   000014   A2E0         MOV     C,0xE0 /* A   */.0
   \   000016   5045         JNC     ??ZDApp_event_loop_2
    380            {
    381              // Initialize apps and start the network
    382              devState = DEV_INIT;
   \   000018   7401         MOV     A,#0x1
   \   00001A   90....       MOV     DPTR,#devState
   \   00001D   F0           MOVX    @DPTR,A
    383              
    384              ZDO_StartDevice( (uint8)ZDO_Config_Node_Descriptor.LogicalType, devStartMode,
    385                               DEFAULT_BEACON_ORDER, DEFAULT_SUPERFRAME_ORDER );
   \   00001E                ; Setup parameters for call to function ZDO_StartDevice
   \   00001E   7C0F         MOV     R4,#0xf
   \   000020   7B0F         MOV     R3,#0xf
   \   000022   90....       MOV     DPTR,#devStartMode
   \   000025   E0           MOVX    A,@DPTR
   \   000026   FA           MOV     R2,A
   \   000027   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   5407         ANL     A,#0x7
   \   00002D   F9           MOV     R1,A
   \   00002E   12....       LCALL   ??ZDO_StartDevice?relay
    386          
    387              // Return unprocessed events
    388              return (events ^ ZDO_NETWORK_INIT);
   \   000031   7401         MOV     A,#0x1
   \                     ??ZDApp_event_loop_3:
   \   000033   6E           XRL     A,R6
   \   000034   FA           MOV     R2,A
   \   000035   EF           MOV     A,R7
   \                     ??ZDApp_event_loop_4:
   \   000036   FB           MOV     R3,A
   \   000037   02....       LJMP    ??ZDApp_event_loop_5 & 0xFFFF
    389            }
   \                     ??ZDApp_event_loop_6:
   \   00003A                ; Setup parameters for call to function ZDApp_ProcessOSALMsg
   \   00003A   12....       LCALL   ??ZDApp_ProcessOSALMsg?relay
   \   00003D                ; Setup parameters for call to function osal_msg_deallocate
   \   00003D   AA..         MOV     R2,?V0 + 0
   \   00003F   AB..         MOV     R3,?V0 + 1
   \   000041   12....       LCALL   ??osal_msg_deallocate?relay
   \                     ??ZDApp_event_loop_1:
   \   000044                ; Setup parameters for call to function osal_msg_receive
   \   000044   90....       MOV     DPTR,#ZDAppTaskID
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F9           MOV     R1,A
   \   000049   12....       LCALL   ??osal_msg_receive?relay
   \   00004C   8A..         MOV     ?V0 + 0,R2
   \   00004E   8B..         MOV     ?V0 + 1,R3
   \   000050   EA           MOV     A,R2
   \   000051   7001         JNZ     ??ZDApp_event_loop_7
   \   000053   EB           MOV     A,R3
   \                     ??ZDApp_event_loop_7:
   \   000054   70E4         JNZ     ??ZDApp_event_loop_6
   \   000056   EE           MOV     A,R6
   \   000057   FA           MOV     R2,A
   \   000058   7480         MOV     A,#-0x80
   \                     ??ZDApp_event_loop_8:
   \   00005A   6F           XRL     A,R7
   \   00005B   80D9         SJMP    ??ZDApp_event_loop_4
    390          
    391            if ( ZSTACK_ROUTER_BUILD )
    392            {
    393              if ( events & ZDO_NETWORK_START )
   \                     ??ZDApp_event_loop_2:
   \   00005D   5402         ANL     A,#0x2
   \   00005F   6007         JZ      ??ZDApp_event_loop_9
    394              {
    395                ZDApp_NetworkStartEvt();
   \   000061                ; Setup parameters for call to function ZDApp_NetworkStartEvt
   \   000061   12....       LCALL   ??ZDApp_NetworkStartEvt?relay
    396            
    397                // Return unprocessed events
    398                return (events ^ ZDO_NETWORK_START);
   \   000064   7402         MOV     A,#0x2
   \                     ??ZDApp_event_loop_10:
   \   000066   80CB         SJMP    ??ZDApp_event_loop_3
    399              }
    400          
    401              if ( events & ZDO_ROUTER_START )
   \                     ??ZDApp_event_loop_9:
   \   000068   EE           MOV     A,R6
   \   000069   5420         ANL     A,#0x20
   \   00006B   601D         JZ      ??ZDApp_event_loop_11
    402              {
    403                if ( nwkStatus == ZSuccess )
   \   00006D   90....       MOV     DPTR,#nwkStatus
   \   000070   E0           MOVX    A,@DPTR
   \   000071   7010         JNZ     ??ZDApp_event_loop_12
    404                {
    405                  if ( devState == DEV_END_DEVICE )
   \   000073   90....       MOV     DPTR,#devState
   \   000076   E0           MOVX    A,@DPTR
   \   000077   6406         XRL     A,#0x6
   \   000079   7003         JNZ     ??ZDApp_event_loop_13
    406                    devState = DEV_ROUTER;
   \   00007B   7407         MOV     A,#0x7
   \   00007D   F0           MOVX    @DPTR,A
    407            
    408                  osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
   \                     ??ZDApp_event_loop_13:
   \   00007E                ; Setup parameters for call to function osal_pwrmgr_device
   \   00007E   7900         MOV     R1,#0x0
   \   000080   12....       LCALL   ??osal_pwrmgr_device?relay
    409                }
    410                else
    411                {
    412                  // remain as end device!!
    413                }
    414                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \                     ??ZDApp_event_loop_12:
   \   000083                ; Setup parameters for call to function osal_set_event
   \   000083   12....       LCALL   ?Subroutine13 & 0xFFFF
    415            
    416                // Return unprocessed events
    417                return (events ^ ZDO_ROUTER_START);
   \                     ??CrossCallReturnLabel_48:
   \   000086   7420         MOV     A,#0x20
   \   000088   80A9         SJMP    ??ZDApp_event_loop_3
    418              }
    419            }
    420            
    421            if ( events & ZDO_STATE_CHANGE_EVT )
   \                     ??ZDApp_event_loop_11:
   \   00008A   EE           MOV     A,R6
   \   00008B   5410         ANL     A,#0x10
   \   00008D   6022         JZ      ??ZDApp_event_loop_14
    422            {
    423              ZDO_UpdateNwkStatus( devState );
   \   00008F                ; Setup parameters for call to function ZDO_UpdateNwkStatus
   \   00008F   90....       MOV     DPTR,#devState
   \   000092   E0           MOVX    A,@DPTR
   \   000093   F9           MOV     R1,A
   \   000094   12....       LCALL   ??ZDO_UpdateNwkStatus?relay
    424              
    425              // At start up, do one MTO route discovery if the device is a concentrator
    426              if ( zgConcentratorEnable == TRUE ) 
   \   000097   90....       MOV     DPTR,#zgConcentratorEnable
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   6401         XRL     A,#0x1
   \   00009D   700E         JNZ     ??CrossCallReturnLabel_74
    427              {
    428                // Start next event
    429                osal_start_timerEx( NWK_TaskID, NWK_MTO_RTG_REQ_EVT, 100 );
   \   00009F                ; Setup parameters for call to function osal_start_timerEx
   \   00009F   7C64         MOV     R4,#0x64
   \   0000A1   7D00         MOV     R5,#0x0
   \   0000A3   7A00         MOV     R2,#0x0
   \   0000A5   7B08         MOV     R3,#0x8
   \   0000A7   90....       MOV     DPTR,#NWK_TaskID
   \   0000AA   12....       LCALL   ??Subroutine40_0 & 0xFFFF
    430              }
    431              
    432              // Return unprocessed events
    433              return (events ^ ZDO_STATE_CHANGE_EVT);
   \                     ??CrossCallReturnLabel_74:
   \   0000AD   7410         MOV     A,#0x10
   \   0000AF   8082         SJMP    ??ZDApp_event_loop_3
    434            }
    435          
    436            if ( events & ZDO_COMMAND_CNF )
   \                     ??ZDApp_event_loop_14:
   \   0000B1   EE           MOV     A,R6
   \   0000B2   5408         ANL     A,#0x8
   \   0000B4   6006         JZ      ??ZDApp_event_loop_15
    437            {
    438              // User defined logic
    439          
    440              // Return unprocessed events
    441              return (events ^ ZDO_COMMAND_CNF);
   \   0000B6   7408         MOV     A,#0x8
   \   0000B8   6E           XRL     A,R6
   \   0000B9   FA           MOV     R2,A
   \   0000BA   801A         SJMP    ??ZDApp_event_loop_5
    442            }
    443            
    444            if ( events & ZDO_NWK_UPDATE_NV )
   \                     ??ZDApp_event_loop_15:
   \   0000BC   7402         MOV     A,#0x2
   \   0000BE   5F           ANL     A,R7
   \   0000BF   F9           MOV     R1,A
   \   0000C0   E4           CLR     A
   \   0000C1   7001         JNZ     ??ZDApp_event_loop_16
   \   0000C3   E9           MOV     A,R1
   \                     ??ZDApp_event_loop_16:
   \   0000C4   6004         JZ      ??ZDApp_event_loop_17
    445            {
    446              ZDApp_SaveNetworkStateEvt();
    447          
    448              // Return unprocessed events
    449              return (events ^ ZDO_NWK_UPDATE_NV);
   \   0000C6   7402         MOV     A,#0x2
   \   0000C8   8090         SJMP    ??ZDApp_event_loop_8
    450            }
    451          
    452            if ( events & ZDO_DEVICE_RESET )
   \                     ??ZDApp_event_loop_17:
   \   0000CA   EE           MOV     A,R6
   \   0000CB   5404         ANL     A,#0x4
   \   0000CD   6003         JZ      ??ZDApp_event_loop_18
    453            {
    454              // The device has been in the UNAUTH state, so reset
    455              // Note: there will be no return from this call
    456              SystemResetSoft();
   \   0000CF                ; Setup parameters for call to function Onboard_soft_reset
   \   0000CF   12....       LCALL   Onboard_soft_reset & 0xFFFF
    457            }
    458          
    459            if ( ZG_SECURE_ENABLED )
    460            {
    461              return ( ZDApp_ProcessSecEvent( task_id, events ) );
    462            }
    463            else
    464            {
    465              // Discard or make more handlers
    466              return 0;
   \                     ??ZDApp_event_loop_18:
   \   0000D2   7A00         MOV     R2,#0x0
   \   0000D4   7B00         MOV     R3,#0x0
    467            }
   \                     ??ZDApp_event_loop_5:
   \   0000D6   02....       LJMP    ??Subroutine42_0 & 0xFFFF
    468          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   7A10         MOV     R2,#0x10
   \   000002                REQUIRE ??Subroutine35_0
   \   000002                ; // Fall through to label ??Subroutine35_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine35_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   90....       MOV     DPTR,#ZDAppTaskID
   \   000005   E0           MOVX    A,@DPTR
   \   000006   F9           MOV     R1,A
   \   000007   12....       LCALL   ??osal_set_event?relay
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine40_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F9           MOV     R1,A
   \   000002   12....       LCALL   ??osal_start_timerEx?relay
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine42_0:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    469          
    470          /*********************************************************************
    471           * @fn      ZDApp_ProcessSecEvent()
    472           *
    473           * @brief   Process incoming security events.
    474           *
    475           * @param   task_id - Task ID
    476           * @param   events  - Bitmap of events
    477           *
    478           * @return  none
    479           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    480          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events )
   \                     ZDApp_ProcessSecEvent:
    481          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    482            (void)task_id;  // Intentionally unreferenced parameter
    483            
    484            if ( ZSTACK_ROUTER_BUILD )
    485            {
    486              if ( events & ZDO_NEW_DEVICE )
   \   000009   EE           MOV     A,R6
   \   00000A   5440         ANL     A,#0x40
   \   00000C   6019         JZ      ??ZDApp_ProcessSecEvent_0
    487              {
    488                // process the new device event
    489                if ( ZDSecMgrNewDeviceEvent() == TRUE )
   \   00000E                ; Setup parameters for call to function ZDSecMgrNewDeviceEvent
   \   00000E   12....       LCALL   ??ZDSecMgrNewDeviceEvent?relay
   \   000011   E9           MOV     A,R1
   \   000012   6401         XRL     A,#0x1
   \   000014   7009         JNZ     ??CrossCallReturnLabel_71
    490                {
    491                  osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 1000 );
   \   000016                ; Setup parameters for call to function osal_start_timerEx
   \   000016   7CE8         MOV     R4,#-0x18
   \   000018   7D03         MOV     R5,#0x3
   \   00001A   7A40         MOV     R2,#0x40
   \   00001C   12....       LCALL   ?Subroutine19 & 0xFFFF
    492                }
    493          
    494                // Return unprocessed events
    495                return (events ^ ZDO_NEW_DEVICE);
   \                     ??CrossCallReturnLabel_71:
   \   00001F   7440         MOV     A,#0x40
   \                     ??ZDApp_ProcessSecEvent_1:
   \   000021   6E           XRL     A,R6
   \   000022   FA           MOV     R2,A
   \   000023   EF           MOV     A,R7
   \                     ??ZDApp_ProcessSecEvent_2:
   \   000024   FB           MOV     R3,A
   \   000025   8063         SJMP    ??ZDApp_ProcessSecEvent_3
    496              }
    497            }
    498          
    499            if ( (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH) 
    500                || (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD) )
    501            {
    502              if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    503              { 
    504                if ( events & ZDO_SECMGR_EVENT )
    505                {
    506                  ZDSecMgrEvent();
    507          
    508                  // Return unprocessed events
    509                  return (events ^ ZDO_SECMGR_EVENT);
    510                }
    511              }
    512            }
    513            
    514            if ( events & ZDO_DEVICE_AUTH )
   \                     ??ZDApp_ProcessSecEvent_0:
   \   000027   EE           MOV     A,R6
   \   000028   5480         ANL     A,#0x80
   \   00002A   6007         JZ      ??ZDApp_ProcessSecEvent_4
    515            {
    516              ZDApp_DeviceAuthEvt();
   \   00002C                ; Setup parameters for call to function ZDApp_DeviceAuthEvt
   \   00002C   12....       LCALL   ??ZDApp_DeviceAuthEvt?relay
    517          
    518              // Return unprocessed events
    519              return (events ^ ZDO_DEVICE_AUTH);
   \   00002F   7480         MOV     A,#-0x80
   \   000031   80EE         SJMP    ??ZDApp_ProcessSecEvent_1
    520            }
    521          
    522            if ( events & ZDO_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_4:
   \   000033   7404         MOV     A,#0x4
   \   000035   5F           ANL     A,R7
   \   000036   F9           MOV     R1,A
   \   000037   E4           CLR     A
   \   000038   7001         JNZ     ??ZDApp_ProcessSecEvent_5
   \   00003A   E9           MOV     A,R1
   \                     ??ZDApp_ProcessSecEvent_5:
   \   00003B   6027         JZ      ??ZDApp_ProcessSecEvent_6
    523            {
    524              if ( nwkFrameCounterChanges++ > MAX_NWK_FRAMECOUNTER_CHANGES )
   \   00003D   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000040   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_79:
   \   000043   7401         MOV     A,#0x1
   \   000045   28           ADD     A,R0
   \   000046   FA           MOV     R2,A
   \   000047   E4           CLR     A
   \   000048   39           ADDC    A,R1
   \   000049   FB           MOV     R3,A
   \   00004A   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00004D   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_104:
   \   000050   C3           CLR     C
   \   000051   E8           MOV     A,R0
   \   000052   94E9         SUBB    A,#-0x17
   \   000054   E9           MOV     A,R1
   \   000055   9403         SUBB    A,#0x3
   \   000057   4003         JC      ??ZDApp_ProcessSecEvent_7
    525              {
    526                ZDApp_SaveNwkKey();
   \   000059                ; Setup parameters for call to function ZDApp_SaveNwkKey
   \   000059   12....       LCALL   ??ZDApp_SaveNwkKey?relay
    527              }
    528          
    529              // Return unprocessed events
    530              return (events ^ ZDO_FRAMECOUNTER_CHANGE);
   \                     ??ZDApp_ProcessSecEvent_7:
   \   00005C   EE           MOV     A,R6
   \   00005D   FA           MOV     R2,A
   \   00005E   7404         MOV     A,#0x4
   \                     ??ZDApp_ProcessSecEvent_8:
   \   000060   6F           XRL     A,R7
   \   000061   FB           MOV     R3,A
   \   000062   8026         SJMP    ??ZDApp_ProcessSecEvent_3
    531            }
    532          
    533            if ( events & ZDO_APS_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_6:
   \   000064   7410         MOV     A,#0x10
   \   000066   5F           ANL     A,R7
   \   000067   F9           MOV     R1,A
   \   000068   E4           CLR     A
   \   000069   7001         JNZ     ??ZDApp_ProcessSecEvent_9
   \   00006B   E9           MOV     A,R1
   \                     ??ZDApp_ProcessSecEvent_9:
   \   00006C   6005         JZ      ??ZDApp_ProcessSecEvent_10
    534            {
    535          #if defined (NV_RESTORE)
    536              ZDSecMgrSaveApsLinkKey();
    537          #endif // (NV_RESTORE)
    538              
    539              // Return unprocessed events
    540              return (events ^ ZDO_APS_FRAMECOUNTER_CHANGE);
   \   00006E   7410         MOV     A,#0x10
   \   000070   6F           XRL     A,R7
   \   000071   80B1         SJMP    ??ZDApp_ProcessSecEvent_2
    541            }
    542          
    543            if ( events & ZDO_TCLK_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_10:
   \   000073   7408         MOV     A,#0x8
   \   000075   5F           ANL     A,R7
   \   000076   F9           MOV     R1,A
   \   000077   E4           CLR     A
   \   000078   7001         JNZ     ??ZDApp_ProcessSecEvent_11
   \   00007A   E9           MOV     A,R1
   \                     ??ZDApp_ProcessSecEvent_11:
   \   00007B   6009         JZ      ??ZDApp_ProcessSecEvent_12
    544            {
    545              ZDSecMgrSaveTCLinkKey();
   \   00007D                ; Setup parameters for call to function ZDSecMgrSaveTCLinkKey
   \   00007D   12....       LCALL   ??ZDSecMgrSaveTCLinkKey?relay
    546              
    547              // Return unprocessed events
    548              return (events ^ ZDO_TCLK_FRAMECOUNTER_CHANGE);
   \   000080   EE           MOV     A,R6
   \   000081   FA           MOV     R2,A
   \   000082   7408         MOV     A,#0x8
   \   000084   80DA         SJMP    ??ZDApp_ProcessSecEvent_8
    549            }
    550            
    551            // Discard or make more handlers
    552            return 0;
   \                     ??ZDApp_ProcessSecEvent_12:
   \   000086   7A00         MOV     R2,#0x0
   \   000088   7B00         MOV     R3,#0x0
   \                     ??ZDApp_ProcessSecEvent_3:
   \   00008A   02....       LJMP    ??Subroutine43_0 & 0xFFFF
    553          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   90....       MOV     DPTR,#ZDAppTaskID
   \   000005                REQUIRE ??Subroutine40_0
   \   000005                ; // Fall through to label ??Subroutine40_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine45_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine50_0:
   \   000000   EA           MOV     A,R2
   \   000001   F0           MOVX    @DPTR,A
   \   000002   A3           INC     DPTR
   \   000003   EB           MOV     A,R3
   \   000004   F0           MOVX    @DPTR,A
   \   000005   22           RET
    554          
    555          /*********************************************************************
    556           * Application Functions
    557           */
    558          
    559          /*********************************************************************
    560           * @fn      ZDOInitDevice
    561           *
    562           * @brief   Start the device in the network.  This function will read
    563           *   ZCD_NV_STARTUP_OPTION (NV item) to determine whether or not to
    564           *   restore the network state of the device.
    565           *
    566           * @param   startDelay - timeDelay to start device (in milliseconds).
    567           *                       There is a jitter added to this delay:
    568           *                       ((NWK_START_DELAY + startDelay)
    569           *                       + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK))
    570           *                       When startDelay is set to ZDO_INIT_HOLD_NWK_START
    571           *                       this function will hold the network init. Application
    572           *                       can start the device.
    573           *
    574           * NOTE:    If the application would like to force a "new" join, the
    575           *          application should set the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    576           *          bit in the ZCD_NV_STARTUP_OPTION NV item before calling
    577           *          this function. "new" join means to not restore the network
    578           *          state of the device. Use zgWriteStartupOptions() to set these
    579           *          options.
    580           *
    581           * @return
    582           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    583           *          restored.
    584           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was initialized.
    585           *          This could mean that ZCD_NV_STARTUP_OPTION said to not restore, or
    586           *          it could mean that there was no network state to restore.
    587           *    ZDO_INITDEV_LEAVE_NOT_STARTED - Before the reset, a network leave was issued
    588           *          with the rejoin option set to TRUE.  So, the device was not
    589           *          started in the network (one time only).  The next time this
    590           *          function is called it will start.
    591           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    592          uint8 ZDOInitDevice( uint16 startDelay )
   \                     ZDOInitDevice:
    593          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   12....       LCALL   ?Subroutine10 & 0xFFFF
    594            uint8 networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
    595            uint16 extendedDelay = 0;
    596          
    597            if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_108:
   \   00000D   90....       MOV     DPTR,#devState
   \   000010   E0           MOVX    A,@DPTR
   \   000011   7005         JNZ     ??ZDOInitDevice_0
    598            {    
    599              // Initialize the RAM items table, in case an NV item has been updated.
    600              zgInitItems( FALSE );
   \   000013                ; Setup parameters for call to function zgInitItems
   \   000013   7900         MOV     R1,#0x0
   \   000015   12....       LCALL   ??zgInitItems?relay
    601            }
    602          
    603            ZDConfig_InitDescriptors();
   \                     ??ZDOInitDevice_0:
   \   000018                ; Setup parameters for call to function ZDConfig_InitDescriptors
   \   000018   12....       LCALL   ??ZDConfig_InitDescriptors?relay
    604            //devtag.071807.todo - fix this temporary solution
    605            _NIB.CapabilityFlags = ZDO_Config_Node_Descriptor.CapabilityFlags;
   \   00001B   90....       MOV     DPTR,#(ZDO_Config_Node_Descriptor + 2)
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   90....       MOV     DPTR,#(_NIB + 14)
   \   000022   F0           MOVX    @DPTR,A
    606            
    607          #if defined ( NV_RESTORE )
    608            // Get Keypad directly to see if a reset nv is needed.
    609            // Hold down the SW_BYPASS_NV key (defined in OnBoard.h)
    610            // while booting to skip past NV Restore.
    611            if ( HalKeyRead() == SW_BYPASS_NV )
    612              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
    613            else
    614            {
    615              // Determine if NV should be restored
    616              networkStateNV = ZDApp_ReadNetworkRestoreState();
    617            }
    618          
    619            if ( networkStateNV == ZDO_INITDEV_RESTORED_NETWORK_STATE )
    620            {
    621              networkStateNV = ZDApp_RestoreNetworkState();
    622            }
    623            else
    624            {
    625              // Wipe out the network state in NV
    626              NLME_InitNV();
    627              NLME_SetDefaultNV();
    628              // clear NWK key values
    629              ZDSecMgrClearNVKeyValues();
    630            }
    631          #endif
    632          
    633            if ( networkStateNV == ZDO_INITDEV_NEW_NETWORK_STATE )
    634            {
    635              ZDAppDetermineDeviceType();
   \   000023                ; Setup parameters for call to function ZDAppDetermineDeviceType
   \   000023   12....       LCALL   ??ZDAppDetermineDeviceType?relay
    636          
    637              // Only delay if joining network - not restoring network state
    638              extendedDelay = (uint16)((NWK_START_DELAY + startDelay)
    639                        + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK));
   \   000026                ; Setup parameters for call to function osal_rand
   \   000026   12....       LCALL   ??osal_rand?relay
   \   000029   8A..         MOV     ?V0 + 0,R2
   \   00002B   A8..         MOV     R0,?V0 + 0
   \   00002D   85..82       MOV     DPL,?XSP + 0
   \   000030   85..83       MOV     DPH,?XSP + 1
   \   000033   747F         MOV     A,#0x7f
   \   000035   58           ANL     A,R0
   \   000036   F8           MOV     R0,A
   \   000037   E0           MOVX    A,@DPTR
   \   000038   28           ADD     A,R0
   \   000039   F8           MOV     R0,A
   \   00003A   A3           INC     DPTR
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   3400         ADDC    A,#0x0
   \   00003E   F9           MOV     R1,A
   \   00003F   7464         MOV     A,#0x64
   \   000041   28           ADD     A,R0
   \   000042   FE           MOV     R6,A
   \   000043   E4           CLR     A
   \   000044   39           ADDC    A,R1
   \   000045   FF           MOV     R7,A
    640            }
    641          
    642            // Initialize the security for type of device
    643            ZDApp_SecInit( networkStateNV );
   \   000046                ; Setup parameters for call to function ZDSecMgrInit
   \   000046   7901         MOV     R1,#0x1
   \   000048   12....       LCALL   ??ZDSecMgrInit?relay
    644            
    645            if( ZDO_INIT_HOLD_NWK_START != startDelay )
   \   00004B   85..82       MOV     DPL,?XSP + 0
   \   00004E   85..83       MOV     DPH,?XSP + 1
   \   000051   E0           MOVX    A,@DPTR
   \   000052   64FF         XRL     A,#0xff
   \   000054   7004         JNZ     ??ZDOInitDevice_1
   \   000056   A3           INC     DPTR
   \   000057   E0           MOVX    A,@DPTR
   \   000058   64FF         XRL     A,#0xff
   \                     ??ZDOInitDevice_1:
   \   00005A   6035         JZ      ??ZDOInitDevice_2
    646            {
    647              devState = DEV_INIT;    // Remove the Hold state
   \   00005C   7401         MOV     A,#0x1
   \   00005E   90....       MOV     DPTR,#devState
   \   000061   F0           MOVX    @DPTR,A
    648              
    649              // Initialize leave control logic
    650              ZDApp_LeaveCtrlInit();
   \   000062                ; Setup parameters for call to function ZDApp_LeaveCtrlInit
   \   000062   12....       LCALL   ??ZDApp_LeaveCtrlInit?relay
    651              
    652              // Check leave control reset settings
    653              ZDApp_LeaveCtrlStartup( &devState, &startDelay );
   \   000065                ; Setup parameters for call to function ZDApp_LeaveCtrlStartup
   \   000065   85..82       MOV     DPL,?XSP + 0
   \   000068   85..83       MOV     DPH,?XSP + 1
   \   00006B   AC82         MOV     R4,DPL
   \   00006D   AD83         MOV     R5,DPH
   \   00006F   7A..         MOV     R2,#(devState & 0xff)
   \   000071   7B..         MOV     R3,#((devState >> 8) & 0xff)
   \   000073   12....       LCALL   ??ZDApp_LeaveCtrlStartup?relay
    654              
    655              // Leave may make the hold state come back
    656              if ( devState == DEV_HOLD )
   \   000076   90....       MOV     DPTR,#devState
   \   000079   E0           MOVX    A,@DPTR
   \   00007A   700E         JNZ     ??ZDOInitDevice_3
    657              {
    658                // Set the NV startup option to force a "new" join.
    659                zgWriteStartupOptions( ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   00007C                ; Setup parameters for call to function zgWriteStartupOptions
   \   00007C   7A02         MOV     R2,#0x2
   \   00007E   79FF         MOV     R1,#-0x1
   \   000080   12....       LCALL   ??zgWriteStartupOptions?relay
    660                
    661                // Notify the applications 
    662                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000083                ; Setup parameters for call to function osal_set_event
   \   000083   12....       LCALL   ?Subroutine13 & 0xFFFF
    663                
    664                return ( ZDO_INITDEV_LEAVE_NOT_STARTED );   // Don't join - (one time).
   \                     ??CrossCallReturnLabel_49:
   \   000086   7902         MOV     R1,#0x2
   \   000088   8011         SJMP    ??ZDOInitDevice_4
    665              }
    666              
    667              // Trigger the network start
    668              ZDApp_NetworkInit( extendedDelay );
   \                     ??ZDOInitDevice_3:
   \   00008A                ; Setup parameters for call to function ZDApp_NetworkInit
   \   00008A   EE           MOV     A,R6
   \   00008B   FA           MOV     R2,A
   \   00008C   EF           MOV     A,R7
   \   00008D   FB           MOV     R3,A
   \   00008E   12....       LCALL   ??ZDApp_NetworkInit?relay
    669            }
    670          
    671            // set broadcast address mask to support broadcast filtering
    672            NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \                     ??ZDOInitDevice_2:
   \   000091                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   000091   90....       MOV     DPTR,#(ZDO_Config_Node_Descriptor + 2)
   \   000094   E0           MOVX    A,@DPTR
   \   000095   F9           MOV     R1,A
   \   000096   12....       LCALL   ??NLME_SetBroadcastFilter?relay
    673            
    674            return ( networkStateNV );
   \   000099   7901         MOV     R1,#0x1
   \                     ??ZDOInitDevice_4:
   \   00009B   02....       LJMP    ?Subroutine1 & 0xFFFF
    675          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7402         MOV     A,#0x2
   \   000002                REQUIRE ??Subroutine41_0
   \   000002                ; // Fall through to label ??Subroutine41_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine41_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003                REQUIRE ??Subroutine42_0
   \   000003                ; // Fall through to label ??Subroutine42_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006                REQUIRE ??Subroutine50_0
   \   000006                ; // Fall through to label ??Subroutine50_0
    676          
    677          /*********************************************************************
    678           * @fn      ZDApp_ReadNetworkRestoreState
    679           *
    680           * @brief   Read the ZCD_NV_STARTUP_OPTION NV Item to state whether
    681           *          or not to restore the network state.
    682           *          If the read value has the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    683           *          bit set return the ZDO_INITDEV_NEW_NETWORK_STATE.
    684           *
    685           * @param   none
    686           *
    687           * @return  ZDO_INITDEV_NEW_NETWORK_STATE
    688           *          or ZDO_INITDEV_RESTORED_NETWORK_STATE based on whether or
    689           *          not ZCD_STARTOPT_DEFAULT_NETWORK_STATE bit is set in
    690           *          ZCD_NV_STARTUP_OPTION
    691           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    692          uint8 ZDApp_ReadNetworkRestoreState( void )
   \                     ZDApp_ReadNetworkRestoreState:
    693          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    694            uint8 networkStateNV = ZDO_INITDEV_RESTORED_NETWORK_STATE;
   \   000005   7E00         MOV     R6,#0x0
    695          
    696            // Look for the New Network State option.
    697            if ( zgReadStartupOptions() & ZCD_STARTOPT_DEFAULT_NETWORK_STATE )
   \   000007                ; Setup parameters for call to function zgReadStartupOptions
   \   000007   12....       LCALL   ??zgReadStartupOptions?relay
   \   00000A   E9           MOV     A,R1
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   5001         JNC     ??ZDApp_ReadNetworkRestoreState_0
    698            {
    699              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
   \   00000F   0E           INC     R6
    700            }
    701          
    702            return ( networkStateNV );
   \                     ??ZDApp_ReadNetworkRestoreState_0:
   \   000010   EE           MOV     A,R6
   \   000011   F9           MOV     R1,A
   \   000012   02....       LJMP    ??Subroutine43_0 & 0xFFFF
    703          }
    704          
    705          /*********************************************************************
    706           * @fn      ZDAppDetermineDeviceType()
    707           *
    708           * @brief   Determines the type of device to start. 
    709           *
    710           *          Looks at zgDeviceLogicalType and determines what type of
    711           *          device to start.  The types are:
    712           *            ZG_DEVICETYPE_COORDINATOR
    713           *            ZG_DEVICETYPE_ROUTER
    714           *            ZG_DEVICETYPE_ENDDEVICE
    715           *
    716           * @param   none
    717           *
    718           * @return  none
    719           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    720          void ZDAppDetermineDeviceType( void )
   \                     ZDAppDetermineDeviceType:
    721          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    722            if ( zgDeviceLogicalType == ZG_DEVICETYPE_COORDINATOR )
   \   000004   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000007   E0           MOVX    A,@DPTR
   \   000008   700E         JNZ     ??ZDAppDetermineDeviceType_0
    723            {
    724              devStartMode = MODE_HARD;     // Start as a coordinator
   \   00000A   7402         MOV     A,#0x2
   \   00000C   90....       MOV     DPTR,#devStartMode
   \   00000F   F0           MOVX    @DPTR,A
    725              ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000010   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000013   E0           MOVX    A,@DPTR
   \   000014   54F8         ANL     A,#0xf8
   \   000016   802E         SJMP    ??ZDAppDetermineDeviceType_1
    726            }
    727            else
    728            {
    729              if ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER  )
   \                     ??ZDAppDetermineDeviceType_0:
   \   000018   6401         XRL     A,#0x1
   \   00001A   700A         JNZ     ??ZDAppDetermineDeviceType_2
    730                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_ROUTER;
   \   00001C   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   54F8         ANL     A,#0xf8
   \   000022   4401         ORL     A,#0x1
   \   000024   800D         SJMP    ??ZDAppDetermineDeviceType_3
    731              else if ( zgDeviceLogicalType == ZG_DEVICETYPE_ENDDEVICE )
   \                     ??ZDAppDetermineDeviceType_2:
   \   000026   E0           MOVX    A,@DPTR
   \   000027   6402         XRL     A,#0x2
   \   000029   7009         JNZ     ??ZDAppDetermineDeviceType_4
    732                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   00002B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   54F8         ANL     A,#0xf8
   \   000031   4402         ORL     A,#0x2
   \                     ??ZDAppDetermineDeviceType_3:
   \   000033   F0           MOVX    @DPTR,A
    733              
    734              // If AIB_apsUseExtendedPANID is set to a non-zero value by commissioning
    735              // The device shall do rejoin the network. Otherwise, do normal join
    736              if ( nwk_ExtPANIDValid( AIB_apsUseExtendedPANID ) == false )
   \                     ??ZDAppDetermineDeviceType_4:
   \   000034                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   000034   7A..         MOV     R2,#(AIB_apsUseExtendedPANID & 0xff)
   \   000036   7B..         MOV     R3,#((AIB_apsUseExtendedPANID >> 8) & 0xff)
   \   000038   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   00003B   E9           MOV     A,R1
   \   00003C   7003         JNZ     ??ZDAppDetermineDeviceType_5
    737              {
    738                devStartMode = MODE_JOIN;     // Assume joining
   \   00003E   E4           CLR     A
   \   00003F   8002         SJMP    ??ZDAppDetermineDeviceType_6
    739              }
    740              else
    741              {
    742                devStartMode = MODE_REJOIN;  
   \                     ??ZDAppDetermineDeviceType_5:
   \   000041   7403         MOV     A,#0x3
   \                     ??ZDAppDetermineDeviceType_6:
   \   000043   90....       MOV     DPTR,#devStartMode
   \                     ??ZDAppDetermineDeviceType_1:
   \   000046   F0           MOVX    @DPTR,A
    743              }
    744            }
    745          }
   \   000047   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    746          
    747          /*********************************************************************
    748           * @fn      ZDApp_NetworkStartEvt()
    749           *
    750           * @brief   Process the Network Start Event
    751           *
    752           * @param   none
    753           *
    754           * @return  none
    755           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    756          void ZDApp_NetworkStartEvt( void )
   \                     ZDApp_NetworkStartEvt:
    757          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    758            if ( nwkStatus == ZSuccess )
   \   000004   90....       MOV     DPTR,#nwkStatus
   \   000007   E0           MOVX    A,@DPTR
   \   000008   7012         JNZ     ??ZDApp_NetworkStartEvt_0
    759            {
    760              // Successfully started a ZigBee network
    761              if ( devState == DEV_COORD_STARTING )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6408         XRL     A,#0x8
   \   000010   7003         JNZ     ??ZDApp_NetworkStartEvt_1
    762              {
    763                devState = DEV_ZB_COORD;
   \   000012   7409         MOV     A,#0x9
   \   000014   F0           MOVX    @DPTR,A
    764              }
    765          
    766              osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
   \                     ??ZDApp_NetworkStartEvt_1:
   \   000015                ; Setup parameters for call to function osal_pwrmgr_device
   \   000015   7900         MOV     R1,#0x0
   \   000017   12....       LCALL   ??osal_pwrmgr_device?relay
    767              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00001A                ; Setup parameters for call to function osal_set_event
   \   00001A   802D         SJMP    ??ZDApp_NetworkStartEvt_2
    768            }
    769            else
    770            {
    771              // Try again with a higher energy threshold !!
    772              if ( ( NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT ) < 0xff )
   \                     ??ZDApp_NetworkStartEvt_0:
   \   00001C                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   00001C   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   00001F   E9           MOV     A,R1
   \   000020   F8           MOV     R0,A
   \   000021   7410         MOV     A,#0x10
   \   000023   28           ADD     A,R0
   \   000024   F8           MOV     R0,A
   \   000025   E4           CLR     A
   \   000026   3400         ADDC    A,#0x0
   \   000028   F9           MOV     R1,A
   \   000029   E8           MOV     A,R0
   \   00002A   94FF         SUBB    A,#-0x1
   \   00002C   E9           MOV     A,R1
   \   00002D   9400         SUBB    A,#0x0
   \   00002F   C3           CLR     C
   \   000030   65D0         XRL     A,PSW
   \   000032   33           RLC     A
   \   000033   500E         JNC     ??ZDApp_NetworkStartEvt_3
    773              {
    774                NLME_SetEnergyThreshold( (uint8)(NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT) );
   \   000035                ; Setup parameters for call to function NLME_SetEnergyThreshold
   \   000035                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   000035   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   000038   E9           MOV     A,R1
   \   000039   2410         ADD     A,#0x10
   \   00003B   F9           MOV     R1,A
   \   00003C   12....       LCALL   ??NLME_SetEnergyThreshold?relay
    775                osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \   00003F                ; Setup parameters for call to function osal_set_event
   \   00003F   7A01         MOV     R2,#0x1
   \   000041   8008         SJMP    ??ZDApp_NetworkStartEvt_4
    776              }
    777              else
    778              {
    779                // Failed to start network. Enter a dormant state (until user intervenes)
    780                devState = DEV_INIT;
   \                     ??ZDApp_NetworkStartEvt_3:
   \   000043   7401         MOV     A,#0x1
   \   000045   90....       MOV     DPTR,#devState
   \   000048   F0           MOVX    @DPTR,A
    781                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000049                ; Setup parameters for call to function osal_set_event
   \                     ??ZDApp_NetworkStartEvt_2:
   \   000049   7A10         MOV     R2,#0x10
    782              }
    783            }
   \                     ??ZDApp_NetworkStartEvt_4:
   \   00004B   12....       LCALL   ??Subroutine35_0 & 0xFFFF
    784          }
   \                     ??CrossCallReturnLabel_53:
   \   00004E   02....       LJMP    ?Subroutine2 & 0xFFFF
    785          
    786          /*********************************************************************
    787           * @fn      ZDApp_DeviceAuthEvt()
    788           *
    789           * @brief   Process the Device Authentic Event
    790           *
    791           * @param   none
    792           *
    793           * @return  none
    794           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    795          void ZDApp_DeviceAuthEvt( void )
   \                     ZDApp_DeviceAuthEvt:
    796          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    797            // received authentication from trust center
    798            if ( devState == DEV_END_DEVICE_UNAUTH )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6405         XRL     A,#0x5
   \   00000A   702B         JNZ     ??ZDApp_DeviceAuthEvt_0
    799            {
    800              // Stop the reset timer so it doesn't reset
    801              ZDApp_ResetTimerCancel();
   \   00000C                ; Setup parameters for call to function ZDApp_ResetTimerCancel
   \   00000C   12....       LCALL   ??ZDApp_ResetTimerCancel?relay
    802          
    803              devState = DEV_END_DEVICE;
   \   00000F   12....       LCALL   ?Subroutine7 & 0xFFFF
    804              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    805          
    806              // Set the Power Manager Device
    807          #if defined ( POWER_SAVING )
    808              osal_pwrmgr_device( PWRMGR_BATTERY );
    809          #endif
    810          
    811              if ( ZSTACK_ROUTER_BUILD )
    812              {
    813                if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   \                     ??CrossCallReturnLabel_0:
   \   000012   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   000015   6009         JZ      ??ZDApp_DeviceAuthEvt_1
    814                {
    815                  // NOTE: first two parameters are not used, see NLMEDE.h for details
    816                  NLME_StartRouterRequest( 0, 0, false );
   \   000017                ; Setup parameters for call to function NLME_StartRouterRequest
   \   000017   7B00         MOV     R3,#0x0
   \   000019   7A00         MOV     R2,#0x0
   \   00001B   7900         MOV     R1,#0x0
   \   00001D   12....       LCALL   ??NLME_StartRouterRequest?relay
    817                }
    818              }
    819          
    820              // Notify to save info into NV
    821              ZDApp_NVUpdate();
    822          
    823              // Save off the security
    824              ZDApp_SaveNwkKey();
   \                     ??ZDApp_DeviceAuthEvt_1:
   \   000020                ; Setup parameters for call to function ZDApp_SaveNwkKey
   \   000020   12....       LCALL   ??ZDApp_SaveNwkKey?relay
    825          
    826              ZDApp_AnnounceNewAddress();
   \   000023                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000023   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
    827              
    828              if ( (ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE) == 0 )
   \   000026   90....       MOV     DPTR,#(ZDO_Config_Node_Descriptor + 2)
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   A2E3         MOV     C,0xE0 /* A   */.3
   \   00002C   4009         JC      ??ZDApp_DeviceAuthEvt_0
    829              {
    830                NLME_SetPollRate( ZDApp_SavedPollRate );
   \   00002E                ; Setup parameters for call to function NLME_SetPollRate
   \   00002E   90....       MOV     DPTR,#ZDApp_SavedPollRate
   \   000031   12....       LCALL   ??Subroutine36_0 & 0xFFFF
    831              }
    832            }
   \                     ??CrossCallReturnLabel_56:
   \   000034   12....       LCALL   ??NLME_SetPollRate?relay
    833            else
    834            {
    835              ZDApp_NVUpdate();
    836            }
    837          }
   \                     ??ZDApp_DeviceAuthEvt_0:
   \   000037   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine36_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FB           MOV     R3,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000003   E0           MOVX    A,@DPTR
   \   000004   5407         ANL     A,#0x7
   \   000006   6402         XRL     A,#0x2
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   7406         MOV     A,#0x6
   \   000002   90....       MOV     DPTR,#devState
   \   000005   F0           MOVX    @DPTR,A
   \   000006                ; Setup parameters for call to function osal_set_event
   \   000006                ; Setup parameters for call to function osal_set_event
   \   000006   7A10         MOV     R2,#0x10
   \   000008   7B00         MOV     R3,#0x0
   \   00000A   90....       MOV     DPTR,#ZDAppTaskID
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   12....       LCALL   ??osal_set_event?relay
   \   000012   22           RET
    838          
    839          /*********************************************************************
    840           * @fn      ZDApp_SaveNetworkStateEvt()
    841           *
    842           * @brief   Process the Save the Network State Event
    843           *
    844           * @param   none
    845           *
    846           * @return  none
    847           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    848          void ZDApp_SaveNetworkStateEvt( void )
   \                     ZDApp_SaveNetworkStateEvt:
    849          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    850          #if defined ( NV_RESTORE )
    851           #if defined ( NV_TURN_OFF_RADIO )
    852            // Turn off the radio's receiver during an NV update
    853            uint8 RxOnIdle;
    854            uint8 x = false;
    855            ZMacGetReq( ZMacRxOnIdle, &RxOnIdle );
    856            ZMacSetReq( ZMacRxOnIdle, &x );
    857           #endif
    858          
    859            // Update the Network State in NV
    860            NLME_UpdateNV( NWK_NV_NIB_ENABLE        |
    861                           NWK_NV_DEVICELIST_ENABLE |
    862                           NWK_NV_BINDING_ENABLE    |
    863                           NWK_NV_ADDRMGR_ENABLE );
    864          
    865            // Reset the NV startup option to resume from NV by
    866            // clearing the "New" join option.
    867            zgWriteStartupOptions( FALSE, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
    868          
    869           #if defined ( NV_TURN_OFF_RADIO )
    870            ZMacSetReq( ZMacRxOnIdle, &RxOnIdle );
    871           #endif
    872          #endif  // NV_RESTORE
    873          }
   \   000000   02....       LJMP    ?BRET
    874          
    875          /*********************************************************************
    876           * @fn      ZDApp_RestoreNetworkState()
    877           *
    878           * @brief   This function will restore the network state of the
    879           *          device if the network state is stored in NV.
    880           *
    881           * @param   none
    882           *
    883           * @return
    884           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    885           *          restored.
    886           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was not used.
    887           *          This could mean that zgStartupOption said to not restore, or
    888           *          it could mean that there was no network state to restore.
    889           *
    890           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    891          uint8 ZDApp_RestoreNetworkState( void )
   \                     ZDApp_RestoreNetworkState:
    892          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    893            uint8 nvStat;
    894          
    895            // Initialize NWK NV items
    896            nvStat = NLME_InitNV();
   \   000005                ; Setup parameters for call to function NLME_InitNV
   \   000005   12....       LCALL   ??NLME_InitNV?relay
   \   000008   E9           MOV     A,R1
   \   000009   FE           MOV     R6,A
    897          
    898            if ( nvStat != NV_OPER_FAILED )
   \   00000A   740A         MOV     A,#0xa
   \   00000C   6E           XRL     A,R6
   \   00000D   6038         JZ      ??ZDApp_RestoreNetworkState_0
    899            {
    900              if ( NLME_RestoreFromNV() )
   \   00000F                ; Setup parameters for call to function NLME_RestoreFromNV
   \   00000F   12....       LCALL   ??NLME_RestoreFromNV?relay
   \   000012   E9           MOV     A,R1
   \   000013   6032         JZ      ??ZDApp_RestoreNetworkState_0
    901              {
    902                // Are we a coordinator
    903                ZDAppNwkAddr.addr.shortAddr = NLME_GetShortAddr();
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00001B   12....       LCALL   ??Subroutine50_0 & 0xFFFF
    904                if ( ZDAppNwkAddr.addr.shortAddr == 0 )
   \                     ??CrossCallReturnLabel_105:
   \   00001E   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000021   E0           MOVX    A,@DPTR
   \   000022   7002         JNZ     ??ZDApp_RestoreNetworkState_1
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \                     ??ZDApp_RestoreNetworkState_1:
   \   000026   7007         JNZ     ??ZDApp_RestoreNetworkState_2
    905                  ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000028   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   54F8         ANL     A,#0xf8
   \   00002E   F0           MOVX    @DPTR,A
    906                devStartMode = MODE_RESUME;
   \                     ??ZDApp_RestoreNetworkState_2:
   \   00002F   7401         MOV     A,#0x1
   \   000031   90....       MOV     DPTR,#devStartMode
   \   000034   F0           MOVX    @DPTR,A
    907                osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
   \   000035                ; Setup parameters for call to function sAddrExtCpy
   \   000035   7C..         MOV     R4,#((_NIB + 53) & 0xff)
   \   000037   7D..         MOV     R5,#(((_NIB + 53) >> 8) & 0xff)
   \   000039   7A..         MOV     R2,#(ZDO_UseExtendedPANID & 0xff)
   \   00003B   7B..         MOV     R3,#((ZDO_UseExtendedPANID >> 8) & 0xff)
   \   00003D   12....       LCALL   ??sAddrExtCpy?relay
    908              }
    909              else
    910                nvStat = NV_ITEM_UNINIT;
    911          
    912              if ( ZG_SECURE_ENABLED )
    913              {
    914                nwkFrameCounterChanges = 0;
    915          
    916                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    917                {
    918                  ZDApp_RestoreNwkKey();
    919                }
    920              }
    921          
    922              // The default for RxOnWhenIdle is true for Routers and false for end devices
    923              // [setup in the NLME_RestoreFromNV()].  Change it here if you want something
    924              // other than default.
    925            }
    926          
    927            if ( nvStat == ZSUCCESS )
   \   000040   EE           MOV     A,R6
   \   000041   7004         JNZ     ??ZDApp_RestoreNetworkState_0
    928              return ( ZDO_INITDEV_RESTORED_NETWORK_STATE );
   \   000043   7900         MOV     R1,#0x0
   \   000045   8002         SJMP    ??ZDApp_RestoreNetworkState_3
    929            else
    930              return ( ZDO_INITDEV_NEW_NETWORK_STATE );
   \                     ??ZDApp_RestoreNetworkState_0:
   \   000047   7901         MOV     R1,#0x1
   \                     ??ZDApp_RestoreNetworkState_3:
   \   000049   02....       LJMP    ??Subroutine43_0 & 0xFFFF
    931          }
    932          
    933          /*********************************************************************
    934           * @fn      ZDApp_InitUserDesc()
    935           *
    936           * @brief   Initialize the User Descriptor, the descriptor is read from NV
    937           *          when needed.  If you want to initialize the User descriptor to
    938           *          something other than all zero, do it here.
    939           *
    940           * @param   none
    941           *
    942           * @return  none
    943           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    944          void ZDApp_InitUserDesc( void )
   \                     ZDApp_InitUserDesc:
    945          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 17
   \   000005   74EF         MOV     A,#-0x11
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    946            UserDescriptorFormat_t ZDO_DefaultUserDescriptor;
    947          
    948            // Initialize the User Descriptor, the descriptor is read from NV
    949            // when needed.  If you want to initialize the User descriptor to something
    950            // other than all zero, do it here.
    951            osal_memset( &ZDO_DefaultUserDescriptor, 0, sizeof( UserDescriptorFormat_t ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C11         MOV     R4,#0x11
   \   00000C   12....       LCALL   ?Subroutine24 & 0xFFFF
    952            if ( ZSUCCESS == osal_nv_item_init( ZCD_NV_USERDESC,
    953                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \                     ??CrossCallReturnLabel_30:
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   7C11         MOV     R4,#0x11
   \   000014   7D00         MOV     R5,#0x0
   \   000016   7A81         MOV     R2,#-0x7f
   \   000018   7B00         MOV     R3,#0x0
   \   00001A   12....       LCALL   ??osal_nv_item_init?relay
   \   00001D   7402         MOV     A,#0x2
   \   00001F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000022   E9           MOV     A,R1
   \   000023   7033         JNZ     ??ZDApp_InitUserDesc_0
    954            {
    955              if ( ZSUCCESS == osal_nv_read( ZCD_NV_USERDESC, 0,
    956                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \   000025                ; Setup parameters for call to function osal_nv_read
   \   000025   78..         MOV     R0,#?V0 + 0
   \   000027   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002A   75..11       MOV     ?V0 + 0,#0x11
   \   00002D   75..00       MOV     ?V0 + 1,#0x0
   \   000030   78..         MOV     R0,#?V0 + 0
   \   000032   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000035   7C00         MOV     R4,#0x0
   \   000037   7D00         MOV     R5,#0x0
   \   000039   7A81         MOV     R2,#-0x7f
   \   00003B   7B00         MOV     R3,#0x0
   \   00003D   12....       LCALL   ??osal_nv_read?relay
   \   000040   7404         MOV     A,#0x4
   \   000042   12....       LCALL   ?DEALLOC_XSTACK8
   \   000045   E9           MOV     A,R1
   \   000046   7010         JNZ     ??ZDApp_InitUserDesc_0
    957              {
    958                if ( ZDO_DefaultUserDescriptor.len != 0 )
   \   000048   85..82       MOV     DPL,?XSP + 0
   \   00004B   85..83       MOV     DPH,?XSP + 1
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   6007         JZ      ??ZDApp_InitUserDesc_0
    959                {
    960                  ZDO_Config_Node_Descriptor.UserDescAvail = TRUE;
   \   000051   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000054   E0           MOVX    A,@DPTR
   \   000055   D2E4         SETB    0xE0 /* A   */.4
   \   000057   F0           MOVX    @DPTR,A
    961                }
    962              }
    963            }
    964          }
   \                     ??ZDApp_InitUserDesc_0:
   \   000058   7411         MOV     A,#0x11
   \   00005A   02....       LJMP    ??Subroutine41_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   7D00         MOV     R5,#0x0
   \   000002   7900         MOV     R1,#0x0
   \   000004   85..82       MOV     DPL,?XSP + 0
   \   000007   85..83       MOV     DPH,?XSP + 1
   \   00000A   AA82         MOV     R2,DPL
   \   00000C   AB83         MOV     R3,DPH
   \   00000E   12....       LCALL   ??osal_memset?relay
   \   000011                ; Setup parameters for call to function osal_nv_item_init
   \   000011                ; Setup parameters for call to function osal_nv_write
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   8582..       MOV     ?V0 + 0,DPL
   \   00001A   8583..       MOV     ?V0 + 1,DPH
   \   00001D   78..         MOV     R0,#?V0 + 0
   \   00001F   22           RET
    965          
    966          /*********************************************************************
    967           * @fn      ZDAppCheckForHoldKey()
    968           *
    969           * @brief   Check for key to set the device into Hold Auto Start
    970           *
    971           * @param   none
    972           *
    973           * @return  none
    974           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    975          void ZDAppCheckForHoldKey( void )
   \                     ZDAppCheckForHoldKey:
    976          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    977          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    978            // Get Keypad directly to see if a HOLD_START is needed.
    979            // Hold down the SW_BYPASS_START key (see OnBoard.h)
    980            // while booting to avoid starting up the device.
    981            if ( HalKeyRead () == SW_BYPASS_START)
   \   000004                ; Setup parameters for call to function HalKeyRead
   \   000004   12....       LCALL   ??HalKeyRead?relay
   \   000007   E9           MOV     A,R1
   \   000008   6401         XRL     A,#0x1
   \   00000A   7005         JNZ     ??ZDAppCheckForHoldKey_0
    982            {
    983              // Change the device state to HOLD on start up
    984              devState = DEV_HOLD;
   \   00000C   E4           CLR     A
   \   00000D   90....       MOV     DPTR,#devState
   \   000010   F0           MOVX    @DPTR,A
    985            }
    986          #endif // HAL_KEY
    987          }
   \                     ??ZDAppCheckForHoldKey_0:
   \   000011   02....       LJMP    ?Subroutine2 & 0xFFFF
    988          
    989          /*********************************************************************
    990           * @fn      ZDApp_ProcessOSALMsg()
    991           *
    992           * @brief   Process the incoming task message.
    993           *
    994           * @param   msgPtr - message to process
    995           *
    996           * @return  none
    997           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    998          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessOSALMsg:
    999          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1000            // Data Confirmation message fields
   1001            uint8 sentEP;       // This should always be 0
   1002            uint8 sentStatus;
   1003            afDataConfirm_t *afDataConfirm;
   1004            uint8 tmp;
   1005          
   1006            switch ( msgPtr->event )
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   E0           MOVX    A,@DPTR
   \   000009   12....       LCALL   ?UC_SWITCH_SPARSE
   \                     `?<Jumptable for ZDApp_ProcessOSALMsg>_0`:
   \   00000C   01           DB        1
   \   00000D   01           DB        1
   \   00000E   03           DB        3
   \   00000F   ....         DW        ??ZDApp_ProcessOSALMsg_0
   \   000011   03           DB        3
   \   000012   1A           DB        26
   \   000013   ....         DW        ??ZDApp_ProcessOSALMsg_1
   \   000015   D3           DB        211
   \   000016   ....         DW        ??ZDApp_ProcessOSALMsg_2
   \   000018   FD           DB        253
   \   000019   ....         DW        ??ZDApp_ProcessOSALMsg_3
   \   00001B   ....         DW        ??ZDApp_ProcessOSALMsg_0
   1007            {
   1008              // Incoming ZDO Message
   1009              case AF_INCOMING_MSG_CMD:
   1010                ZDP_IncomingData( (afIncomingMSGPacket_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_1:
   \   00001D                ; Setup parameters for call to function ZDP_IncomingData
   \   00001D   12....       LCALL   ??ZDP_IncomingData?relay
   \   000020   8018         SJMP    ??ZDApp_ProcessOSALMsg_0
   1011                break;
   1012                
   1013              case ZDO_CB_MSG:
   1014                ZDApp_ProcessMsgCBs( (zdoIncomingMsg_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_2:
   \   000022                ; Setup parameters for call to function ZDApp_ProcessMsgCBs
   \   000022   12....       LCALL   ??ZDApp_ProcessMsgCBs?relay
   \   000025   8013         SJMP    ??ZDApp_ProcessOSALMsg_0
   1015                break;
   1016          
   1017              case AF_DATA_CONFIRM_CMD:
   1018                // This message is received as a confirmation of a data packet sent.
   1019                // The status is of ZStatus_t type [defined in NLMEDE.h]
   1020                // The message fields are defined in AF.h
   1021                afDataConfirm = (afDataConfirm_t *)msgPtr;
   1022                sentEP = afDataConfirm->endpoint;
   1023                sentStatus = afDataConfirm->hdr.status;
   1024          
   1025                // Action taken when confirmation is received.
   1026          #if defined ( ZIGBEE_FREQ_AGILITY )
   1027                if ( pZDNwkMgr_ProcessDataConfirm )
   \                     ??ZDApp_ProcessOSALMsg_3:
   \   000027   90....       MOV     DPTR,#pZDNwkMgr_ProcessDataConfirm
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   7002         JNZ     ??ZDApp_ProcessOSALMsg_4
   \   00002D   A3           INC     DPTR
   \   00002E   E0           MOVX    A,@DPTR
   \                     ??ZDApp_ProcessOSALMsg_4:
   \   00002F   6009         JZ      ??ZDApp_ProcessOSALMsg_0
   1028                  pZDNwkMgr_ProcessDataConfirm( afDataConfirm );
   \   000031                ; Setup parameters for indirect call
   \   000031   90....       MOV     DPTR,#pZDNwkMgr_ProcessDataConfirm
   \   000034   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_8:
   \   000037   12....       LCALL   ?CALL_IND
   1029          #endif
   1030                (void)sentEP;
   1031                (void)sentStatus;
   1032                break;
   1033          
   1034              case ZDO_NWK_DISC_CNF:
   1035                if (devState != DEV_NWK_DISC)
   1036                  break;
   1037                
   1038                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1039                {
   1040                  // Process the network discovery scan results and choose a parent
   1041                  // device to join/rejoin itself
   1042                  networkDesc_t *pChosenNwk;                       
   1043                  if ( ( (pChosenNwk = ZDApp_NwkDescListProcessing()) != NULL ) && (zdoDiscCounter > NUM_DISC_ATTEMPTS) )
   1044                  {
   1045                    if ( devStartMode == MODE_JOIN )
   1046                    {            
   1047                      devState = DEV_NWK_JOINING;
   1048                      
   1049                      ZDApp_NodeProfileSync( pChosenNwk->stackProfile);
   1050                      
   1051                      if ( NLME_JoinRequest( pChosenNwk->extendedPANID, pChosenNwk->panId,
   1052                                            pChosenNwk->logicalChannel, 
   1053                                            ZDO_Config_Node_Descriptor.CapabilityFlags, 
   1054                                            pChosenNwk->chosenRouter, pChosenNwk->chosenRouterDepth ) != ZSuccess )
   1055                      {
   1056                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1057                                                    + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   1058                      }             
   1059                    } // if ( devStartMode == MODE_JOIN )
   1060                    else if ( devStartMode == MODE_REJOIN )
   1061                    {
   1062                      devState = DEV_NWK_REJOIN;
   1063                      
   1064                      // Before trying to do rejoin, check if the device has a valid short address
   1065                      // If not, generate a random short address for itself
   1066                      if ( _NIB.nwkDevAddress == INVALID_NODE_ADDR )
   1067                      {
   1068                        _NIB.nwkDevAddress = osal_rand();
   1069                        ZMacSetReq( ZMacShortAddress, (byte*)&_NIB.nwkDevAddress );
   1070                      }
   1071                      
   1072                      if ( ZG_SECURE_ENABLED )
   1073                      {
   1074                        ZDApp_RestoreNwkKey();
   1075                      }
   1076                      
   1077                      // Check if the device has a valid PanID, if not, set it to the discovered Pan
   1078                      if ( _NIB.nwkPanId == INVALID_PAN_ID )
   1079                      {
   1080                        _NIB.nwkPanId = pChosenNwk->panId;
   1081                        ZMacSetReq( ZMacPanId, (byte*)&(_NIB.nwkPanId) );
   1082                      }
   1083                      
   1084                      tmp = true;
   1085                      ZMacSetReq( ZMacRxOnIdle, &tmp ); // Set receiver always on during rejoin 
   1086                      if ( NLME_ReJoinRequest( ZDO_UseExtendedPANID, pChosenNwk->logicalChannel) != ZSuccess )
   1087                      {
   1088                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1089                                                    + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   1090                      }
   1091                    } // else if ( devStartMode == MODE_REJOIN )
   1092                    
   1093                    if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   1094                    {
   1095                      // The receiver is on, turn network layer polling off.
   1096                      NLME_SetPollRate( 0 );
   1097                      NLME_SetQueuedPollRate( 0 );
   1098                      NLME_SetResponseRate( 0 );
   1099                    }
   1100                    else
   1101                    {
   1102                      if ( (ZG_SECURE_ENABLED) && (devStartMode == MODE_JOIN) )
   1103                      {
   1104                        ZDApp_SavedPollRate = zgPollRate;
   1105                        NLME_SetPollRate( zgRejoinPollRate );
   1106                      }
   1107                    }
   1108                  }
   1109                  else
   1110                  {
   1111                    if ( continueJoining )
   1112                    {
   1113              #if defined ( MANAGED_SCAN )
   1114                      ZDApp_NetworkInit( MANAGEDSCAN_DELAY_BETWEEN_SCANS );
   1115              #else
   1116                      zdoDiscCounter++;
   1117                      ZDApp_NetworkInit( (uint16)(BEACON_REQUEST_DELAY
   1118                            + ((uint16)(osal_rand()& BEACON_REQ_DELAY_MASK))) );
   1119              #endif
   1120                    }
   1121                  }
   1122                }
   1123                break;
   1124          
   1125              case ZDO_NWK_JOIN_IND:
   1126                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1127                {
   1128                  ZDApp_ProcessNetworkJoin();
   1129                }
   1130                break;
   1131          
   1132              case ZDO_NWK_JOIN_REQ:
   1133                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1134                {
   1135                  retryCnt = 0;
   1136                  devStartMode = MODE_RESUME;
   1137                  _tmpRejoinState = true;
   1138                  osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
   1139                  zgDefaultStartingScanDuration = BEACON_ORDER_60_MSEC;
   1140                  ZDApp_NetworkInit( 0 );
   1141                }
   1142                break;
   1143          
   1144              default:
   1145                if ( ZG_SECURE_ENABLED )
   1146                  ZDApp_ProcessSecMsg( msgPtr );
   1147                break;
   1148            }
   1149          
   1150          }
   \                     ??ZDApp_ProcessOSALMsg_0:
   \   00003A   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F583         MOV     DPH,A
   \   000006   8882         MOV     DPL,R0
   \   000008   22           RET
   1151          
   1152          /*********************************************************************
   1153           * @fn      ZDApp_ProcessMsgCBs()
   1154           *
   1155           * @brief   Process response messages
   1156           *
   1157           * @param   none
   1158           *
   1159           * @return  none
   1160           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1161          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_ProcessMsgCBs:
   1162          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 44
   \   000005   74D4         MOV     A,#-0x2c
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1163            switch ( inMsg->clusterID )
   \   00000E   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   000011   F5..         MOV     ?V0 + 1,A
   \   000013   78..         MOV     R0,#?V0 + 0
   \   000015   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for ZDApp_ProcessMsgCBs>_0`:
   \   000018   0300         DW        3
   \   00001A   2100         DW        33
   \   00001C   2200         DW        34
   \   00001E   ....         DW        ??ZDApp_ProcessMsgCBs_0
   \   000020   0080         DW        32768
   \   000022   0180         DW        32769
   \   000024   ....         DW        ??ZDApp_ProcessMsgCBs_1
   \   000026   2180         DW        32801
   \   000028   2280         DW        32802
   \   00002A   ....         DW        ??ZDApp_ProcessMsgCBs_2
   \   00002C   0100         DW        1
   \   00002E   2000         DW        32
   \   000030   ....         DW        ??ZDApp_ProcessMsgCBs_3
   \   000032   ....         DW        ??ZDApp_ProcessMsgCBs_4
   1164            {
   1165          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1166              case NWK_addr_rsp:
   1167              case IEEE_addr_rsp:
   1168                {
   1169                  ZDO_NwkIEEEAddrResp_t *pAddrRsp;
   1170                  pAddrRsp = ZDO_ParseAddrRsp( inMsg );
   \                     ??ZDApp_ProcessMsgCBs_1:
   \   000034                ; Setup parameters for call to function ZDO_ParseAddrRsp
   \   000034   12....       LCALL   ??ZDO_ParseAddrRsp?relay
   \   000037   8A..         MOV     ?V0 + 0,R2
   \   000039   8B..         MOV     ?V0 + 1,R3
   \   00003B   AE..         MOV     R6,?V0 + 0
   \   00003D   AF..         MOV     R7,?V0 + 1
   1171                  if ( pAddrRsp )
   \   00003F   EE           MOV     A,R6
   \   000040   7001         JNZ     ??ZDApp_ProcessMsgCBs_5
   \   000042   EF           MOV     A,R7
   \                     ??ZDApp_ProcessMsgCBs_5:
   \   000043   7003         JNZ     $+5
   \   000045   02....       LJMP    ??ZDApp_ProcessMsgCBs_4 & 0xFFFF
   1172                  {
   1173                    if ( pAddrRsp->status == ZSuccess )
   \   000048   8E82         MOV     DPL,R6
   \   00004A   8F83         MOV     DPH,R7
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   700E         JNZ     ??ZDApp_ProcessMsgCBs_6
   1174                    {
   1175                      ZDO_UpdateAddrManager( pAddrRsp->nwkAddr, pAddrRsp->extAddr );
   \   00004F                ; Setup parameters for call to function ZDO_UpdateAddrManager
   \   00004F   EE           MOV     A,R6
   \   000050   2403         ADD     A,#0x3
   \   000052   FC           MOV     R4,A
   \   000053   EF           MOV     A,R7
   \   000054   3400         ADDC    A,#0x0
   \   000056   FD           MOV     R5,A
   \   000057   12....       LCALL   ?Subroutine22 & 0xFFFF
   1176                    }
   \                     ??CrossCallReturnLabel_58:
   \   00005A   12....       LCALL   ??ZDO_UpdateAddrManager?relay
   1177                    osal_mem_free( pAddrRsp );
   \                     ??ZDApp_ProcessMsgCBs_6:
   \   00005D                ; Setup parameters for call to function osal_mem_free
   \   00005D   EE           MOV     A,R6
   \   00005E   FA           MOV     R2,A
   \   00005F   EF           MOV     A,R7
   \   000060   02....       LJMP    ??ZDApp_ProcessMsgCBs_7 & 0xFFFF
   1178                  }
   1179                }
   1180                break;
   1181          #endif
   1182                
   1183          #if defined ( REFLECTOR )
   1184              case Bind_req:
   1185              case Unbind_req:
   1186                {
   1187                  ZDO_BindUnbindReq_t bindReq;
   1188                  ZDO_ParseBindUnbindReq( inMsg, &bindReq );
   \                     ??ZDApp_ProcessMsgCBs_0:
   \   000063                ; Setup parameters for call to function ZDO_ParseBindUnbindReq
   \   000063   7417         MOV     A,#0x17
   \   000065   12....       LCALL   ?XSTACK_DISP0_8
   \   000068   AC82         MOV     R4,DPL
   \   00006A   AD83         MOV     R5,DPH
   \   00006C   12....       LCALL   ??ZDO_ParseBindUnbindReq?relay
   1189                  ZDO_ProcessBindUnbindReq( inMsg, &bindReq );
   \   00006F                ; Setup parameters for call to function ZDO_ProcessBindUnbindReq
   \   00006F   7417         MOV     A,#0x17
   \   000071   12....       LCALL   ?XSTACK_DISP0_8
   \   000074   AC82         MOV     R4,DPL
   \   000076   AD83         MOV     R5,DPH
   \   000078   EE           MOV     A,R6
   \   000079   FA           MOV     R2,A
   \   00007A   EF           MOV     A,R7
   \   00007B   FB           MOV     R3,A
   \   00007C   12....       LCALL   ??ZDO_ProcessBindUnbindReq?relay
   \   00007F   8076         SJMP    ??ZDApp_ProcessMsgCBs_4
   1190                }
   1191                break;
   1192          #endif      
   1193          
   1194          #if ( ZG_BUILD_COORDINATOR_TYPE )
   1195              case Bind_rsp:
   1196              case Unbind_rsp:
   1197                if (ZG_DEVICE_COORDINATOR_TYPE && matchED)
   \                     ??ZDApp_ProcessMsgCBs_2:
   \   000081   90....       MOV     DPTR,#matchED
   \   000084   E0           MOVX    A,@DPTR
   \   000085   7002         JNZ     ??ZDApp_ProcessMsgCBs_8
   \   000087   A3           INC     DPTR
   \   000088   E0           MOVX    A,@DPTR
   \                     ??ZDApp_ProcessMsgCBs_8:
   \   000089   606C         JZ      ??ZDApp_ProcessMsgCBs_4
   1198                {
   1199                  ZDMatchSendState(
   1200                       (uint8)((inMsg->clusterID == Bind_rsp) ? ZDMATCH_REASON_BIND_RSP : ZDMATCH_REASON_UNBIND_RSP),
   1201                       ZDO_ParseBindRsp(inMsg), inMsg->TransSeq );
   \   00008B   EE           MOV     A,R6
   \   00008C   240C         ADD     A,#0xc
   \   00008E   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   1202                }
   \                     ??CrossCallReturnLabel_95:
   \   000091   6421         XRL     A,#0x21
   \   000093   7004         JNZ     ??ZDApp_ProcessMsgCBs_9
   \   000095   A3           INC     DPTR
   \   000096   E0           MOVX    A,@DPTR
   \   000097   6480         XRL     A,#0x80
   \                     ??ZDApp_ProcessMsgCBs_9:
   \   000099   7004         JNZ     ??ZDApp_ProcessMsgCBs_10
   \   00009B   7903         MOV     R1,#0x3
   \   00009D   8002         SJMP    ??ZDApp_ProcessMsgCBs_11
   \                     ??ZDApp_ProcessMsgCBs_10:
   \   00009F   7902         MOV     R1,#0x2
   \                     ??ZDApp_ProcessMsgCBs_11:
   \   0000A1                ; Setup parameters for call to function ZDMatchSendState
   \   0000A1   EE           MOV     A,R6
   \   0000A2   240F         ADD     A,#0xf
   \   0000A4   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_96:
   \   0000A7   FB           MOV     R3,A
   \   0000A8   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_90:
   \   0000AB   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   0000AE   E0           MOVX    A,@DPTR
   \   0000AF   FA           MOV     R2,A
   \   0000B0   12....       LCALL   ??ZDMatchSendState?relay
   \   0000B3   8042         SJMP    ??ZDApp_ProcessMsgCBs_4
   1203                break;
   1204                
   1205              case End_Device_Bind_req:
   1206                if (ZG_DEVICE_COORDINATOR_TYPE)
   1207                {
   1208                  ZDEndDeviceBind_t bindReq;
   1209                  ZDO_ParseEndDeviceBindReq( inMsg, &bindReq );
   \                     ??ZDApp_ProcessMsgCBs_3:
   \   0000B5                ; Setup parameters for call to function ZDO_ParseEndDeviceBindReq
   \   0000B5   85..82       MOV     DPL,?XSP + 0
   \   0000B8   85..83       MOV     DPH,?XSP + 1
   \   0000BB   AC82         MOV     R4,DPL
   \   0000BD   AD83         MOV     R5,DPH
   \   0000BF   12....       LCALL   ??ZDO_ParseEndDeviceBindReq?relay
   1210                  ZDO_MatchEndDeviceBind( &bindReq );
   \   0000C2                ; Setup parameters for call to function ZDO_MatchEndDeviceBind
   \   0000C2   85..82       MOV     DPL,?XSP + 0
   \   0000C5   85..83       MOV     DPH,?XSP + 1
   \   0000C8   AA82         MOV     R2,DPL
   \   0000CA   AB83         MOV     R3,DPH
   \   0000CC   12....       LCALL   ??ZDO_MatchEndDeviceBind?relay
   1211                  
   1212                  // Freeing the cluster lists - if allocated.
   1213                  if ( bindReq.numInClusters )
   \   0000CF   7411         MOV     A,#0x11
   \   0000D1   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D4   E0           MOVX    A,@DPTR
   \   0000D5   600B         JZ      ??ZDApp_ProcessMsgCBs_12
   1214                    osal_mem_free( bindReq.inClusters );
   \   0000D7                ; Setup parameters for call to function osal_mem_free
   \   0000D7   7412         MOV     A,#0x12
   \   0000D9   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DC   12....       LCALL   ??Subroutine36_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_57:
   \   0000DF   12....       LCALL   ??osal_mem_free?relay
   1215                  if ( bindReq.numOutClusters )
   \                     ??ZDApp_ProcessMsgCBs_12:
   \   0000E2   7414         MOV     A,#0x14
   \   0000E4   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E7   E0           MOVX    A,@DPTR
   \   0000E8   600D         JZ      ??ZDApp_ProcessMsgCBs_4
   1216                    osal_mem_free( bindReq.outClusters );
   \   0000EA                ; Setup parameters for call to function osal_mem_free
   \   0000EA   7415         MOV     A,#0x15
   \   0000EC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EF   E0           MOVX    A,@DPTR
   \   0000F0   FA           MOV     R2,A
   \   0000F1   A3           INC     DPTR
   \   0000F2   E0           MOVX    A,@DPTR
   \                     ??ZDApp_ProcessMsgCBs_7:
   \   0000F3   FB           MOV     R3,A
   \   0000F4   12....       LCALL   ??osal_mem_free?relay
   1217                }
   1218                break;
   1219          #endif
   1220            }
   1221          }
   \                     ??ZDApp_ProcessMsgCBs_4:
   \   0000F7   742C         MOV     A,#0x2c
   \   0000F9   02....       LJMP    ??Subroutine41_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   A3           INC     DPTR
   \   000001                REQUIRE ??Subroutine36_0
   \   000001                ; // Fall through to label ??Subroutine36_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine27:
   \   000000   EE           MOV     A,R6
   \   000001   2413         ADD     A,#0x13
   \   000003                REQUIRE ??Subroutine46_0
   \   000003                ; // Fall through to label ??Subroutine46_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine46_0:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine47_0
   \   000003                ; // Fall through to label ??Subroutine47_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine47_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine48_0:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine49_0
   \   000003                ; // Fall through to label ??Subroutine49_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine49_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   E0           MOVX    A,@DPTR
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   EE           MOV     A,R6
   \   000001   240C         ADD     A,#0xc
   \   000003   F582         MOV     DPL,A
   \   000005   EF           MOV     A,R7
   \   000006   3400         ADDC    A,#0x0
   \   000008   F583         MOV     DPH,A
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   F5..         MOV     ?V0 + 0,A
   \   00000D   A3           INC     DPTR
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   22           RET
   1222          
   1223          /*********************************************************************
   1224           * @fn      ZDApp_RegisterCBs()
   1225           *
   1226           * @brief   Process response messages
   1227           *
   1228           * @param   none
   1229           *
   1230           * @return  none
   1231           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1232          void ZDApp_RegisterCBs( void )
   \                     ZDApp_RegisterCBs:
   1233          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1234          #if defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1235            ZDO_RegisterForZDOMsg( ZDAppTaskID, IEEE_addr_rsp );
   \   000004                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000004   7A01         MOV     R2,#0x1
   \   000006   12....       LCALL   ?Subroutine14 & 0xFFFF
   1236          #endif
   1237          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( REFLECTOR )
   1238            ZDO_RegisterForZDOMsg( ZDAppTaskID, NWK_addr_rsp );
   \                     ??CrossCallReturnLabel_60:
   \   000009                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000009   7A00         MOV     R2,#0x0
   \   00000B   12....       LCALL   ?Subroutine14 & 0xFFFF
   1239          #endif  
   1240          #if ZG_BUILD_COORDINATOR_TYPE
   1241            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_rsp );
   \                     ??CrossCallReturnLabel_61:
   \   00000E                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00000E   7A21         MOV     R2,#0x21
   \   000010   12....       LCALL   ?Subroutine14 & 0xFFFF
   1242            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_rsp );
   \                     ??CrossCallReturnLabel_62:
   \   000013                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000013   7A22         MOV     R2,#0x22
   \   000015   12....       LCALL   ?Subroutine14 & 0xFFFF
   1243            ZDO_RegisterForZDOMsg( ZDAppTaskID, End_Device_Bind_req );
   \                     ??CrossCallReturnLabel_63:
   \   000018                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000018   7A20         MOV     R2,#0x20
   \   00001A   7B00         MOV     R3,#0x0
   \   00001C   12....       LCALL   ??Subroutine37_0 & 0xFFFF
   1244          #endif
   1245          #if defined ( REFLECTOR )
   1246            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_req );
   \                     ??CrossCallReturnLabel_64:
   \   00001F                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00001F   7A21         MOV     R2,#0x21
   \   000021   7B00         MOV     R3,#0x0
   \   000023   12....       LCALL   ??Subroutine37_0 & 0xFFFF
   1247            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_req );
   \                     ??CrossCallReturnLabel_65:
   \   000026                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000026   7A22         MOV     R2,#0x22
   \   000028   7B00         MOV     R3,#0x0
   \   00002A   12....       LCALL   ??Subroutine37_0 & 0xFFFF
   1248          #endif  
   1249          }
   \                     ??CrossCallReturnLabel_66:
   \   00002D   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   7B80         MOV     R3,#-0x80
   \   000002                REQUIRE ??Subroutine37_0
   \   000002                ; // Fall through to label ??Subroutine37_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine37_0:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   \   000008   22           RET
   1250          
   1251          /*********************************************************************
   1252           * @fn      ZDApp_ProcessSecMsg()
   1253           *
   1254           * @brief   Process the incoming security message.
   1255           *
   1256           * @param   msgPtr - message to process
   1257           *
   1258           * @return  none
   1259           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1260          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessSecMsg:
   1261          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1262            switch ( msgPtr->event )
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   E0           MOVX    A,@DPTR
   \   000009   12....       LCALL   ?UC_SWITCH_DENSE
   \                     `?<Jumptable for ZDApp_ProcessSecMsg>_0`:
   \   00000C   04           DB        4
   \   00000D   08           DB        8
   \   00000E   ....         DW        ??ZDApp_ProcessSecMsg_0
   \   000010   ....         DW        ??ZDApp_ProcessSecMsg_0
   \   000012   ....         DW        ??ZDApp_ProcessSecMsg_0
   \   000014   ....         DW        ??ZDApp_ProcessSecMsg_0
   \   000016   ....         DW        ??ZDApp_ProcessSecMsg_1
   \   000018   ....         DW        ??ZDApp_ProcessSecMsg_0
   \   00001A   ....         DW        ??ZDApp_ProcessSecMsg_0
   \   00001C   ....         DW        ??ZDApp_ProcessSecMsg_0
   \   00001E   ....         DW        ??ZDApp_ProcessSecMsg_0
   \   000020   ....         DW        ??ZDApp_ProcessSecMsg_0
   1263            {
   1264              case ZDO_ESTABLISH_KEY_CFM:
   1265                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1266                {
   1267                  ZDSecMgrEstablishKeyCfm( (ZDO_EstablishKeyCfm_t*)msgPtr );
   1268                }
   1269                break;
   1270          
   1271              case ZDO_ESTABLISH_KEY_IND:
   1272                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1273                {
   1274                  if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1275                  {
   1276                    ZDSecMgrEstablishKeyInd( (ZDO_EstablishKeyInd_t*)msgPtr );
   1277                  }
   1278                }
   1279                break;
   1280          
   1281              case ZDO_TRANSPORT_KEY_IND:
   1282                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1283                {
   1284                  ZDSecMgrTransportKeyInd( (ZDO_TransportKeyInd_t*)msgPtr );
   1285                }
   1286                break;
   1287          
   1288              case ZDO_UPDATE_DEVICE_IND:
   1289                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1290                {
   1291                  ZDSecMgrUpdateDeviceInd( (ZDO_UpdateDeviceInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_1:
   \   000022                ; Setup parameters for call to function ZDSecMgrUpdateDeviceInd
   \   000022   12....       LCALL   ??ZDSecMgrUpdateDeviceInd?relay
   1292                }
   1293                break;
   1294          
   1295              case ZDO_REMOVE_DEVICE_IND:
   1296                if ( ZG_BUILD_RTRONLY_TYPE && ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER ) )
   1297                {
   1298                  ZDSecMgrRemoveDeviceInd( (ZDO_RemoveDeviceInd_t*)msgPtr );
   1299                }
   1300                break;
   1301          
   1302              case ZDO_REQUEST_KEY_IND:
   1303                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1304                {
   1305                  if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1306                  {
   1307                    ZDSecMgrRequestKeyInd( (ZDO_RequestKeyInd_t*)msgPtr );
   1308                  }
   1309                }
   1310                break;
   1311          
   1312              case ZDO_SWITCH_KEY_IND:
   1313                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1314                {
   1315                  ZDSecMgrSwitchKeyInd( (ZDO_SwitchKeyInd_t*)msgPtr );
   1316                }
   1317                break;
   1318              
   1319              case ZDO_AUTHENTICATE_IND:
   1320                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1321                {
   1322                  ZDSecMgrAuthenticateInd( (ZDO_AuthenticateInd_t*)msgPtr );
   1323                }
   1324                break;
   1325          
   1326              case ZDO_AUTHENTICATE_CFM:
   1327                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1328                {
   1329                  ZDSecMgrAuthenticateCfm( (ZDO_AuthenticateCfm_t*)msgPtr );
   1330                }
   1331                break;
   1332          
   1333              default:
   1334                // Unsupported messages
   1335                break;
   1336            }
   1337          }
   \                     ??ZDApp_ProcessSecMsg_0:
   \   000025   02....       LJMP    ?Subroutine2 & 0xFFFF
   1338          
   1339          /*********************************************************************
   1340           * @fn      ZDApp_ProcessNetworkJoin()
   1341           *
   1342           * @brief
   1343           *
   1344           *   Save off the Network key information.
   1345           *
   1346           * @param   none
   1347           *
   1348           * @return  none
   1349           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1350          void ZDApp_ProcessNetworkJoin( void )
   \                     ZDApp_ProcessNetworkJoin:
   1351          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1352            if ( (devState == DEV_NWK_JOINING) ||
   1353                ((devState == DEV_NWK_ORPHAN)  &&
   1354                 (ZDO_Config_Node_Descriptor.LogicalType == NODETYPE_ROUTER)) )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6403         XRL     A,#0x3
   \   000010   6015         JZ      ??ZDApp_ProcessNetworkJoin_0
   \   000012   E0           MOVX    A,@DPTR
   \   000013   640A         XRL     A,#0xa
   \   000015   6003         JZ      $+5
   \   000017   02....       LJMP    ??ZDApp_ProcessNetworkJoin_1 & 0xFFFF
   \   00001A   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   5407         ANL     A,#0x7
   \   000020   6401         XRL     A,#0x1
   \   000022   6003         JZ      $+5
   \   000024   02....       LJMP    ??ZDApp_ProcessNetworkJoin_2 & 0xFFFF
   1355            {
   1356              // Result of a Join attempt by this device.
   1357              if ( nwkStatus == ZSuccess )
   \                     ??ZDApp_ProcessNetworkJoin_0:
   \   000027   90....       MOV     DPTR,#nwkStatus
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   703A         JNZ     ??ZDApp_ProcessNetworkJoin_3
   1358              {
   1359                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00002D                ; Setup parameters for call to function osal_set_event
   \   00002D   12....       LCALL   ?Subroutine13 & 0xFFFF
   1360          
   1361          #if defined ( POWER_SAVING )
   1362                osal_pwrmgr_device( PWRMGR_BATTERY );
   1363          #endif
   1364          
   1365                if ( ZG_SECURE_ENABLED && ( ZDApp_RestoreNwkKey() == false ) )
   1366                {
   1367                  // wait for auth from trust center!!
   1368                  devState = DEV_END_DEVICE_UNAUTH;
   1369          
   1370                  // Start the reset timer for MAX UNAUTH time
   1371                  ZDApp_ResetTimerStart( 10000 );//MAX_DEVICE_UNAUTH_TIMEOUT );
   1372                }
   1373                else
   1374                {
   1375                  if ( ZSTACK_ROUTER_BUILD )
   1376                  {
   1377                    if ( devState == DEV_NWK_ORPHAN 
   1378                      && ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   \                     ??CrossCallReturnLabel_50:
   \   000030   90....       MOV     DPTR,#devState
   \   000033   E0           MOVX    A,@DPTR
   \   000034   640A         XRL     A,#0xa
   \   000036   700D         JNZ     ??ZDApp_ProcessNetworkJoin_4
   \   000038   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_20:
   \   00003B   6010         JZ      ??ZDApp_ProcessNetworkJoin_5
   1379                    {
   1380                      // Change NIB state to router for restore
   1381                      _NIB.nwkState = NWK_ROUTER;
   \   00003D   7408         MOV     A,#0x8
   \   00003F   90....       MOV     DPTR,#(_NIB + 35)
   \   000042   F0           MOVX    @DPTR,A
   \   000043   8008         SJMP    ??ZDApp_ProcessNetworkJoin_5
   1382                    }
   1383                  }
   1384                          
   1385                  if ( devState == DEV_NWK_JOINING )
   \                     ??ZDApp_ProcessNetworkJoin_4:
   \   000045   E0           MOVX    A,@DPTR
   \   000046   6403         XRL     A,#0x3
   \   000048   7003         JNZ     ??ZDApp_ProcessNetworkJoin_5
   1386                  {
   1387                    ZDApp_AnnounceNewAddress();
   \   00004A                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   00004A   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   1388                  }
   1389                  
   1390                  devState = DEV_END_DEVICE;
   \                     ??ZDApp_ProcessNetworkJoin_5:
   \   00004D   7406         MOV     A,#0x6
   \   00004F   90....       MOV     DPTR,#devState
   \   000052   F0           MOVX    @DPTR,A
   1391                  if ( ZSTACK_ROUTER_BUILD )
   1392                  {
   1393                    // NOTE: first two parameters are not used, see NLMEDE.h for details
   1394                    if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   \   000053   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   000056   7003         JNZ     $+5
   \   000058   02....       LJMP    ??CrossCallReturnLabel_51 & 0xFFFF
   1395                    {
   1396                      NLME_StartRouterRequest( 0, 0, false );
   \   00005B                ; Setup parameters for call to function NLME_StartRouterRequest
   \   00005B   7B00         MOV     R3,#0x0
   \   00005D   7A00         MOV     R2,#0x0
   \   00005F   7900         MOV     R1,#0x0
   \   000061   12....       LCALL   ??NLME_StartRouterRequest?relay
   \   000064   02....       LJMP    ??CrossCallReturnLabel_51 & 0xFFFF
   1397                    }
   1398                  }
   1399                }
   1400              }
   1401              else
   1402              {
   1403                if ( (devStartMode == MODE_RESUME) && (++retryCnt >= MAX_RESUME_RETRY) )
   \                     ??ZDApp_ProcessNetworkJoin_3:
   \   000067   90....       MOV     DPTR,#devStartMode
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   6401         XRL     A,#0x1
   \   00006D   7039         JNZ     ??ZDApp_ProcessNetworkJoin_6
   \   00006F   90....       MOV     DPTR,#retryCnt
   \   000072   E0           MOVX    A,@DPTR
   \   000073   04           INC     A
   \   000074   F0           MOVX    @DPTR,A
   \   000075   C3           CLR     C
   \   000076   9403         SUBB    A,#0x3
   \   000078   402E         JC      ??ZDApp_ProcessNetworkJoin_6
   1404                {
   1405                  if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   00007A   90....       MOV     DPTR,#(_NIB + 33)
   \   00007D   E0           MOVX    A,@DPTR
   \   00007E   64FF         XRL     A,#0xff
   \   000080   7004         JNZ     ??ZDApp_ProcessNetworkJoin_7
   \   000082   A3           INC     DPTR
   \   000083   E0           MOVX    A,@DPTR
   \   000084   64FF         XRL     A,#0xff
   \                     ??ZDApp_ProcessNetworkJoin_7:
   \   000086   600E         JZ      ??ZDApp_ProcessNetworkJoin_8
   \   000088   90....       MOV     DPTR,#(_NIB + 33)
   \   00008B   E0           MOVX    A,@DPTR
   \   00008C   64FE         XRL     A,#0xfe
   \   00008E   7004         JNZ     ??ZDApp_ProcessNetworkJoin_9
   \   000090   A3           INC     DPTR
   \   000091   E0           MOVX    A,@DPTR
   \   000092   64FF         XRL     A,#0xff
   \                     ??ZDApp_ProcessNetworkJoin_9:
   \   000094   7006         JNZ     ??ZDApp_ProcessNetworkJoin_10
   1406                    devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_8:
   \   000096   E4           CLR     A
   \   000097   90....       MOV     DPTR,#devStartMode
   \   00009A   800B         SJMP    ??ZDApp_ProcessNetworkJoin_11
   1407                  else
   1408                  {
   1409                    devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_10:
   \   00009C   7403         MOV     A,#0x3
   \   00009E   90....       MOV     DPTR,#devStartMode
   \   0000A1   F0           MOVX    @DPTR,A
   1410                    _tmpRejoinState = true;
   \   0000A2   7401         MOV     A,#0x1
   \   0000A4   90....       MOV     DPTR,#_tmpRejoinState
   \                     ??ZDApp_ProcessNetworkJoin_11:
   \   0000A7   F0           MOVX    @DPTR,A
   1411                  }
   1412                }
   1413          
   1414                if ( (NLME_GetShortAddr() != INVALID_NODE_ADDR) ||
   1415                     (_NIB.nwkDevAddress != INVALID_NODE_ADDR) )
   \                     ??ZDApp_ProcessNetworkJoin_6:
   \   0000A8                ; Setup parameters for call to function NLME_GetShortAddr
   \   0000A8   12....       LCALL   ??NLME_GetShortAddr?relay
   \   0000AB   8A..         MOV     ?V0 + 0,R2
   \   0000AD   8B..         MOV     ?V0 + 1,R3
   \   0000AF   74FE         MOV     A,#-0x2
   \   0000B1   65..         XRL     A,?V0 + 0
   \   0000B3   7004         JNZ     ??ZDApp_ProcessNetworkJoin_12
   \   0000B5   74FF         MOV     A,#-0x1
   \   0000B7   65..         XRL     A,?V0 + 1
   \                     ??ZDApp_ProcessNetworkJoin_12:
   \   0000B9   700E         JNZ     ??ZDApp_ProcessNetworkJoin_13
   \   0000BB   90....       MOV     DPTR,#(_NIB + 20)
   \   0000BE   E0           MOVX    A,@DPTR
   \   0000BF   64FE         XRL     A,#0xfe
   \   0000C1   7004         JNZ     ??ZDApp_ProcessNetworkJoin_14
   \   0000C3   A3           INC     DPTR
   \   0000C4   E0           MOVX    A,@DPTR
   \   0000C5   64FF         XRL     A,#0xff
   \                     ??ZDApp_ProcessNetworkJoin_14:
   \   0000C7   601E         JZ      ??ZDApp_ProcessNetworkJoin_15
   1416                {
   1417                  uint16 addr = INVALID_NODE_ADDR;
   \                     ??ZDApp_ProcessNetworkJoin_13:
   \   0000C9   85..82       MOV     DPL,?XSP + 0
   \   0000CC   85..83       MOV     DPH,?XSP + 1
   \   0000CF   74FE         MOV     A,#-0x2
   \   0000D1   F0           MOVX    @DPTR,A
   \   0000D2   A3           INC     DPTR
   \   0000D3   74FF         MOV     A,#-0x1
   \   0000D5   F0           MOVX    @DPTR,A
   1418                  // Invalidate nwk addr so end device does not use in its data reqs.
   1419                  _NIB.nwkDevAddress = INVALID_NODE_ADDR;
   \   0000D6   90....       MOV     DPTR,#(_NIB + 20)
   \   0000D9   74FE         MOV     A,#-0x2
   \   0000DB   F0           MOVX    @DPTR,A
   \   0000DC   A3           INC     DPTR
   \   0000DD   74FF         MOV     A,#-0x1
   \   0000DF   12....       LCALL   ?Subroutine8 & 0xFFFF
   1420                  ZMacSetReq( ZMacShortAddress, (uint8 *)&addr );
   1421                }
   \                     ??CrossCallReturnLabel_2:
   \   0000E2   7953         MOV     R1,#0x53
   \   0000E4   12....       LCALL   ??ZMacSetReq?relay
   1422          
   1423                // Clear the neighbor Table and network discovery tables.
   1424                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_15:
   \   0000E7                ; Setup parameters for call to function nwkNeighborInitTable
   \   0000E7   12....       LCALL   ??nwkNeighborInitTable?relay
   1425                NLME_NwkDiscTerm();
   \   0000EA                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   0000EA   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1426          
   1427                zdoDiscCounter = 1;
   \   0000ED   7401         MOV     A,#0x1
   \   0000EF   90....       MOV     DPTR,#zdoDiscCounter
   \   0000F2   F0           MOVX    @DPTR,A
   1428          
   1429          //      ZDApp_NetworkInit( (uint16)
   1430          //                         ((NWK_START_DELAY * (osal_rand() & 0x0F)) +
   1431          //                          (NWK_START_DELAY * 5)) );
   1432                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1433                     + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   0000F3                ; Setup parameters for call to function ZDApp_NetworkInit
   \   0000F3                ; Setup parameters for call to function osal_rand
   \                     ??ZDApp_ProcessNetworkJoin_16:
   \   0000F3   12....       LCALL   ??osal_rand?relay
   \   0000F6   8A..         MOV     ?V0 + 0,R2
   \   0000F8   747F         MOV     A,#0x7f
   \   0000FA   55..         ANL     A,?V0 + 0
   \   0000FC   F8           MOV     R0,A
   \   0000FD   7464         MOV     A,#0x64
   \   0000FF   28           ADD     A,R0
   \   000100   FA           MOV     R2,A
   \   000101   7B00         MOV     R3,#0x0
   \   000103   12....       LCALL   ??ZDApp_NetworkInit?relay
   \   000106   02....       LJMP    ??CrossCallReturnLabel_51 & 0xFFFF
   1434              }
   1435            }
   1436            else if ( devState == DEV_NWK_ORPHAN || devState == DEV_NWK_REJOIN )
   \                     ??ZDApp_ProcessNetworkJoin_1:
   \   000109   E0           MOVX    A,@DPTR
   \   00010A   6404         XRL     A,#0x4
   \   00010C   6003         JZ      $+5
   \   00010E   02....       LJMP    ??ZDApp_ProcessNetworkJoin_17 & 0xFFFF
   1437            {
   1438              // results of an orphaning attempt by this device
   1439              if (nwkStatus == ZSuccess)
   \                     ??ZDApp_ProcessNetworkJoin_2:
   \   000111   90....       MOV     DPTR,#nwkStatus
   \   000114   E0           MOVX    A,@DPTR
   \   000115   7033         JNZ     ??ZDApp_ProcessNetworkJoin_18
   1440              {
   1441                if ( ZG_SECURE_ENABLED )
   1442                {
   1443                  ZDApp_RestoreNwkKey();
   1444                }
   1445                
   1446                devState = DEV_END_DEVICE;
   \   000117   12....       LCALL   ?Subroutine7 & 0xFFFF
   1447                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   1448                // setup Power Manager Device
   1449          #if defined ( POWER_SAVING )
   1450                osal_pwrmgr_device( PWRMGR_BATTERY );
   1451          #endif
   1452          
   1453                if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \                     ??CrossCallReturnLabel_1:
   \   00011A   90....       MOV     DPTR,#(ZDO_Config_Node_Descriptor + 2)
   \   00011D   E0           MOVX    A,@DPTR
   \   00011E   A2E3         MOV     C,0xE0 /* A   */.3
   \   000120   5015         JNC     ??ZDApp_ProcessNetworkJoin_19
   1454                {
   1455                  // The receiver is on, turn network layer polling off.
   1456                  NLME_SetPollRate( 0 );
   \   000122                ; Setup parameters for call to function NLME_SetPollRate
   \   000122   7A00         MOV     R2,#0x0
   \   000124   7B00         MOV     R3,#0x0
   \   000126   12....       LCALL   ??NLME_SetPollRate?relay
   1457                  NLME_SetQueuedPollRate( 0 );
   \   000129                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000129   7A00         MOV     R2,#0x0
   \   00012B   7B00         MOV     R3,#0x0
   \   00012D   12....       LCALL   ??NLME_SetQueuedPollRate?relay
   1458                  NLME_SetResponseRate( 0 );
   \   000130                ; Setup parameters for call to function NLME_SetResponseRate
   \   000130   7A00         MOV     R2,#0x0
   \   000132   7B00         MOV     R3,#0x0
   \   000134   12....       LCALL   ??NLME_SetResponseRate?relay
   1459                }
   1460          
   1461                if ( ZSTACK_ROUTER_BUILD )
   1462                {
   1463                  // NOTE: first two parameters are not used, see NLMEDE.h for details
   1464                  if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   \                     ??ZDApp_ProcessNetworkJoin_19:
   \   000137   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   00013A   6009         JZ      ??ZDApp_ProcessNetworkJoin_20
   1465                  {
   1466                    NLME_StartRouterRequest( 0, 0, false );
   \   00013C                ; Setup parameters for call to function NLME_StartRouterRequest
   \   00013C   7B00         MOV     R3,#0x0
   \   00013E   7A00         MOV     R2,#0x0
   \   000140   7900         MOV     R1,#0x0
   \   000142   12....       LCALL   ??NLME_StartRouterRequest?relay
   1467                  }
   1468                }
   1469                
   1470                ZDApp_AnnounceNewAddress();
   \                     ??ZDApp_ProcessNetworkJoin_20:
   \   000145                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000145   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   \   000148   8062         SJMP    ??CrossCallReturnLabel_51
   1471              }
   1472              else
   1473              {
   1474                if ( devStartMode == MODE_RESUME )
   \                     ??ZDApp_ProcessNetworkJoin_18:
   \   00014A   90....       MOV     DPTR,#devStartMode
   \   00014D   E0           MOVX    A,@DPTR
   \   00014E   6401         XRL     A,#0x1
   \   000150   7043         JNZ     ??ZDApp_ProcessNetworkJoin_21
   1475                {
   1476                  if ( ++retryCnt <= MAX_RESUME_RETRY )
   \   000152   90....       MOV     DPTR,#retryCnt
   \   000155   E0           MOVX    A,@DPTR
   \   000156   04           INC     A
   \   000157   F0           MOVX    @DPTR,A
   \   000158   C3           CLR     C
   \   000159   9404         SUBB    A,#0x4
   \   00015B   5030         JNC     ??ZDApp_ProcessNetworkJoin_22
   1477                  {
   1478                    if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   00015D   90....       MOV     DPTR,#(_NIB + 33)
   \   000160   E0           MOVX    A,@DPTR
   \   000161   64FF         XRL     A,#0xff
   \   000163   7004         JNZ     ??ZDApp_ProcessNetworkJoin_23
   \   000165   A3           INC     DPTR
   \   000166   E0           MOVX    A,@DPTR
   \   000167   64FF         XRL     A,#0xff
   \                     ??ZDApp_ProcessNetworkJoin_23:
   \   000169   600E         JZ      ??ZDApp_ProcessNetworkJoin_24
   \   00016B   90....       MOV     DPTR,#(_NIB + 33)
   \   00016E   E0           MOVX    A,@DPTR
   \   00016F   64FE         XRL     A,#0xfe
   \   000171   7004         JNZ     ??ZDApp_ProcessNetworkJoin_25
   \   000173   A3           INC     DPTR
   \   000174   E0           MOVX    A,@DPTR
   \   000175   64FF         XRL     A,#0xff
   \                     ??ZDApp_ProcessNetworkJoin_25:
   \   000177   7007         JNZ     ??ZDApp_ProcessNetworkJoin_26
   1479                      devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_24:
   \   000179   E4           CLR     A
   \   00017A   90....       MOV     DPTR,#devStartMode
   \                     ??ZDApp_ProcessNetworkJoin_27:
   \   00017D   F0           MOVX    @DPTR,A
   \   00017E   8015         SJMP    ??ZDApp_ProcessNetworkJoin_21
   1480                    else
   1481                    {
   1482                      devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_26:
   \   000180   7403         MOV     A,#0x3
   \   000182   90....       MOV     DPTR,#devStartMode
   \   000185   F0           MOVX    @DPTR,A
   1483                      _tmpRejoinState = true;
   \   000186   7401         MOV     A,#0x1
   \   000188   90....       MOV     DPTR,#_tmpRejoinState
   \   00018B   80F0         SJMP    ??ZDApp_ProcessNetworkJoin_27
   1484                    }
   1485                  }
   1486                  // Do a normal join to the network after certain times of rejoin retries
   1487                  else if( AIB_apsUseInsecureJoin == true )
   \                     ??ZDApp_ProcessNetworkJoin_22:
   \   00018D   90....       MOV     DPTR,#AIB_apsUseInsecureJoin
   \   000190   E0           MOVX    A,@DPTR
   \   000191   6401         XRL     A,#0x1
   \   000193   60E4         JZ      ??ZDApp_ProcessNetworkJoin_24
   1488                  {
   1489                    devStartMode = MODE_JOIN;
   1490                  }
   1491                }
   1492          
   1493                // Clear the neighbor Table and network discovery tables.
   1494                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_21:
   \   000195                ; Setup parameters for call to function nwkNeighborInitTable
   \   000195   12....       LCALL   ??nwkNeighborInitTable?relay
   1495                NLME_NwkDiscTerm();
   \   000198                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   000198   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1496          
   1497                // setup a retry for later...
   1498                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1499                     + (osal_rand()& EXTENDED_JOINING_RANDOM_MASK)) );
   \   00019B                ; Setup parameters for call to function ZDApp_NetworkInit
   \   00019B                ; Setup parameters for call to function osal_rand
   \   00019B   02....       LJMP    ??ZDApp_ProcessNetworkJoin_16 & 0xFFFF
   1500              }
   1501            }
   1502          #if defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
   1503            else
   1504            {
   1505              // Assume from address conflict
   1506              if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \                     ??ZDApp_ProcessNetworkJoin_17:
   \   00019E   90....       MOV     DPTR,#(_NIB + 96)
   \   0001A1   E0           MOVX    A,@DPTR
   \   0001A2   6402         XRL     A,#0x2
   \   0001A4   7006         JNZ     ??CrossCallReturnLabel_51
   1507              {
   1508                // Notify the network
   1509                ZDApp_AnnounceNewAddress();
   \   0001A6                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   0001A6   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   1510                
   1511                // Notify apps
   1512                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   0001A9                ; Setup parameters for call to function osal_set_event
   \   0001A9   12....       LCALL   ?Subroutine13 & 0xFFFF
   1513              }
   1514            }
   1515          #endif
   1516          }
   \                     ??CrossCallReturnLabel_51:
   \   0001AC   02....       LJMP    ?Subroutine1 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function ZMacSetReq
   \   000001                ; Setup parameters for indirect call
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   AA82         MOV     R2,DPL
   \   000009   AB83         MOV     R3,DPH
   \   00000B   22           RET
   1517          
   1518          /*********************************************************************
   1519           * @fn      ZDApp_SaveNwkKey()
   1520           *
   1521           * @brief   Save off the Network key information.
   1522           *
   1523           * @param   none
   1524           *
   1525           * @return  none
   1526           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1527          void ZDApp_SaveNwkKey( void )
   \                     ZDApp_SaveNwkKey:
   1528          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1529            nwkActiveKeyItems keyItems;
   1530          
   1531            SSP_ReadNwkActiveKey( &keyItems );
   \   00000A                ; Setup parameters for call to function SSP_ReadNwkActiveKey
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   AA82         MOV     R2,DPL
   \   000012   AB83         MOV     R3,DPH
   \   000014   12....       LCALL   ??SSP_ReadNwkActiveKey?relay
   1532            keyItems.frameCounter++;
   \   000017   90....       MOV     DPTR,#__Constant_1
   \   00001A   78..         MOV     R0,#?V0 + 0
   \   00001C   12....       LCALL   ?L_MOV_X
   \   00001F   7411         MOV     A,#0x11
   \   000021   12....       LCALL   ?XSTACK_DISP0_8
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?L_ADD_TO_X
   1533          
   1534            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1535                          (void *)&keyItems );
   \   000029                ; Setup parameters for call to function osal_nv_write
   \   000029   85..82       MOV     DPL,?XSP + 0
   \   00002C   85..83       MOV     DPH,?XSP + 1
   \   00002F   8582..       MOV     ?V0 + 0,DPL
   \   000032   8583..       MOV     ?V0 + 1,DPH
   \   000035   78..         MOV     R0,#?V0 + 0
   \   000037   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003A   75..15       MOV     ?V0 + 0,#0x15
   \   00003D   75..00       MOV     ?V0 + 1,#0x0
   \   000040   78..         MOV     R0,#?V0 + 0
   \   000042   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000045   12....       LCALL   ?Subroutine29 & 0xFFFF
   \                     ??CrossCallReturnLabel_67:
   \   000048   12....       LCALL   ?DEALLOC_XSTACK8
   1536          
   1537            nwkFrameCounterChanges = 0;
   \   00004B   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00004E   E4           CLR     A
   \   00004F   F0           MOVX    @DPTR,A
   \   000050   A3           INC     DPTR
   \   000051   F0           MOVX    @DPTR,A
   1538            
   1539            // Clear copy in RAM before return. 
   1540            osal_memset( &keyItems, 0x00, sizeof(keyItems) );
   \   000052                ; Setup parameters for call to function osal_memset
   \   000052   7C15         MOV     R4,#0x15
   \   000054   FD           MOV     R5,A
   \   000055   F9           MOV     R1,A
   \   000056   85..82       MOV     DPL,?XSP + 0
   \   000059   85..83       MOV     DPH,?XSP + 1
   \   00005C   AA82         MOV     R2,DPL
   \   00005E   AB83         MOV     R3,DPH
   \   000060   12....       LCALL   ??osal_memset?relay
   1541          
   1542          }
   \   000063                REQUIRE ?Subroutine4
   \   000063                ; // Fall through to label ?Subroutine4

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7415         MOV     A,#0x15
   \   000002   12....       LCALL   ?DEALLOC_XSTACK8
   \   000005                REQUIRE ??Subroutine38_0
   \   000005                ; // Fall through to label ??Subroutine38_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine38_0:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine29:
   \   000000   7C00         MOV     R4,#0x0
   \   000002   7D00         MOV     R5,#0x0
   \   000004   7A82         MOV     R2,#-0x7e
   \   000006                REQUIRE ??Subroutine39_0
   \   000006                ; // Fall through to label ??Subroutine39_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine39_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_write?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   22           RET
   1543          
   1544          /*********************************************************************
   1545           * @fn      ZDApp_ResetNwkKey()
   1546           *
   1547           * @brief   Reset the Network key information in NV.
   1548           *
   1549           * @param   none
   1550           *
   1551           * @return  none
   1552           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1553          void ZDApp_ResetNwkKey( void )
   \                     ZDApp_ResetNwkKey:
   1554          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1555            nwkActiveKeyItems keyItems;
   1556          
   1557            osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C15         MOV     R4,#0x15
   \   00000C   12....       LCALL   ?Subroutine24 & 0xFFFF
   1558            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1559                          (void *)&keyItems );
   \                     ??CrossCallReturnLabel_31:
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   75..15       MOV     ?V0 + 0,#0x15
   \   000015   75..00       MOV     ?V0 + 1,#0x0
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   12....       LCALL   ?Subroutine29 & 0xFFFF
   \                     ??CrossCallReturnLabel_68:
   \   000020   12....       LCALL   ?DEALLOC_XSTACK8
   1560          }
   \   000023   7415         MOV     A,#0x15
   \   000025   02....       LJMP    ??Subroutine41_0 & 0xFFFF
   1561          
   1562          /*********************************************************************
   1563           * @fn      ZDApp_RestoreNwkKey()
   1564           *
   1565           * @brief
   1566           *
   1567           *   Save off the Network key information.
   1568           *
   1569           * @param   none
   1570           *
   1571           * @return  true if restored from NV, false if not
   1572           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1573          uint8 ZDApp_RestoreNwkKey( void )
   \                     ZDApp_RestoreNwkKey:
   1574          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1575            nwkActiveKeyItems keyItems;
   1576            uint8 ret = false;
   \   00000A   7E00         MOV     R6,#0x0
   1577          
   1578            if ( osal_nv_read( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), (void*)&keyItems )
   1579                == ZSUCCESS )
   \   00000C                ; Setup parameters for call to function osal_nv_read
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   8582..       MOV     ?V0 + 0,DPL
   \   000015   8583..       MOV     ?V0 + 1,DPH
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   75..15       MOV     ?V0 + 0,#0x15
   \   000020   8E..         MOV     ?V0 + 1,R6
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   7C00         MOV     R4,#0x0
   \   000029   7D00         MOV     R5,#0x0
   \   00002B   7A82         MOV     R2,#-0x7e
   \   00002D   7B00         MOV     R3,#0x0
   \   00002F   12....       LCALL   ??osal_nv_read?relay
   \   000032   7404         MOV     A,#0x4
   \   000034   12....       LCALL   ?DEALLOC_XSTACK8
   \   000037   E9           MOV     A,R1
   \   000038   704B         JNZ     ??ZDApp_RestoreNwkKey_0
   1580            {
   1581              if ( keyItems.frameCounter > 0 )
   \   00003A   7411         MOV     A,#0x11
   \   00003C   12....       LCALL   ?XSTACK_DISP0_8
   \   00003F   C082         PUSH    DPL
   \   000041   C083         PUSH    DPH
   \   000043   90....       MOV     DPTR,#__Constant_0
   \   000046   78..         MOV     R0,#?V0 + 0
   \   000048   12....       LCALL   ?L_MOV_X
   \   00004B   D083         POP     DPH
   \   00004D   D082         POP     DPL
   \   00004F   78..         MOV     R0,#?V0 + 0
   \   000051   12....       LCALL   ?L_EQ_X
   \   000054   6025         JZ      ??ZDApp_RestoreNwkKey_1
   1582              {
   1583                // Restore the key information
   1584                keyItems.frameCounter += MAX_NWK_FRAMECOUNTER_CHANGES;
   \   000056   90....       MOV     DPTR,#__Constant_3e8
   \   000059   78..         MOV     R0,#?V0 + 0
   \   00005B   12....       LCALL   ?L_MOV_X
   \   00005E   7411         MOV     A,#0x11
   \   000060   12....       LCALL   ?XSTACK_DISP0_8
   \   000063   78..         MOV     R0,#?V0 + 0
   \   000065   12....       LCALL   ?L_ADD_TO_X
   1585                nwkFrameCounter = keyItems.frameCounter;
   \   000068   7411         MOV     A,#0x11
   \   00006A   12....       LCALL   ?XSTACK_DISP0_8
   \   00006D   78..         MOV     R0,#?V0 + 0
   \   00006F   12....       LCALL   ?L_MOV_X
   \   000072   90....       MOV     DPTR,#nwkFrameCounter
   \   000075   78..         MOV     R0,#?V0 + 0
   \   000077   12....       LCALL   ?L_MOV_TO_X
   1586                ret = true;
   \   00007A   0E           INC     R6
   1587              }
   1588          
   1589              // Force a save for the first frame counter increment
   1590              nwkFrameCounterChanges = MAX_NWK_FRAMECOUNTER_CHANGES + 1;
   \                     ??ZDApp_RestoreNwkKey_1:
   \   00007B   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00007E   74E9         MOV     A,#-0x17
   \   000080   F0           MOVX    @DPTR,A
   \   000081   A3           INC     DPTR
   \   000082   7403         MOV     A,#0x3
   \   000084   F0           MOVX    @DPTR,A
   1591            }
   1592            // Clear copy in RAM before return. 
   1593            osal_memset( &keyItems, 0x00, sizeof(keyItems) );
   \                     ??ZDApp_RestoreNwkKey_0:
   \   000085                ; Setup parameters for call to function osal_memset
   \   000085   7C15         MOV     R4,#0x15
   \   000087   7D00         MOV     R5,#0x0
   \   000089   7900         MOV     R1,#0x0
   \   00008B   85..82       MOV     DPL,?XSP + 0
   \   00008E   85..83       MOV     DPH,?XSP + 1
   \   000091   AA82         MOV     R2,DPL
   \   000093   AB83         MOV     R3,DPH
   \   000095   12....       LCALL   ??osal_memset?relay
   1594            
   1595            return ( ret );
   \   000098   EE           MOV     A,R6
   \   000099   F9           MOV     R1,A
   \   00009A   02....       LJMP    ?Subroutine4 & 0xFFFF
   1596          }
   1597          
   1598          /*********************************************************************
   1599           * @fn      ZDApp_ResetTimerStart
   1600           *
   1601           * @brief   Start the reset timer.
   1602           *
   1603           * @param   delay - delay time(ms) before reset
   1604           *
   1605           * @return  none
   1606           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1607          void ZDApp_ResetTimerStart( uint16 delay )
   \                     ZDApp_ResetTimerStart:
   1608          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1609            // Start the rest timer
   1610            osal_start_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET, delay );
   \   000004                ; Setup parameters for call to function osal_start_timerEx
   \   000004   EA           MOV     A,R2
   \   000005   FC           MOV     R4,A
   \   000006   EB           MOV     A,R3
   \   000007   FD           MOV     R5,A
   \   000008   7A04         MOV     R2,#0x4
   \   00000A   12....       LCALL   ?Subroutine19 & 0xFFFF
   1611          }
   \                     ??CrossCallReturnLabel_72:
   \   00000D   02....       LJMP    ?Subroutine2 & 0xFFFF
   1612          
   1613          /*********************************************************************
   1614           * @fn      ZDApp_ResetTimerCancel
   1615           *
   1616           * @brief   Cancel the reset timer.
   1617           *
   1618           * @param   none
   1619           *
   1620           * @return  none
   1621           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1622          void ZDApp_ResetTimerCancel( void )
   \                     ZDApp_ResetTimerCancel:
   1623          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1624            // Cancel the reset timer
   1625            osal_stop_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET );
   \   000004                ; Setup parameters for call to function osal_stop_timerEx
   \   000004   7A04         MOV     R2,#0x4
   \   000006   7B00         MOV     R3,#0x0
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_stop_timerEx?relay
   1626          }
   \   000010   02....       LJMP    ?Subroutine2 & 0xFFFF
   1627          
   1628          /*********************************************************************
   1629           * @fn      ZDApp_LeaveCtrlInit
   1630           *
   1631           * @brief   Initialize the leave control logic.
   1632           *
   1633           * @param   none
   1634           *
   1635           * @return  none
   1636           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1637          void ZDApp_LeaveCtrlInit( void )
   \                     ZDApp_LeaveCtrlInit:
   1638          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1639            uint8 status;
   1640          
   1641          
   1642            // Initialize control state
   1643            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   000005   12....       LCALL   ?Subroutine11 & 0xFFFF
   1644          
   1645            status = osal_nv_item_init( ZCD_NV_LEAVE_CTRL,
   1646                                        sizeof(ZDApp_LeaveCtrl),
   1647                                        &ZDApp_LeaveCtrl );
   1648          
   1649            if ( status == ZSUCCESS )
   \                     ??CrossCallReturnLabel_6:
   \   000008   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00000B   7C01         MOV     R4,#0x1
   \   00000D   7D00         MOV     R5,#0x0
   \   00000F   7A85         MOV     R2,#-0x7b
   \   000011   7B00         MOV     R3,#0x0
   \   000013   12....       LCALL   ??osal_nv_item_init?relay
   \   000016   7402         MOV     A,#0x2
   \   000018   12....       LCALL   ?DEALLOC_XSTACK8
   \   00001B   E9           MOV     A,R1
   \   00001C   7020         JNZ     ??ZDApp_LeaveCtrlInit_0
   1650            {
   1651              // Read saved control
   1652              osal_nv_read( ZCD_NV_LEAVE_CTRL,
   1653                            0,
   1654                            sizeof( uint8 ),
   1655                            &ZDApp_LeaveCtrl);
   \   00001E                ; Setup parameters for call to function osal_nv_read
   \   00001E   78..         MOV     R0,#?V0 + 0
   \   000020   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000023   75..01       MOV     ?V0 + 0,#0x1
   \   000026   75..00       MOV     ?V0 + 1,#0x0
   \   000029   78..         MOV     R0,#?V0 + 0
   \   00002B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002E   7C00         MOV     R4,#0x0
   \   000030   7D00         MOV     R5,#0x0
   \   000032   7A85         MOV     R2,#-0x7b
   \   000034   7B00         MOV     R3,#0x0
   \   000036   12....       LCALL   ??osal_nv_read?relay
   \   000039   7404         MOV     A,#0x4
   \   00003B   12....       LCALL   ?DEALLOC_XSTACK8
   1656            }
   1657          }
   \                     ??ZDApp_LeaveCtrlInit_0:
   \   00003E   80..         SJMP    ??Subroutine42_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   E4           CLR     A
   \   000001   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000004   F0           MOVX    @DPTR,A
   \   000005                ; Setup parameters for call to function osal_nv_item_init
   \   000005                ; Setup parameters for call to function osal_nv_write
   \   000005   75....       MOV     ?V0 + 0,#(ZDApp_LeaveCtrl & 0xff)
   \   000008   75....       MOV     ?V0 + 1,#((ZDApp_LeaveCtrl >> 8) & 0xff)
   \   00000B   78..         MOV     R0,#?V0 + 0
   \   00000D   22           RET
   1658          
   1659          /*********************************************************************
   1660           * @fn      ZDApp_LeaveCtrlSet
   1661           *
   1662           * @brief   Set the leave control logic.
   1663           *
   1664           * @param   ra - reassociate flag
   1665           *
   1666           * @return  none
   1667           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1668          void ZDApp_LeaveCtrlSet( uint8 ra )
   \                     ZDApp_LeaveCtrlSet:
   1669          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   1670            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_SET;
   \   000007   7401         MOV     A,#0x1
   \   000009   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000C   F0           MOVX    @DPTR,A
   1671          
   1672            if ( ra == TRUE )
   \   00000D   6E           XRL     A,R6
   \   00000E   7003         JNZ     ??ZDApp_LeaveCtrlSet_0
   1673            {
   1674              ZDApp_LeaveCtrl |= ZDAPP_LEAVE_CTRL_RA;
   \   000010   7403         MOV     A,#0x3
   \   000012   F0           MOVX    @DPTR,A
   1675            }
   1676          
   1677            // Write the leave control
   1678            osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1679                           0,
   1680                           sizeof( uint8 ),
   1681                           &ZDApp_LeaveCtrl);
   \                     ??ZDApp_LeaveCtrlSet_0:
   \   000013                ; Setup parameters for call to function osal_nv_write
   \   000013   75....       MOV     ?V0 + 0,#(ZDApp_LeaveCtrl & 0xff)
   \   000016   75....       MOV     ?V0 + 1,#((ZDApp_LeaveCtrl >> 8) & 0xff)
   \   000019   78..         MOV     R0,#?V0 + 0
   \   00001B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001E   75..01       MOV     ?V0 + 0,#0x1
   \   000021   75..00       MOV     ?V0 + 1,#0x0
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000029   7C00         MOV     R4,#0x0
   \   00002B   7D00         MOV     R5,#0x0
   \   00002D   7A85         MOV     R2,#-0x7b
   \   00002F   12....       LCALL   ??Subroutine39_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_69:
   \   000032   80..         SJMP    ??Subroutine41_0
   1682          }
   1683          
   1684          /*********************************************************************
   1685           * @fn      ZDApp_LeaveCtrlBypass
   1686           *
   1687           * @brief   Check if NV restore should be skipped during a leave reset.
   1688           *
   1689           * @param   none
   1690           *
   1691           * @return  uint8 - (TRUE bypass:FALSE do not bypass)
   1692           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1693          uint8 ZDApp_LeaveCtrlBypass( void )
   \                     ZDApp_LeaveCtrlBypass:
   1694          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1695            uint8 bypass;
   1696          
   1697            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   1698            {
   1699              bypass = TRUE;
   1700            }
   1701            else
   1702            {
   1703              bypass = FALSE;
   1704            }
   1705          
   1706            return bypass;
   \   000004   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000007   E0           MOVX    A,@DPTR
   \   000008   A2E0         MOV     C,0xE0 /* A   */.0
   \   00000A   E4           CLR     A
   \   00000B   92E0         MOV     0xE0 /* A   */.0,C
   \   00000D   F9           MOV     R1,A
   \   00000E   02....       LJMP    ?Subroutine2 & 0xFFFF
   1707          }
   1708          
   1709          /*********************************************************************
   1710           * @fn      ZDApp_LeaveCtrlStartup
   1711           *
   1712           * @brief   Check for startup conditions during a leave reset.
   1713           *
   1714           * @param   state      - devState_t determined by leave control logic
   1715           * @param   startDelay - startup delay
   1716           *
   1717           * @return  none
   1718           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1719          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay )
   \                     ZDApp_LeaveCtrlStartup:
   1720          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1721            *startDelay = 0;
   \   000005   8C82         MOV     DPL,R4
   \   000007   8D83         MOV     DPH,R5
   \   000009   E4           CLR     A
   \   00000A   F0           MOVX    @DPTR,A
   \   00000B   A3           INC     DPTR
   \   00000C   F0           MOVX    @DPTR,A
   1722          
   1723            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   \   00000D   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000010   E0           MOVX    A,@DPTR
   \   000011   A2E0         MOV     C,0xE0 /* A   */.0
   \   000013   5033         JNC     ??ZDApp_LeaveCtrlStartup_0
   1724            {
   1725              if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_RA )
   \   000015   A2E1         MOV     C,0xE0 /* A   */.1
   \   000017   500C         JNC     ??ZDApp_LeaveCtrlStartup_1
   1726              {
   1727                *startDelay = 5000;
   \   000019   8C82         MOV     DPL,R4
   \   00001B   8D83         MOV     DPH,R5
   \   00001D   7488         MOV     A,#-0x78
   \   00001F   F0           MOVX    @DPTR,A
   \   000020   A3           INC     DPTR
   \   000021   7413         MOV     A,#0x13
   \   000023   8005         SJMP    ??ZDApp_LeaveCtrlStartup_2
   1728              }
   1729              else
   1730              {
   1731                *state = DEV_HOLD;
   \                     ??ZDApp_LeaveCtrlStartup_1:
   \   000025   E4           CLR     A
   \   000026   8A82         MOV     DPL,R2
   \   000028   8B83         MOV     DPH,R3
   \                     ??ZDApp_LeaveCtrlStartup_2:
   \   00002A   F0           MOVX    @DPTR,A
   1732              }
   1733          
   1734              // Set leave control to initialized state
   1735              ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   00002B   12....       LCALL   ?Subroutine11 & 0xFFFF
   1736          
   1737              // Write initialized control
   1738              osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1739                            0,
   1740                            sizeof( uint8 ),
   1741                            &ZDApp_LeaveCtrl);
   1742            }
   \                     ??CrossCallReturnLabel_7:
   \   00002E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000031   75..01       MOV     ?V0 + 0,#0x1
   \   000034   75..00       MOV     ?V0 + 1,#0x0
   \   000037   78..         MOV     R0,#?V0 + 0
   \   000039   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003C   7C00         MOV     R4,#0x0
   \   00003E   7D00         MOV     R5,#0x0
   \   000040   7A85         MOV     R2,#-0x7b
   \   000042   12....       LCALL   ??Subroutine39_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_70:
   \   000045   12....       LCALL   ?DEALLOC_XSTACK8
   1743          }
   \                     ??ZDApp_LeaveCtrlStartup_0:
   \   000048   80..         SJMP    ??Subroutine42_0
   1744          
   1745          /*********************************************************************
   1746           * @fn      ZDApp_LeaveReset
   1747           *
   1748           * @brief   Setup a device reset due to a leave indication/confirm.
   1749           *
   1750           * @param   ra - reassociate flag
   1751           *
   1752           * @return  none
   1753           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1754          void ZDApp_LeaveReset( uint8 ra )
   \                     ZDApp_LeaveReset:
   1755          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   1756            ZDApp_LeaveCtrlSet( ra );
   \   000005                ; Setup parameters for call to function ZDApp_LeaveCtrlSet
   \   000005   12....       LCALL   ??ZDApp_LeaveCtrlSet?relay
   1757          
   1758            ZDApp_ResetTimerStart( 5000 );
   \   000008                ; Setup parameters for call to function ZDApp_ResetTimerStart
   \   000008   7A88         MOV     R2,#-0x78
   \   00000A   7B13         MOV     R3,#0x13
   \   00000C   12....       LCALL   ??ZDApp_ResetTimerStart?relay
   1759          }
   \   00000F   80..         SJMP    ??Subroutine43_0
   1760          
   1761          /*********************************************************************
   1762           * @fn      ZDApp_LeaveUpdate
   1763           *
   1764           * @brief   Update local device data related to leaving device.
   1765           *
   1766           * @param   nwkAddr        - NWK address of leaving device
   1767           * @param   extAddr        - EXT address of leaving device
   1768           * @param   removeChildren - remove children of leaving device
   1769           *
   1770           * @return  none
   1771           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1772          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
   \                     ZDApp_LeaveUpdate:
   1773                                  uint8 removeChildren )
   1774          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EC           MOV     A,R4
   \   000006   FA           MOV     R2,A
   \   000007   ED           MOV     A,R5
   \   000008   FB           MOV     R3,A
   1775            /*
   1776            AddrMgrEntry_t entry;
   1777            */
   1778            (void)nwkAddr;  // Intentionally unreferenced parameter
   1779          
   1780            // Remove if child
   1781            if ( ZSTACK_ROUTER_BUILD )
   1782            {
   1783              NLME_RemoveChild( extAddr, removeChildren );
   \   000009                ; Setup parameters for call to function NLME_RemoveChild
   \   000009   12....       LCALL   ??NLME_RemoveChild?relay
   1784            }
   1785          
   1786            /*
   1787            // Set NWK address to invalid
   1788            entry.user    = ADDRMGR_USER_DEFAULT;
   1789            entry.nwkAddr = INVALID_NODE_ADDR;
   1790            AddrMgrExtAddrSet( entry.extAddr, extAddr );
   1791            AddrMgrEntryUpdate( &entry );
   1792          
   1793            // Check
   1794            if ( removeChildren == TRUE )
   1795            {
   1796              // Set index to INVALID_NODE_ADDR to start search
   1797              entry.index = INVALID_NODE_ADDR;
   1798          
   1799              // Get first entry
   1800              AddrMgrEntryGetNext( &entry );
   1801          
   1802              // Remove all descendents
   1803              while ( entry.index != INVALID_NODE_ADDR )
   1804              {
   1805                // Check NWK address allocation algorithm
   1806                if ( RTG_ANCESTOR( entry.nwkAddr, thisAddr ) != 0 )
   1807                {
   1808                  // Set NWK address to invalid
   1809                  entry.nwkAddr = INVALID_NODE_ADDR;
   1810                  AddrMgrEntryUpdate( &entry );
   1811                }
   1812          
   1813                // Get next entry
   1814                AddrMgrEntryGetNext( &entry );
   1815              }
   1816            }
   1817            */
   1818          }
   \   00000C   80..         SJMP    ??Subroutine43_0
   1819          
   1820          /*********************************************************************
   1821           * @fn      ZDApp_NetworkDiscoveryReq
   1822           *
   1823           * @brief   Request a network discovery.
   1824           *
   1825           * @param  scanChannels - 
   1826           * @param  scanDuration - 
   1827           *
   1828           * @return  ZStatus_t
   1829           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1830          ZStatus_t ZDApp_NetworkDiscoveryReq( uint32 scanChannels, uint8 scanDuration)
   \                     ZDApp_NetworkDiscoveryReq:
   1831          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   1832            // Setup optional filters - tbd
   1833            
   1834            // Request NLME network discovery
   1835            return NLME_NetworkDiscoveryRequest(scanChannels, scanDuration);
   \   000005                ; Setup parameters for call to function NLME_NetworkDiscoveryRequest
   \   000005   12....       LCALL   ??NLME_NetworkDiscoveryRequest?relay
   \   000008   02....       LJMP    ??Subroutine38_0 & 0xFFFF
   1836          }
   1837          
   1838          
   1839          
   1840          /*********************************************************************
   1841           * @fn      ZDApp_JoinReq
   1842           *
   1843           * @brief   Request the device to join a parent in a network.
   1844           *
   1845           * @param   channel - 
   1846           * @param   panID - 
   1847           *
   1848           * @return  ZStatus_t
   1849           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1850          ZStatus_t ZDApp_JoinReq( uint8 channel, uint16 panID, uint8 *extendedPanID, 
   \                     ZDApp_JoinReq:
   1851                                   uint16 chosenParent, uint8 parentDepth, uint8 stackProfile )
   1852          {  
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 4,R1
   \   000007   8A..         MOV     ?V0 + 0,R2
   \   000009   8B..         MOV     ?V0 + 1,R3
   \   00000B   EC           MOV     A,R4
   \   00000C   FE           MOV     R6,A
   \   00000D   ED           MOV     A,R5
   \   00000E   FF           MOV     R7,A
   \   00000F   740E         MOV     A,#0xe
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 2,A
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 3,A
   \   00001B   7410         MOV     A,#0x10
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F5..         MOV     ?V0 + 5,A
   \   000023   7411         MOV     A,#0x11
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F9           MOV     R1,A
   1853            // Sync up the node with the stack profile (In the case where a pro device 
   1854            // joins a non-pro network, or verse versa)
   1855            ZDApp_NodeProfileSync( stackProfile);
   \   00002A                ; Setup parameters for call to function ZDApp_NodeProfileSync
   \   00002A   12....       LCALL   ??ZDApp_NodeProfileSync?relay
   1856                          
   1857            // Request NLME Join Request
   1858            return NLME_JoinRequest(extendedPanID, panID,channel, 
   1859                                    ZDO_Config_Node_Descriptor.CapabilityFlags, 
   1860                                    chosenParent, parentDepth);
   \   00002D                ; Setup parameters for call to function NLME_JoinRequest
   \   00002D   78..         MOV     R0,#?V0 + 5
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000032   78..         MOV     R0,#?V0 + 2
   \   000034   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000037   90....       MOV     DPTR,#(ZDO_Config_Node_Descriptor + 2)
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   F5..         MOV     ?V0 + 2,A
   \   00003D   78..         MOV     R0,#?V0 + 2
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000042   A9..         MOV     R1,?V0 + 4
   \   000044   AC..         MOV     R4,?V0 + 0
   \   000046   AD..         MOV     R5,?V0 + 1
   \   000048   EE           MOV     A,R6
   \   000049   FA           MOV     R2,A
   \   00004A   EF           MOV     A,R7
   \   00004B   FB           MOV     R3,A
   \   00004C   12....       LCALL   ??NLME_JoinRequest?relay
   \   00004F   7404         MOV     A,#0x4
   \   000051   12....       LCALL   ?DEALLOC_XSTACK8
   \   000054                REQUIRE ?Subroutine5
   \   000054                ; // Fall through to label ?Subroutine5
   1861          
   1862          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   7F06         MOV     R7,#0x6
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
   1863          /*********************************************************************
   1864           * CALLBACK FUNCTIONS
   1865           */
   1866          
   1867          
   1868          /*********************************************************************
   1869           * @fn      ZDApp_SendEventMsg()
   1870           *
   1871           * @brief
   1872           *
   1873           *   Sends a Network Join message
   1874           *
   1875           * @param  cmd - command ID
   1876           * @param  len - length (in bytes) of the buf field
   1877           * @param  buf - buffer for the rest of the message.
   1878           *
   1879           * @return  none
   1880           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1881          void ZDApp_SendEventMsg( uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendEventMsg:
   1882          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   1883            ZDApp_SendMsg( ZDAppTaskID, cmd, len, buf );
   \   000008                ; Setup parameters for call to function ZDApp_SendMsg
   \   000008   FB           MOV     R3,A
   \   000009   EE           MOV     A,R6
   \   00000A   FA           MOV     R2,A
   \   00000B   12....       LCALL   ?Subroutine20 & 0xFFFF
   1884          }
   \                     ??CrossCallReturnLabel_24:
   \   00000E   80..         SJMP    ??Subroutine43_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDApp_SendMsg?relay
   \   000008   22           RET
   1885          
   1886          /*********************************************************************
   1887           * @fn      ZDApp_SendMsg()
   1888           *
   1889           * @brief   Sends a OSAL message
   1890           *
   1891           * @param  taskID - Where to send the message
   1892           * @param  cmd - command ID
   1893           * @param  len - length (in bytes) of the buf field
   1894           * @param  buf - buffer for the rest of the message.
   1895           *
   1896           * @return  none
   1897           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1898          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendMsg:
   1899          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 3,R1
   \   000007   8A..         MOV     ?V0 + 5,R2
   \   000009   8B..         MOV     ?V0 + 4,R3
   \   00000B   8C..         MOV     ?V0 + 0,R4
   \   00000D   8D..         MOV     ?V0 + 1,R5
   1900            osal_event_hdr_t *msgPtr;
   1901          
   1902            // Send the address to the task
   1903            msgPtr = (osal_event_hdr_t *)osal_msg_allocate( len );
   \   00000F                ; Setup parameters for call to function osal_msg_allocate
   \   00000F   EB           MOV     A,R3
   \   000010   FA           MOV     R2,A
   \   000011   7B00         MOV     R3,#0x0
   \   000013   12....       LCALL   ??osal_msg_allocate?relay
   \   000016   8A..         MOV     ?V0 + 6,R2
   \   000018   8B..         MOV     ?V0 + 7,R3
   \   00001A   AE..         MOV     R6,?V0 + 6
   \   00001C   AF..         MOV     R7,?V0 + 7
   1904            if ( msgPtr )
   \   00001E   EE           MOV     A,R6
   \   00001F   7001         JNZ     ??ZDApp_SendMsg_0
   \   000021   EF           MOV     A,R7
   \                     ??ZDApp_SendMsg_0:
   \   000022   6030         JZ      ??ZDApp_SendMsg_1
   1905            {
   1906              if ( (len > 0) && (buf != NULL) )
   \   000024   E5..         MOV     A,?V0 + 4
   \   000026   601C         JZ      ??ZDApp_SendMsg_2
   \   000028   E5..         MOV     A,?V0 + 0
   \   00002A   7002         JNZ     ??ZDApp_SendMsg_3
   \   00002C   E5..         MOV     A,?V0 + 1
   \                     ??ZDApp_SendMsg_3:
   \   00002E   6014         JZ      ??ZDApp_SendMsg_2
   1907                osal_memcpy( msgPtr, buf, len );
   \   000030                ; Setup parameters for call to function osal_memcpy
   \   000030   75..00       MOV     ?V0 + 2,#0x0
   \   000033   78..         MOV     R0,#?V0 + 0
   \   000035   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000038   AC..         MOV     R4,?V0 + 4
   \   00003A   7D00         MOV     R5,#0x0
   \   00003C   12....       LCALL   ??osal_memcpy?relay
   \   00003F   7403         MOV     A,#0x3
   \   000041   12....       LCALL   ?DEALLOC_XSTACK8
   1908          
   1909              msgPtr->event = cmd;
   \                     ??ZDApp_SendMsg_2:
   \   000044   8E82         MOV     DPL,R6
   \   000046   8F83         MOV     DPH,R7
   \   000048   E5..         MOV     A,?V0 + 5
   \   00004A   F0           MOVX    @DPTR,A
   1910              osal_msg_send( taskID, (uint8 *)msgPtr );
   \   00004B                ; Setup parameters for call to function osal_msg_send
   \   00004B   EE           MOV     A,R6
   \   00004C   FA           MOV     R2,A
   \   00004D   EF           MOV     A,R7
   \   00004E   FB           MOV     R3,A
   \   00004F   A9..         MOV     R1,?V0 + 3
   \   000051   12....       LCALL   ??osal_msg_send?relay
   1911            }
   1912          }
   \                     ??ZDApp_SendMsg_1:
   \   000054   7F08         MOV     R7,#0x8
   \   000056   02....       LJMP    ?BANKED_LEAVE_XDATA
   1913          
   1914          /*********************************************************************
   1915           * Call Back Functions from NWK  - API
   1916           */
   1917          
   1918          /*********************************************************************
   1919           * @fn          ZDO_NetworkDiscoveryConfirmCB
   1920           *
   1921           * @brief       This function returns a choice of PAN to join.
   1922           *
   1923           * @param       status - return status of the nwk discovery confirm
   1924           *
   1925           * @return      ZStatus_t
   1926           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1927          ZStatus_t ZDO_NetworkDiscoveryConfirmCB(uint8 status)
   \                     ZDO_NetworkDiscoveryConfirmCB:
   1928          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 3
   \   000004   74FD         MOV     A,#-0x3
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   \   000009   E9           MOV     A,R1
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   F0           MOVX    @DPTR,A
   1929            osal_event_hdr_t msg;
   1930          
   1931            // If Scan is initiated by ZDO_MGMT_NWK_DISC_REQ
   1932            // Send ZDO_MGMT_NWK_DISC_RSP back
   1933          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
   1934            if ( zdappMgmtNwkDiscReqInProgress )
   1935            {
   1936              zdappMgmtNwkDiscReqInProgress = false;
   1937              ZDO_FinishProcessingMgmtNwkDiscReq();
   1938            }
   1939            else
   1940          #endif
   1941            {
   1942              // Pass the confirm to another task if it registers the callback
   1943              // Otherwise, pass the confirm to ZDApp.
   1944              if (zdoCBFunc[ZDO_NWK_DISCOVERY_CNF_CBID] != NULL )
   \   000011   90....       MOV     DPTR,#(zdoCBFunc + 4)
   \   000014   E0           MOVX    A,@DPTR
   \   000015   7002         JNZ     ??ZDO_NetworkDiscoveryConfirmCB_0
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \                     ??ZDO_NetworkDiscoveryConfirmCB_0:
   \   000019   6015         JZ      ??ZDO_NetworkDiscoveryConfirmCB_1
   1945              {      
   1946                zdoCBFunc[ZDO_NWK_DISCOVERY_CNF_CBID]( (void*)&status );
   \   00001B                ; Setup parameters for indirect call
   \   00001B   85..82       MOV     DPL,?XSP + 0
   \   00001E   85..83       MOV     DPH,?XSP + 1
   \   000021   AA82         MOV     R2,DPL
   \   000023   AB83         MOV     R3,DPH
   \   000025   90....       MOV     DPTR,#(zdoCBFunc + 4)
   \   000028   12....       LCALL   ?Subroutine12 & 0xFFFF
   1947              }
   \                     ??CrossCallReturnLabel_10:
   \   00002B   12....       LCALL   ?CALL_IND
   \   00002E   8017         SJMP    ??CrossCallReturnLabel_25
   1948              else
   1949              {
   1950                // Otherwise, send scan confirm to ZDApp task to proceed
   1951                msg.status = ZDO_SUCCESS;
   \                     ??ZDO_NetworkDiscoveryConfirmCB_1:
   \   000030   7402         MOV     A,#0x2
   \   000032   12....       LCALL   ?XSTACK_DISP0_8
   \   000035   E4           CLR     A
   \   000036   F0           MOVX    @DPTR,A
   1952                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_DISC_CNF, sizeof(osal_event_hdr_t), (uint8 *)&msg );
   \   000037                ; Setup parameters for call to function ZDApp_SendMsg
   \   000037   7401         MOV     A,#0x1
   \   000039   12....       LCALL   ?XSTACK_DISP0_8
   \   00003C   AC82         MOV     R4,DPL
   \   00003E   AD83         MOV     R5,DPH
   \   000040   7B02         MOV     R3,#0x2
   \   000042   7A01         MOV     R2,#0x1
   \   000044   12....       LCALL   ?Subroutine20 & 0xFFFF
   1953              }
   1954            }
   1955            return (ZSuccess);
   \                     ??CrossCallReturnLabel_25:
   \   000047   7900         MOV     R1,#0x0
   \   000049   7403         MOV     A,#0x3
   \   00004B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004E                REQUIRE ?Subroutine2
   \   00004E                ; // Fall through to label ?Subroutine2
   1956          }  // ZDO_NetworkDiscoveryConfirmCB
   1957          
   1958          /*********************************************************************
   1959           * @fn          ZDApp_NwkDescListProcessing
   1960           *
   1961           * @brief       This function process the network discovery result and select 
   1962           *              a parent device to join itself.
   1963           *
   1964           * @param       none
   1965           *
   1966           * @return      ZStatus_t
   1967           */
   1968          #define STACK_PROFILE_MAX 2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1969          networkDesc_t* ZDApp_NwkDescListProcessing(void)
   \                     ZDApp_NwkDescListProcessing:
   1970          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   1971            networkDesc_t *pNwkDesc;
   1972            uint8 i, ResultCount = 0;
   \   000005   75..00       MOV     ?V0 + 0,#0x0
   1973            uint8 stackProfile;
   1974            uint8 stackProfilePro;
   1975            uint8 selected;
   1976          
   1977            // Count the number of nwk descriptors in the list
   1978            pNwkDesc = nwk_getNwkDescList();
   \   000008                ; Setup parameters for call to function nwk_getNwkDescList
   \   000008   12....       LCALL   ??nwk_getNwkDescList?relay
   \   00000B   8A..         MOV     ?V0 + 2,R2
   \   00000D   8B..         MOV     ?V0 + 3,R3
   \   00000F   AE..         MOV     R6,?V0 + 2
   \   000011   AF..         MOV     R7,?V0 + 3
   \   000013   8005         SJMP    ??CrossCallReturnLabel_76
   1979            while (pNwkDesc)
   1980            {
   1981              ResultCount++;
   \                     ??ZDApp_NwkDescListProcessing_0:
   \   000015   05..         INC     ?V0 + 0
   1982              pNwkDesc = pNwkDesc->nextDesc;
   \   000017   12....       LCALL   ?Subroutine23 & 0xFFFF
   1983            }
   \                     ??CrossCallReturnLabel_76:
   \   00001A   EE           MOV     A,R6
   \   00001B   7001         JNZ     ??ZDApp_NwkDescListProcessing_1
   \   00001D   EF           MOV     A,R7
   \                     ??ZDApp_NwkDescListProcessing_1:
   \   00001E   70F5         JNZ     ??ZDApp_NwkDescListProcessing_0
   1984          
   1985            // process discovery results
   1986            stackProfilePro = FALSE;
   \   000020   75..00       MOV     ?V0 + 3,#0x0
   1987            selected = FALSE; 
   1988            
   1989          
   1990            for ( stackProfile = 0; stackProfile < STACK_PROFILE_MAX; stackProfile++ )
   \   000023   75..00       MOV     ?V0 + 1,#0x0
   1991            {
   1992              pNwkDesc = nwk_getNwkDescList();
   \                     ??ZDApp_NwkDescListProcessing_2:
   \   000026                ; Setup parameters for call to function nwk_getNwkDescList
   \   000026   12....       LCALL   ??nwk_getNwkDescList?relay
   \   000029   8A..         MOV     ?V0 + 4,R2
   \   00002B   8B..         MOV     ?V0 + 5,R3
   \   00002D   AE..         MOV     R6,?V0 + 4
   \   00002F   AF..         MOV     R7,?V0 + 5
   1993              for ( i = 0; i < ResultCount; i++, pNwkDesc = pNwkDesc->nextDesc )
   \   000031   75..00       MOV     ?V0 + 2,#0x0
   \   000034   8023         SJMP    ??CrossCallReturnLabel_77
   1994              {
   1995                if ( zgConfigPANID != 0xFFFF )
   1996                {
   1997                  // PAN Id is preconfigured. check if it matches
   1998                  if ( pNwkDesc->panId != zgConfigPANID )
   1999                    continue;
   2000                }
   2001                
   2002                if ( nwk_ExtPANIDValid( ZDO_UseExtendedPANID) == true ) 
   2003                {
   2004                  // If the extended Pan ID is commissioned to a non zero value
   2005                  // Only join the Pan that has match EPID
   2006                  if ( osal_ExtAddrEqual( ZDO_UseExtendedPANID, pNwkDesc->extendedPANID) == false )
   2007                    continue;
   2008                  
   2009                }
   2010                
   2011                // check that network is allowing joining
   2012                if ( ZSTACK_ROUTER_BUILD )
   2013                {
   2014                  if ( stackProfilePro == FALSE )
   2015                  {
   2016                    if ( !pNwkDesc->routerCapacity )
   2017                    {
   2018                      continue;
   2019                    }
   2020                  }
   2021                  else
   2022                  {
   2023                    if ( !pNwkDesc->deviceCapacity )
   2024                    {
   2025                      continue;
   2026                    }
   2027                  }
   2028                }
   2029                else if ( ZSTACK_END_DEVICE_BUILD )
   2030                {
   2031                  if ( !pNwkDesc->deviceCapacity )
   2032                  {
   2033                    continue;
   2034                  }
   2035                }
   2036                
   2037                // check version of zigbee protocol
   2038                if ( pNwkDesc->version != _NIB.nwkProtocolVersion )
   2039                  continue;
   2040                
   2041                // check version of stack profile
   2042                if ( pNwkDesc->stackProfile != zgStackProfile  )
   2043                {
   2044                  if ( ((zgStackProfile == HOME_CONTROLS) && (pNwkDesc->stackProfile == ZIGBEEPRO_PROFILE)) 
   2045                      || ((zgStackProfile == ZIGBEEPRO_PROFILE) && (pNwkDesc->stackProfile == HOME_CONTROLS))  )
   \                     ??ZDApp_NwkDescListProcessing_3:
   \   000036   E0           MOVX    A,@DPTR
   \   000037   6402         XRL     A,#0x2
   \   000039   7012         JNZ     ??ZDApp_NwkDescListProcessing_4
   \   00003B   8E82         MOV     DPL,R6
   \   00003D   8F83         MOV     DPH,R7
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   E0           MOVX    A,@DPTR
   \   000046   6401         XRL     A,#0x1
   \   000048   7003         JNZ     ??ZDApp_NwkDescListProcessing_4
   2046                  {
   2047                    stackProfilePro = TRUE;
   \                     ??ZDApp_NwkDescListProcessing_5:
   \   00004A   75..01       MOV     ?V0 + 3,#0x1
   2048                  }
   2049                  
   2050                  if ( stackProfile == 0 )
   \                     ??ZDApp_NwkDescListProcessing_4:
   \   00004D   E5..         MOV     A,?V0 + 1
   \   00004F   6003         JZ      $+5
   \   000051   02....       LJMP    ??ZDApp_NwkDescListProcessing_6 & 0xFFFF
   \                     ??ZDApp_NwkDescListProcessing_7:
   \   000054   05..         INC     ?V0 + 2
   \   000056   12....       LCALL   ?Subroutine23 & 0xFFFF
   \                     ??CrossCallReturnLabel_77:
   \   000059   E5..         MOV     A,?V0 + 2
   \   00005B   C3           CLR     C
   \   00005C   95..         SUBB    A,?V0 + 0
   \   00005E   4003         JC      $+5
   \   000060   02....       LJMP    ??ZDApp_NwkDescListProcessing_8 & 0xFFFF
   \   000063   90....       MOV     DPTR,#zgConfigPANID
   \   000066   E0           MOVX    A,@DPTR
   \   000067   64FF         XRL     A,#0xff
   \   000069   7004         JNZ     ??ZDApp_NwkDescListProcessing_9
   \   00006B   A3           INC     DPTR
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   64FF         XRL     A,#0xff
   \                     ??ZDApp_NwkDescListProcessing_9:
   \   00006F   600F         JZ      ??ZDApp_NwkDescListProcessing_10
   \   000071   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_83:
   \   000074   90....       MOV     DPTR,#zgConfigPANID
   \   000077   E0           MOVX    A,@DPTR
   \   000078   68           XRL     A,R0
   \   000079   7003         JNZ     ??ZDApp_NwkDescListProcessing_11
   \   00007B   A3           INC     DPTR
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   69           XRL     A,R1
   \                     ??ZDApp_NwkDescListProcessing_11:
   \   00007E   70D4         JNZ     ??ZDApp_NwkDescListProcessing_7
   \                     ??ZDApp_NwkDescListProcessing_10:
   \   000080                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   000080   7A..         MOV     R2,#(ZDO_UseExtendedPANID & 0xff)
   \   000082   7B..         MOV     R3,#((ZDO_UseExtendedPANID >> 8) & 0xff)
   \   000084   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   000087   E9           MOV     A,R1
   \   000088   6401         XRL     A,#0x1
   \   00008A   7012         JNZ     ??ZDApp_NwkDescListProcessing_12
   \   00008C                ; Setup parameters for call to function sAddrExtCmp
   \   00008C   EE           MOV     A,R6
   \   00008D   240B         ADD     A,#0xb
   \   00008F   FC           MOV     R4,A
   \   000090   EF           MOV     A,R7
   \   000091   3400         ADDC    A,#0x0
   \   000093   FD           MOV     R5,A
   \   000094   7A..         MOV     R2,#(ZDO_UseExtendedPANID & 0xff)
   \   000096   7B..         MOV     R3,#((ZDO_UseExtendedPANID >> 8) & 0xff)
   \   000098   12....       LCALL   ??sAddrExtCmp?relay
   \   00009B   E9           MOV     A,R1
   \   00009C   60B6         JZ      ??ZDApp_NwkDescListProcessing_7
   \                     ??ZDApp_NwkDescListProcessing_12:
   \   00009E   E5..         MOV     A,?V0 + 3
   \   0000A0   8E82         MOV     DPL,R6
   \   0000A2   8F83         MOV     DPH,R7
   \   0000A4   A3           INC     DPTR
   \   0000A5   A3           INC     DPTR
   \   0000A6   A3           INC     DPTR
   \   0000A7   7005         JNZ     ??ZDApp_NwkDescListProcessing_13
   \   0000A9   E0           MOVX    A,@DPTR
   \   0000AA   7006         JNZ     ??ZDApp_NwkDescListProcessing_14
   \   0000AC   80A6         SJMP    ??ZDApp_NwkDescListProcessing_7
   \                     ??ZDApp_NwkDescListProcessing_13:
   \   0000AE   A3           INC     DPTR
   \   0000AF   E0           MOVX    A,@DPTR
   \   0000B0   60A2         JZ      ??ZDApp_NwkDescListProcessing_7
   \                     ??ZDApp_NwkDescListProcessing_14:
   \   0000B2   8E82         MOV     DPL,R6
   \   0000B4   8F83         MOV     DPH,R7
   \   0000B6   A3           INC     DPTR
   \   0000B7   A3           INC     DPTR
   \   0000B8   A3           INC     DPTR
   \   0000B9   A3           INC     DPTR
   \   0000BA   A3           INC     DPTR
   \   0000BB   E0           MOVX    A,@DPTR
   \   0000BC   FA           MOV     R2,A
   \   0000BD   90....       MOV     DPTR,#(_NIB + 17)
   \   0000C0   E0           MOVX    A,@DPTR
   \   0000C1   6A           XRL     A,R2
   \   0000C2   7090         JNZ     ??ZDApp_NwkDescListProcessing_7
   \   0000C4   8E82         MOV     DPL,R6
   \   0000C6   8F83         MOV     DPH,R7
   \   0000C8   A3           INC     DPTR
   \   0000C9   A3           INC     DPTR
   \   0000CA   A3           INC     DPTR
   \   0000CB   A3           INC     DPTR
   \   0000CC   A3           INC     DPTR
   \   0000CD   A3           INC     DPTR
   \   0000CE   E0           MOVX    A,@DPTR
   \   0000CF   FA           MOV     R2,A
   \   0000D0   90....       MOV     DPTR,#zgStackProfile
   \   0000D3   E0           MOVX    A,@DPTR
   \   0000D4   6A           XRL     A,R2
   \   0000D5   6039         JZ      ??ZDApp_NwkDescListProcessing_6
   \   0000D7   E0           MOVX    A,@DPTR
   \   0000D8   6401         XRL     A,#0x1
   \   0000DA   6003         JZ      $+5
   \   0000DC   02....       LJMP    ??ZDApp_NwkDescListProcessing_3 & 0xFFFF
   \   0000DF   8E82         MOV     DPL,R6
   \   0000E1   8F83         MOV     DPH,R7
   \   0000E3   A3           INC     DPTR
   \   0000E4   A3           INC     DPTR
   \   0000E5   A3           INC     DPTR
   \   0000E6   A3           INC     DPTR
   \   0000E7   A3           INC     DPTR
   \   0000E8   A3           INC     DPTR
   \   0000E9   E0           MOVX    A,@DPTR
   \   0000EA   6402         XRL     A,#0x2
   \   0000EC   6003         JZ      $+5
   \   0000EE   02....       LJMP    ??ZDApp_NwkDescListProcessing_4 & 0xFFFF
   \   0000F1   02....       LJMP    ??ZDApp_NwkDescListProcessing_5 & 0xFFFF
   2051                  {
   2052                    continue;
   2053                  }
   2054                }
   2055                
   2056                break;
   2057              } 
   2058              
   2059              if (i < ResultCount)
   2060              {
   2061               selected = TRUE;
   2062                break;
   2063              }
   2064             
   2065              // break if selected or stack profile pro wasn't found
   2066              if ( (selected == TRUE) || (stackProfilePro == FALSE) )
   \                     ??ZDApp_NwkDescListProcessing_8:
   \   0000F4   E5..         MOV     A,?V0 + 3
   \   0000F6   600C         JZ      ??ZDApp_NwkDescListProcessing_15
   2067              {
   2068                break;
   2069              }
   2070            }
   \   0000F8   05..         INC     ?V0 + 1
   \   0000FA   E5..         MOV     A,?V0 + 1
   \   0000FC   C3           CLR     C
   \   0000FD   9402         SUBB    A,#0x2
   \   0000FF   5003         JNC     $+5
   \   000101   02....       LJMP    ??ZDApp_NwkDescListProcessing_2 & 0xFFFF
   2071          
   2072            if ( i == ResultCount )
   \                     ??ZDApp_NwkDescListProcessing_15:
   \   000104   E5..         MOV     A,?V0 + 0
   \   000106   65..         XRL     A,?V0 + 2
   \   000108   7006         JNZ     ??ZDApp_NwkDescListProcessing_6
   2073            {
   2074              return (NULL);   // couldn't find appropriate PAN to join !
   \   00010A   7A00         MOV     R2,#0x0
   \   00010C   7B00         MOV     R3,#0x0
   \   00010E   8004         SJMP    ??ZDApp_NwkDescListProcessing_16
   2075            }
   2076            else
   2077            {
   2078              return (pNwkDesc);
   \                     ??ZDApp_NwkDescListProcessing_6:
   \   000110   EE           MOV     A,R6
   \   000111   FA           MOV     R2,A
   \   000112   EF           MOV     A,R7
   \   000113   FB           MOV     R3,A
   2079            }
   \                     ??ZDApp_NwkDescListProcessing_16:
   \   000114   02....       LJMP    ?Subroutine5 & 0xFFFF
   2080          }// ZDApp_NwkDescListProcessing()

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   EE           MOV     A,R6
   \   000001   2414         ADD     A,#0x14
   \   000003   F582         MOV     DPL,A
   \   000005   EF           MOV     A,R7
   \   000006   3400         ADDC    A,#0x0
   \   000008   F583         MOV     DPH,A
   \   00000A                REQUIRE ??Subroutine44_0
   \   00000A                ; // Fall through to label ??Subroutine44_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine44_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FE           MOV     R6,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FF           MOV     R7,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004                REQUIRE ??Subroutine45_0
   \   000004                ; // Fall through to label ??Subroutine45_0
   2081          
   2082          /*********************************************************************
   2083           * @fn          ZDO_NetworkFormationConfirmCB
   2084           *
   2085           * @brief       This function reports the results of the request to
   2086           *              initialize a coordinator in a network.
   2087           *
   2088           * @param       Status - Result of NLME_NetworkFormationRequest()
   2089           *
   2090           * @return      none
   2091           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ??Subroutine35_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_54:
   \   000003                REQUIRE ??Subroutine43_0
   \   000003                ; // Fall through to label ??Subroutine43_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2092          void ZDO_NetworkFormationConfirmCB( ZStatus_t Status )
   \                     ZDO_NetworkFormationConfirmCB:
   2093          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2094            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2095          
   2096            if ( Status == ZSUCCESS )
   \   00000A   700A         JNZ     ??ZDO_NetworkFormationConfirmCB_0
   2097            {
   2098              // LED on shows Coordinator started
   2099              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   12....       LCALL   ?Subroutine28 & 0xFFFF
   2100          
   2101              // LED off forgets HOLD_AUTO_START
   2102              HalLedSet (HAL_LED_4, HAL_LED_MODE_OFF);
   2103          
   2104          #if defined ( ZBIT )
   2105              SIM_SetColor(0xd0ffd0);
   2106          #endif
   2107          
   2108              if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_34:
   \   00000F   700C         JNZ     ??ZDO_NetworkFormationConfirmCB_1
   2109              {
   2110                // Began with HOLD_AUTO_START
   2111                devState = DEV_COORD_STARTING;
   \   000011   7408         MOV     A,#0x8
   \   000013   F0           MOVX    @DPTR,A
   \   000014   8007         SJMP    ??ZDO_NetworkFormationConfirmCB_1
   2112              }
   2113            }
   2114          #if defined(BLINK_LEDS)
   2115            else
   2116            {
   2117              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_NetworkFormationConfirmCB_0:
   \   000016                ; Setup parameters for call to function HalLedSet
   \   000016   7A04         MOV     R2,#0x4
   \   000018   7904         MOV     R1,#0x4
   \   00001A   12....       LCALL   ??HalLedSet?relay
   2118            }
   2119          #endif
   2120          
   2121            osal_set_event( ZDAppTaskID, ZDO_NETWORK_START );
   \                     ??ZDO_NetworkFormationConfirmCB_1:
   \   00001D                ; Setup parameters for call to function osal_set_event
   \   00001D   7A02         MOV     R2,#0x2
   \   00001F   02....       LJMP    ?Subroutine0 & 0xFFFF
   2122          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   7A01         MOV     R2,#0x1
   \   000002   7904         MOV     R1,#0x4
   \   000004   12....       LCALL   ??HalLedSet?relay
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007   7A00         MOV     R2,#0x0
   \   000009   7908         MOV     R1,#0x8
   \   00000B   12....       LCALL   ??HalLedSet?relay
   \   00000E   90....       MOV     DPTR,#devState
   \   000011   E0           MOVX    A,@DPTR
   \   000012   22           RET
   2123          
   2124          /****************************************************************************
   2125           * @fn          ZDApp_beaconIndProcessing
   2126           *
   2127           * @brief       This function processes the incoming beacon indication.
   2128           *
   2129           *              When another task (MT or App) is registered to process
   2130           *              beacon indication themselves, this function will parse the 
   2131           *              beacon payload and pass the beacon descriptor to that task
   2132           *              If no other tasks registered, this function will process
   2133           *              the beacon payload and generate the network descriptor link
   2134           *              list.
   2135           *
   2136           * @param
   2137           *
   2138           * @return      none
   2139           *
   2140           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2141          void ZDO_beaconNotifyIndCB( NLME_beaconInd_t *pBeacon )
   \                     ZDO_beaconNotifyIndCB:
   2142          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   2143            // Pass the beacon Indication to another task if it registers the callback
   2144            // Otherwise, process the beacon notification here.
   2145            if (zdoCBFunc[ZDO_BEACON_NOTIFY_IND_CBID] != NULL )
   \   000009   90....       MOV     DPTR,#(zdoCBFunc + 6)
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   7002         JNZ     ??ZDO_beaconNotifyIndCB_0
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \                     ??ZDO_beaconNotifyIndCB_0:
   \   000011   600C         JZ      ??ZDO_beaconNotifyIndCB_1
   2146            {  
   2147              zdoCBFunc[ZDO_BEACON_NOTIFY_IND_CBID]( (void*)pBeacon );
   \   000013                ; Setup parameters for indirect call
   \   000013   90....       MOV     DPTR,#(zdoCBFunc + 6)
   \   000016   12....       LCALL   ?Subroutine12 & 0xFFFF
   2148            }
   \                     ??CrossCallReturnLabel_11:
   \   000019   12....       LCALL   ?CALL_IND
   \   00001C   02....       LJMP    ??ZDO_beaconNotifyIndCB_2 & 0xFFFF
   2149            else
   2150            {
   2151              networkDesc_t *pNwkDesc;
   2152              networkDesc_t *pLastNwkDesc;
   2153              uint8 found = false;
   2154              
   2155              // Add the network to the Network Descriptor List
   2156              pNwkDesc = NwkDescList;
   \                     ??ZDO_beaconNotifyIndCB_1:
   \   00001F   90....       MOV     DPTR,#NwkDescList
   \   000022   12....       LCALL   ??Subroutine44_0 & 0xFFFF
   2157              pLastNwkDesc = NwkDescList;
   \                     ??CrossCallReturnLabel_75:
   \   000025   90....       MOV     DPTR,#NwkDescList
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F5..         MOV     ?V0 + 2,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F5..         MOV     ?V0 + 3,A
   \   00002F   802F         SJMP    ??CrossCallReturnLabel_78
   2158              while (pNwkDesc)
   2159              {
   2160                if ((pNwkDesc->panId == pBeacon->panID) &&
   2161                    (pNwkDesc->logicalChannel == pBeacon->logicalChannel))
   \                     ??ZDO_beaconNotifyIndCB_3:
   \   000031   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_84:
   \   000034   85..82       MOV     DPL,?V0 + 0
   \   000037   8B83         MOV     DPH,R3
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   68           XRL     A,R0
   \   00003D   7003         JNZ     ??ZDO_beaconNotifyIndCB_4
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   69           XRL     A,R1
   \                     ??ZDO_beaconNotifyIndCB_4:
   \   000042   7015         JNZ     ??ZDO_beaconNotifyIndCB_5
   \   000044   8E82         MOV     DPL,R6
   \   000046   8F83         MOV     DPH,R7
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   FA           MOV     R2,A
   \   00004C   85..82       MOV     DPL,?V0 + 0
   \   00004F   8B83         MOV     DPH,R3
   \   000051   A3           INC     DPTR
   \   000052   A3           INC     DPTR
   \   000053   A3           INC     DPTR
   \   000054   A3           INC     DPTR
   \   000055   E0           MOVX    A,@DPTR
   \   000056   6A           XRL     A,R2
   \   000057   606E         JZ      ??ZDO_beaconNotifyIndCB_6
   2162                {
   2163                  found = true;
   2164                  break;
   2165                }
   2166                pLastNwkDesc = pNwkDesc;
   \                     ??ZDO_beaconNotifyIndCB_5:
   \   000059   8E..         MOV     ?V0 + 2,R6
   \   00005B   8F..         MOV     ?V0 + 3,R7
   2167                pNwkDesc = pNwkDesc->nextDesc;
   \   00005D   12....       LCALL   ?Subroutine23 & 0xFFFF
   2168              }
   \                     ??CrossCallReturnLabel_78:
   \   000060   EE           MOV     A,R6
   \   000061   7001         JNZ     ??ZDO_beaconNotifyIndCB_7
   \   000063   EF           MOV     A,R7
   \                     ??ZDO_beaconNotifyIndCB_7:
   \   000064   70CB         JNZ     ??ZDO_beaconNotifyIndCB_3
   2169              
   2170              // If no existing descriptor found, make a new one and add to the list
   2171              if (found == false)
   2172              {
   2173                pNwkDesc = osal_mem_alloc( sizeof(networkDesc_t)  );
   \   000066                ; Setup parameters for call to function osal_mem_alloc
   \   000066   7A16         MOV     R2,#0x16
   \   000068   7B00         MOV     R3,#0x0
   \   00006A   12....       LCALL   ??osal_mem_alloc?relay
   \   00006D   8A..         MOV     ?V0 + 4,R2
   \   00006F   8B..         MOV     ?V0 + 5,R3
   \   000071   AE..         MOV     R6,?V0 + 4
   \   000073   AF..         MOV     R7,?V0 + 5
   2174                if ( !pNwkDesc )
   \   000075   EE           MOV     A,R6
   \   000076   7001         JNZ     ??ZDO_beaconNotifyIndCB_8
   \   000078   EF           MOV     A,R7
   \                     ??ZDO_beaconNotifyIndCB_8:
   \   000079   7003         JNZ     $+5
   \   00007B   02....       LJMP    ??ZDO_beaconNotifyIndCB_2 & 0xFFFF
   2175                {
   2176                  // Memory alloc failed, discard this beacon
   2177                  return;
   2178                }
   2179                
   2180                // Clear the network descriptor
   2181                osal_memset( pNwkDesc, 0, sizeof(networkDesc_t)  );
   \   00007E                ; Setup parameters for call to function osal_memset
   \   00007E   7C16         MOV     R4,#0x16
   \   000080   7D00         MOV     R5,#0x0
   \   000082   7900         MOV     R1,#0x0
   \   000084   12....       LCALL   ??osal_memset?relay
   2182                
   2183                // Initialize the descriptor
   2184                pNwkDesc->chosenRouter = INVALID_NODE_ADDR;
   \   000087   8E82         MOV     DPL,R6
   \   000089   8F83         MOV     DPH,R7
   \   00008B   A3           INC     DPTR
   \   00008C   A3           INC     DPTR
   \   00008D   A3           INC     DPTR
   \   00008E   A3           INC     DPTR
   \   00008F   A3           INC     DPTR
   \   000090   A3           INC     DPTR
   \   000091   A3           INC     DPTR
   \   000092   74FE         MOV     A,#-0x2
   \   000094   F0           MOVX    @DPTR,A
   \   000095   A3           INC     DPTR
   \   000096   74FF         MOV     A,#-0x1
   \   000098   F0           MOVX    @DPTR,A
   2185                pNwkDesc->chosenRouterDepth = 0xFF;
   \   000099   8E82         MOV     DPL,R6
   \   00009B   8F83         MOV     DPH,R7
   \   00009D   A3           INC     DPTR
   \   00009E   A3           INC     DPTR
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   A3           INC     DPTR
   \   0000A3   A3           INC     DPTR
   \   0000A4   A3           INC     DPTR
   \   0000A5   A3           INC     DPTR
   \   0000A6   A3           INC     DPTR
   \   0000A7   F0           MOVX    @DPTR,A
   2186                
   2187                // Save new entry into the descriptor list
   2188                if ( !NwkDescList )
   \   0000A8   90....       MOV     DPTR,#NwkDescList
   \   0000AB   E0           MOVX    A,@DPTR
   \   0000AC   7002         JNZ     ??ZDO_beaconNotifyIndCB_9
   \   0000AE   A3           INC     DPTR
   \   0000AF   E0           MOVX    A,@DPTR
   \                     ??ZDO_beaconNotifyIndCB_9:
   \   0000B0   7005         JNZ     ??ZDO_beaconNotifyIndCB_10
   2189                {
   2190                  NwkDescList = pNwkDesc;
   \   0000B2   90....       MOV     DPTR,#NwkDescList
   \   0000B5   800B         SJMP    ??CrossCallReturnLabel_85
   2191                }
   2192                else
   2193                {
   2194                  pLastNwkDesc->nextDesc = pNwkDesc;
   \                     ??ZDO_beaconNotifyIndCB_10:
   \   0000B7   E5..         MOV     A,?V0 + 2
   \   0000B9   2414         ADD     A,#0x14
   \   0000BB   F582         MOV     DPL,A
   \   0000BD   E5..         MOV     A,?V0 + 3
   \   0000BF   12....       LCALL   ??Subroutine47_0 & 0xFFFF
   2195                }
   2196              }
   \                     ??CrossCallReturnLabel_85:
   \   0000C2   EE           MOV     A,R6
   \   0000C3   F0           MOVX    @DPTR,A
   \   0000C4   A3           INC     DPTR
   \   0000C5   EF           MOV     A,R7
   \   0000C6   F0           MOVX    @DPTR,A
   2197              
   2198              // Update the descriptor with the incoming beacon
   2199              pNwkDesc->stackProfile   = pBeacon->stackProfile;
   \                     ??ZDO_beaconNotifyIndCB_6:
   \   0000C7   85..82       MOV     DPL,?V0 + 0
   \   0000CA   85..83       MOV     DPH,?V0 + 1
   \   0000CD   A3           INC     DPTR
   \   0000CE   A3           INC     DPTR
   \   0000CF   A3           INC     DPTR
   \   0000D0   A3           INC     DPTR
   \   0000D1   A3           INC     DPTR
   \   0000D2   A3           INC     DPTR
   \   0000D3   A3           INC     DPTR
   \   0000D4   A3           INC     DPTR
   \   0000D5   A3           INC     DPTR
   \   0000D6   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_28:
   \   0000D9   A3           INC     DPTR
   \   0000DA   F0           MOVX    @DPTR,A
   2200              pNwkDesc->version        = pBeacon->protocolVersion;
   \   0000DB   E5..         MOV     A,?V0 + 0
   \   0000DD   2408         ADD     A,#0x8
   \   0000DF   F8           MOV     R0,A
   \   0000E0   E5..         MOV     A,?V0 + 1
   \   0000E2   3400         ADDC    A,#0x0
   \   0000E4   F9           MOV     R1,A
   \   0000E5   8882         MOV     DPL,R0
   \   0000E7   8983         MOV     DPH,R1
   \   0000E9   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_29:
   \   0000EC   12....       LCALL   ?Subroutine9 & 0xFFFF
   2201              pNwkDesc->logicalChannel = pBeacon->logicalChannel;
   \                     ??CrossCallReturnLabel_4:
   \   0000EF   E0           MOVX    A,@DPTR
   \   0000F0   8E82         MOV     DPL,R6
   \   0000F2   8F83         MOV     DPH,R7
   \   0000F4   A3           INC     DPTR
   \   0000F5   A3           INC     DPTR
   \   0000F6   12....       LCALL   ?Subroutine32 & 0xFFFF
   2202              pNwkDesc->panId          = pBeacon->panID;
   \                     ??CrossCallReturnLabel_42:
   \   0000F9   12....       LCALL   ?Subroutine22 & 0xFFFF
   \                     ??CrossCallReturnLabel_59:
   \   0000FC   8E82         MOV     DPL,R6
   \   0000FE   8F83         MOV     DPH,R7
   \   000100   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   2203              pNwkDesc->updateId       = pBeacon->updateID;
   \                     ??CrossCallReturnLabel_106:
   \   000103   E5..         MOV     A,?V0 + 0
   \   000105   240C         ADD     A,#0xc
   \   000107   F582         MOV     DPL,A
   \   000109   E5..         MOV     A,?V0 + 1
   \   00010B   12....       LCALL   ??Subroutine49_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_92:
   \   00010E   C0E0         PUSH    A
   \   000110   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_91:
   \   000113   D0E0         POP     A
   \   000115   F0           MOVX    @DPTR,A
   2204              
   2205              // Save the extended PAN ID from the beacon payload only if 1.1 version network
   2206              if ( pBeacon->protocolVersion != ZB_PROT_V1_0 )
   \   000116   8882         MOV     DPL,R0
   \   000118   8983         MOV     DPH,R1
   \   00011A   E0           MOVX    A,@DPTR
   \   00011B   6401         XRL     A,#0x1
   \   00011D   6017         JZ      ??ZDO_beaconNotifyIndCB_11
   2207              {
   2208                osal_cpyExtAddr( pNwkDesc->extendedPANID, pBeacon->extendedPanID );
   \   00011F                ; Setup parameters for call to function sAddrExtCpy
   \   00011F   E5..         MOV     A,?V0 + 0
   \   000121   240D         ADD     A,#0xd
   \   000123   FC           MOV     R4,A
   \   000124   E5..         MOV     A,?V0 + 1
   \   000126   3400         ADDC    A,#0x0
   \   000128   FD           MOV     R5,A
   \   000129   EE           MOV     A,R6
   \   00012A   240B         ADD     A,#0xb
   \   00012C   FA           MOV     R2,A
   \   00012D   EF           MOV     A,R7
   \   00012E   3400         ADDC    A,#0x0
   \   000130   FB           MOV     R3,A
   \   000131   12....       LCALL   ??sAddrExtCpy?relay
   \   000134   8011         SJMP    ??ZDO_beaconNotifyIndCB_12
   2209              }
   2210              else
   2211              {
   2212                osal_memset( pNwkDesc->extendedPANID, 0xFF, Z_EXTADDR_LEN );
   \                     ??ZDO_beaconNotifyIndCB_11:
   \   000136                ; Setup parameters for call to function osal_memset
   \   000136   7C08         MOV     R4,#0x8
   \   000138   7D00         MOV     R5,#0x0
   \   00013A   79FF         MOV     R1,#-0x1
   \   00013C   EE           MOV     A,R6
   \   00013D   240B         ADD     A,#0xb
   \   00013F   FA           MOV     R2,A
   \   000140   EF           MOV     A,R7
   \   000141   3400         ADDC    A,#0x0
   \   000143   FB           MOV     R3,A
   \   000144   12....       LCALL   ??osal_memset?relay
   2213              }
   2214              
   2215              // check if this device is a better choice to join...
   2216              // ...dont bother checking assocPermit flag is doing a rejoin
   2217              if ( ( pBeacon->LQI > gMIN_TREE_LINK_COST ) &&
   2218                  ( ( pBeacon->permitJoining == TRUE ) || ( _tmpRejoinState ) ) )
   \                     ??ZDO_beaconNotifyIndCB_12:
   \   000147   90....       MOV     DPTR,#gMIN_TREE_LINK_COST
   \   00014A   E0           MOVX    A,@DPTR
   \   00014B   C0E0         PUSH    A
   \   00014D   85..82       MOV     DPL,?V0 + 0
   \   000150   85..83       MOV     DPH,?V0 + 1
   \   000153   A3           INC     DPTR
   \   000154   A3           INC     DPTR
   \   000155   A3           INC     DPTR
   \   000156   A3           INC     DPTR
   \   000157   A3           INC     DPTR
   \   000158   A3           INC     DPTR
   \   000159   A3           INC     DPTR
   \   00015A   A3           INC     DPTR
   \   00015B   A3           INC     DPTR
   \   00015C   A3           INC     DPTR
   \   00015D   E0           MOVX    A,@DPTR
   \   00015E   FA           MOV     R2,A
   \   00015F   D0E0         POP     A
   \   000161   C3           CLR     C
   \   000162   9A           SUBB    A,R2
   \   000163   4003         JC      $+5
   \   000165   02....       LJMP    ??ZDO_beaconNotifyIndCB_2 & 0xFFFF
   \   000168   85..82       MOV     DPL,?V0 + 0
   \   00016B   85..83       MOV     DPH,?V0 + 1
   \   00016E   A3           INC     DPTR
   \   00016F   A3           INC     DPTR
   \   000170   A3           INC     DPTR
   \   000171   A3           INC     DPTR
   \   000172   A3           INC     DPTR
   \   000173   E0           MOVX    A,@DPTR
   \   000174   6401         XRL     A,#0x1
   \   000176   6009         JZ      ??ZDO_beaconNotifyIndCB_13
   \   000178   90....       MOV     DPTR,#_tmpRejoinState
   \   00017B   E0           MOVX    A,@DPTR
   \   00017C   7003         JNZ     $+5
   \   00017E   02....       LJMP    ??ZDO_beaconNotifyIndCB_2 & 0xFFFF
   2219              {
   2220                uint8 selected = FALSE;
   \                     ??ZDO_beaconNotifyIndCB_13:
   \   000181   7B00         MOV     R3,#0x0
   2221                uint8 capacity = FALSE;
   2222                
   2223                if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \   000183   90....       MOV     DPTR,#(_NIB + 96)
   \   000186   E0           MOVX    A,@DPTR
   \   000187   6402         XRL     A,#0x2
   \   000189   7030         JNZ     ??ZDO_beaconNotifyIndCB_14
   2224                {
   2225                  if ( ((pBeacon->LQI   > pNwkDesc->chosenRouterLinkQuality) &&
   2226                        (pBeacon->depth < MAX_NODE_DEPTH)) ||
   2227                      ((pBeacon->LQI   == pNwkDesc->chosenRouterLinkQuality) &&
   2228                       (pBeacon->depth < pNwkDesc->chosenRouterDepth)) ) 
   \   00018B   8E82         MOV     DPL,R6
   \   00018D   8F83         MOV     DPH,R7
   \   00018F   A3           INC     DPTR
   \   000190   A3           INC     DPTR
   \   000191   A3           INC     DPTR
   \   000192   A3           INC     DPTR
   \   000193   A3           INC     DPTR
   \   000194   A3           INC     DPTR
   \   000195   A3           INC     DPTR
   \   000196   A3           INC     DPTR
   \   000197   A3           INC     DPTR
   \   000198   E0           MOVX    A,@DPTR
   \   000199   C3           CLR     C
   \   00019A   9A           SUBB    A,R2
   \   00019B   500D         JNC     ??ZDO_beaconNotifyIndCB_15
   \   00019D   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_37:
   \   0001A0   12....       LCALL   ??Subroutine49_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_93:
   \   0001A3   C3           CLR     C
   \   0001A4   9414         SUBB    A,#0x14
   \   0001A6   4031         JC      ??ZDO_beaconNotifyIndCB_16
   \   0001A8   8030         SJMP    ??ZDO_beaconNotifyIndCB_17
   \                     ??ZDO_beaconNotifyIndCB_15:
   \   0001AA   8E82         MOV     DPL,R6
   \   0001AC   8F83         MOV     DPH,R7
   \   0001AE   A3           INC     DPTR
   \   0001AF   A3           INC     DPTR
   \   0001B0   A3           INC     DPTR
   \   0001B1   A3           INC     DPTR
   \   0001B2   A3           INC     DPTR
   \   0001B3   A3           INC     DPTR
   \   0001B4   A3           INC     DPTR
   \   0001B5   A3           INC     DPTR
   \   0001B6   A3           INC     DPTR
   \   0001B7   E0           MOVX    A,@DPTR
   \   0001B8   6A           XRL     A,R2
   \   0001B9   701F         JNZ     ??ZDO_beaconNotifyIndCB_17
   \                     ??ZDO_beaconNotifyIndCB_14:
   \   0001BB   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_38:
   \   0001BE   12....       LCALL   ??Subroutine49_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_94:
   \   0001C1   C0E0         PUSH    A
   \   0001C3   8E82         MOV     DPL,R6
   \   0001C5   8F83         MOV     DPH,R7
   \   0001C7   A3           INC     DPTR
   \   0001C8   A3           INC     DPTR
   \   0001C9   A3           INC     DPTR
   \   0001CA   A3           INC     DPTR
   \   0001CB   A3           INC     DPTR
   \   0001CC   A3           INC     DPTR
   \   0001CD   A3           INC     DPTR
   \   0001CE   A3           INC     DPTR
   \   0001CF   A3           INC     DPTR
   \   0001D0   A3           INC     DPTR
   \   0001D1   E0           MOVX    A,@DPTR
   \   0001D2   FA           MOV     R2,A
   \   0001D3   D0E0         POP     A
   \   0001D5   C3           CLR     C
   \   0001D6   9A           SUBB    A,R2
   \   0001D7   5001         JNC     ??ZDO_beaconNotifyIndCB_17
   2229                  {
   2230                    selected = TRUE;
   \                     ??ZDO_beaconNotifyIndCB_16:
   \   0001D9   0B           INC     R3
   2231                  }
   2232                }
   2233                else
   2234                {
   2235                  if ( pBeacon->depth < pNwkDesc->chosenRouterDepth )
   2236                  {
   2237                    selected = TRUE;
   2238                  }
   2239                }
   2240                
   2241                if ( ZSTACK_ROUTER_BUILD )
   2242                {
   2243                  capacity = pBeacon->routerCapacity;
   2244                }
   2245                else if ( ZSTACK_END_DEVICE_BUILD )
   2246                {
   2247                  capacity = pBeacon->deviceCapacity;
   2248                }
   2249                
   2250                if ( (capacity) && (selected) )
   \                     ??ZDO_beaconNotifyIndCB_17:
   \   0001DA   85..82       MOV     DPL,?V0 + 0
   \   0001DD   85..83       MOV     DPH,?V0 + 1
   \   0001E0   A3           INC     DPTR
   \   0001E1   A3           INC     DPTR
   \   0001E2   A3           INC     DPTR
   \   0001E3   A3           INC     DPTR
   \   0001E4   A3           INC     DPTR
   \   0001E5   A3           INC     DPTR
   \   0001E6   E0           MOVX    A,@DPTR
   \   0001E7   6033         JZ      ??ZDO_beaconNotifyIndCB_18
   \   0001E9   EB           MOV     A,R3
   \   0001EA   6030         JZ      ??ZDO_beaconNotifyIndCB_18
   2251                {
   2252                  // this is the new chosen router for joining...
   2253                  pNwkDesc->chosenRouter            = pBeacon->sourceAddr;
   \   0001EC   85..82       MOV     DPL,?V0 + 0
   \   0001EF   85..83       MOV     DPH,?V0 + 1
   \   0001F2   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_80:
   \   0001F5   8E82         MOV     DPL,R6
   \   0001F7   8F83         MOV     DPH,R7
   \   0001F9   A3           INC     DPTR
   \   0001FA   A3           INC     DPTR
   \   0001FB   A3           INC     DPTR
   \   0001FC   A3           INC     DPTR
   \   0001FD   A3           INC     DPTR
   \   0001FE   A3           INC     DPTR
   \   0001FF   A3           INC     DPTR
   \   000200   E8           MOV     A,R0
   \   000201   F0           MOVX    @DPTR,A
   \   000202   A3           INC     DPTR
   \   000203   E9           MOV     A,R1
   \   000204   12....       LCALL   ?Subroutine9 & 0xFFFF
   2254                  pNwkDesc->chosenRouterLinkQuality = pBeacon->LQI;
   \                     ??CrossCallReturnLabel_5:
   \   000207   A3           INC     DPTR
   \   000208   A3           INC     DPTR
   \   000209   A3           INC     DPTR
   \   00020A   A3           INC     DPTR
   \   00020B   A3           INC     DPTR
   \   00020C   A3           INC     DPTR
   \   00020D   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   000210   F0           MOVX    @DPTR,A
   2255                  pNwkDesc->chosenRouterDepth       = pBeacon->depth;
   \   000211   12....       LCALL   ?Subroutine30 & 0xFFFF
   2256                }
   \                     ??CrossCallReturnLabel_39:
   \   000214   12....       LCALL   ??Subroutine47_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_86:
   \   000217   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   00021A   A3           INC     DPTR
   \   00021B   F0           MOVX    @DPTR,A
   2257                
   2258                if ( pBeacon->deviceCapacity )
   \                     ??ZDO_beaconNotifyIndCB_18:
   \   00021C   85..82       MOV     DPL,?V0 + 0
   \   00021F   85..83       MOV     DPH,?V0 + 1
   \   000222   A3           INC     DPTR
   \   000223   A3           INC     DPTR
   \   000224   A3           INC     DPTR
   \   000225   A3           INC     DPTR
   \   000226   A3           INC     DPTR
   \   000227   A3           INC     DPTR
   \   000228   A3           INC     DPTR
   \   000229   E0           MOVX    A,@DPTR
   \   00022A   600B         JZ      ??ZDO_beaconNotifyIndCB_19
   2259                  pNwkDesc->deviceCapacity = 1;
   \   00022C   7401         MOV     A,#0x1
   \   00022E   8E82         MOV     DPL,R6
   \   000230   8F83         MOV     DPH,R7
   \   000232   A3           INC     DPTR
   \   000233   A3           INC     DPTR
   \   000234   A3           INC     DPTR
   \   000235   A3           INC     DPTR
   \   000236   F0           MOVX    @DPTR,A
   2260                
   2261                if ( pBeacon->routerCapacity )
   \                     ??ZDO_beaconNotifyIndCB_19:
   \   000237   85..82       MOV     DPL,?V0 + 0
   \   00023A   85..83       MOV     DPH,?V0 + 1
   \   00023D   A3           INC     DPTR
   \   00023E   A3           INC     DPTR
   \   00023F   A3           INC     DPTR
   \   000240   A3           INC     DPTR
   \   000241   A3           INC     DPTR
   \   000242   A3           INC     DPTR
   \   000243   E0           MOVX    A,@DPTR
   \   000244   600A         JZ      ??ZDO_beaconNotifyIndCB_2
   2262                  pNwkDesc->routerCapacity = 1;
   \   000246   7401         MOV     A,#0x1
   \   000248   8E82         MOV     DPL,R6
   \   00024A   8F83         MOV     DPH,R7
   \   00024C   A3           INC     DPTR
   \   00024D   A3           INC     DPTR
   \   00024E   A3           INC     DPTR
   \   00024F   F0           MOVX    @DPTR,A
   2263              }
   2264            }
   \                     ??ZDO_beaconNotifyIndCB_2:
   \   000250   02....       LJMP    ?Subroutine5 & 0xFFFF
   2265          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine30:
   \   000000   E5..         MOV     A,?V0 + 0
   \   000002   240B         ADD     A,#0xb
   \   000004   F582         MOV     DPL,A
   \   000006   E5..         MOV     A,?V0 + 1
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_45:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine33:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_44:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   12....       LCALL   ?Subroutine32 & 0xFFFF
   \                     ??CrossCallReturnLabel_43:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine32:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   85..82       MOV     DPL,?V0 + 0
   \   000004   85..83       MOV     DPH,?V0 + 1
   \   000007   A3           INC     DPTR
   \   000008   22           RET
   2266          
   2267          /*********************************************************************
   2268           * @fn          ZDO_StartRouterConfirmCB
   2269           *
   2270           * @brief       This function reports the results of the request to
   2271           *              start functioning as a router in a network.
   2272           *
   2273           * @param       Status - Result of NLME_StartRouterRequest()
   2274           *
   2275           * @return      none
   2276           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2277          void ZDO_StartRouterConfirmCB( ZStatus_t Status )
   \                     ZDO_StartRouterConfirmCB:
   2278          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2279            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2280          
   2281            if ( Status == ZSUCCESS )
   \   00000A   700A         JNZ     ??ZDO_StartRouterConfirmCB_0
   2282            {
   2283              // LED on shows Router started
   2284              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   12....       LCALL   ?Subroutine28 & 0xFFFF
   2285              // LED off forgets HOLD_AUTO_START
   2286              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   2287              if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_35:
   \   00000F   700C         JNZ     ??ZDO_StartRouterConfirmCB_1
   2288              {
   2289                // Began with HOLD_AUTO_START
   2290                devState = DEV_END_DEVICE;
   \   000011   7406         MOV     A,#0x6
   \   000013   F0           MOVX    @DPTR,A
   \   000014   8007         SJMP    ??ZDO_StartRouterConfirmCB_1
   2291              }
   2292            }
   2293          #if defined(BLINK_LEDS)
   2294            else
   2295            {
   2296              HalLedSet( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_StartRouterConfirmCB_0:
   \   000016                ; Setup parameters for call to function HalLedSet
   \   000016   7A04         MOV     R2,#0x4
   \   000018   7904         MOV     R1,#0x4
   \   00001A   12....       LCALL   ??HalLedSet?relay
   2297            }
   2298          #endif
   2299          
   2300            osal_set_event( ZDAppTaskID, ZDO_ROUTER_START );
   \                     ??ZDO_StartRouterConfirmCB_1:
   \   00001D                ; Setup parameters for call to function osal_set_event
   \   00001D   7A20         MOV     R2,#0x20
   \   00001F   02....       LJMP    ?Subroutine0 & 0xFFFF
   2301          }
   2302          
   2303          /*********************************************************************
   2304           * @fn          ZDO_JoinConfirmCB
   2305           *
   2306           * @brief       This function allows the next hight layer to be notified
   2307           *              of the results of its request to join itself or another
   2308           *              device to a network.
   2309           *
   2310           * @param       Status - Result of NLME_JoinRequest()
   2311           *
   2312           * @return      none
   2313           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2314          void ZDO_JoinConfirmCB( uint16 PanId, ZStatus_t Status )
   \                     ZDO_JoinConfirmCB:
   2315          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   2316            (void)PanId;  // remove if this parameter is used.
   2317            
   2318            nwkStatus = (byte)Status;
   \   00000C   90....       MOV     DPTR,#nwkStatus
   \   00000F   F0           MOVX    @DPTR,A
   2319          
   2320            if ( Status == ZSUCCESS )
   \   000010   700A         JNZ     ??ZDO_JoinConfirmCB_0
   2321            {
   2322              // LED on shows device joined
   2323              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   000012                ; Setup parameters for call to function HalLedSet
   \   000012   12....       LCALL   ?Subroutine28 & 0xFFFF
   2324              // LED off forgets HOLD_AUTO_START
   2325              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   2326              if ( (devState == DEV_HOLD) )
   \                     ??CrossCallReturnLabel_36:
   \   000015   700C         JNZ     ??ZDO_JoinConfirmCB_1
   2327              {
   2328                // Began with HOLD_AUTO_START
   2329                devState = DEV_NWK_JOINING;
   \   000017   7403         MOV     A,#0x3
   \   000019   F0           MOVX    @DPTR,A
   \   00001A   8007         SJMP    ??ZDO_JoinConfirmCB_1
   2330              }
   2331          
   2332              if ( !ZG_SECURE_ENABLED )
   2333              {
   2334                // Notify to save info into NV
   2335                ZDApp_NVUpdate();
   2336              }
   2337            }
   2338            else
   2339            {
   2340          #if defined(BLINK_LEDS)
   2341              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_JoinConfirmCB_0:
   \   00001C                ; Setup parameters for call to function HalLedSet
   \   00001C   7A04         MOV     R2,#0x4
   \   00001E   7904         MOV     R1,#0x4
   \   000020   12....       LCALL   ??HalLedSet?relay
   2342          #endif
   2343            }
   2344              
   2345            // Pass the join confirm to higher layer if callback registered
   2346            if (zdoCBFunc[ZDO_JOIN_CNF_CBID] != NULL )
   \                     ??ZDO_JoinConfirmCB_1:
   \   000023   90....       MOV     DPTR,#(zdoCBFunc + 8)
   \   000026   E0           MOVX    A,@DPTR
   \   000027   7002         JNZ     ??ZDO_JoinConfirmCB_2
   \   000029   A3           INC     DPTR
   \   00002A   E0           MOVX    A,@DPTR
   \                     ??ZDO_JoinConfirmCB_2:
   \   00002B   6033         JZ      ??ZDO_JoinConfirmCB_3
   2347            {  
   2348              zdoJoinCnf_t joinCnf;
   2349              
   2350              joinCnf.status = Status;
   \   00002D   EE           MOV     A,R6
   \   00002E   85..82       MOV     DPL,?XSP + 0
   \   000031   85..83       MOV     DPH,?XSP + 1
   \   000034   F0           MOVX    @DPTR,A
   2351              joinCnf.deviceAddr = _NIB.nwkDevAddress;
   \   000035   90....       MOV     DPTR,#(_NIB + 20)
   \   000038   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_81:
   \   00003B   7401         MOV     A,#0x1
   \   00003D   12....       LCALL   ?XSTACK_DISP0_8
   \   000040   E8           MOV     A,R0
   \   000041   F0           MOVX    @DPTR,A
   \   000042   A3           INC     DPTR
   \   000043   E9           MOV     A,R1
   \   000044   F0           MOVX    @DPTR,A
   2352              joinCnf.parentAddr = _NIB.nwkCoordAddress;
   \   000045   90....       MOV     DPTR,#(_NIB + 23)
   \   000048   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   2353                     
   2354              zdoCBFunc[ZDO_JOIN_CNF_CBID]( (void*)&joinCnf );
   2355            }
   \                     ??CrossCallReturnLabel_82:
   \   00004B   7403         MOV     A,#0x3
   \   00004D   12....       LCALL   ?XSTACK_DISP0_8
   \   000050   E8           MOV     A,R0
   \   000051   F0           MOVX    @DPTR,A
   \   000052   A3           INC     DPTR
   \   000053   E9           MOV     A,R1
   \   000054   12....       LCALL   ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   000057   90....       MOV     DPTR,#(zdoCBFunc + 8)
   \   00005A   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   00005D   12....       LCALL   ?CALL_IND
   2356            
   2357            // Notify ZDApp
   2358            ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_IND, sizeof(osal_event_hdr_t), (byte*)NULL );
   \                     ??ZDO_JoinConfirmCB_3:
   \   000060                ; Setup parameters for call to function ZDApp_SendMsg
   \   000060   7C00         MOV     R4,#0x0
   \   000062   7D00         MOV     R5,#0x0
   \   000064   7B02         MOV     R3,#0x2
   \   000066   7A02         MOV     R2,#0x2
   \   000068   12....       LCALL   ?Subroutine20 & 0xFFFF
   2359            
   2360          }
   \                     ??CrossCallReturnLabel_26:
   \   00006B                REQUIRE ?Subroutine6
   \   00006B                ; // Fall through to label ?Subroutine6

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   7405         MOV     A,#0x5
   \   000002   12....       LCALL   ?DEALLOC_XSTACK8
   \   000005   02....       LJMP    ??Subroutine43_0 & 0xFFFF
   2361          
   2362          /*********************************************************************
   2363           * @fn          ZDO_AddrChangeIndicationCB
   2364           *
   2365           * @brief       This function notifies the application that this
   2366           *              device's address has changed.  Could happen in 
   2367           *              a network with stochastic addressing (PRO).
   2368           *
   2369           * @param       newAddr - the new address
   2370           *
   2371           * @return      none
   2372           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2373          void ZDO_AddrChangeIndicationCB( uint16 newAddr )
   \                     ZDO_AddrChangeIndicationCB:
   2374          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2375            (void)newAddr;  // remove if this parameter is used
   2376            
   2377            // Notify to save info into NV
   2378            ZDApp_NVUpdate();
   2379          
   2380            // Notify the applications   
   2381            osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000004                ; Setup parameters for call to function osal_set_event
   \   000004   12....       LCALL   ?Subroutine13 & 0xFFFF
   2382          
   2383            // Send out a device announce
   2384            ZDApp_AnnounceNewAddress();
   \                     ??CrossCallReturnLabel_52:
   \   000007                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000007   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   2385          }
   \   00000A   02....       LJMP    ?Subroutine2 & 0xFFFF
   2386          
   2387          /*********************************************************************
   2388           * @fn          ZDO_JoinIndicationCB
   2389           *
   2390           * @brief       This function allows the next higher layer of a
   2391           *              coordinator to be notified of a remote join request.
   2392           *
   2393           * @param       ShortAddress - 16-bit address
   2394           * @param       ExtendedAddress - IEEE (64-bit) address
   2395           * @param       CapabilityFlags - Association Capability Flags
   2396           * @param       type - of joining - 
   2397           *                          NWK_ASSOC_JOIN
   2398           *                          NWK_ASSOC_REJOIN_UNSECURE
   2399           *                          NWK_ASSOC_REJOIN_SECURE
   2400           *
   2401           * @return      ZStatus_t
   2402           */
   2403          ZStatus_t ZDO_JoinIndicationCB(uint16 ShortAddress, uint8 *ExtendedAddress,
   \                     ZDO_JoinIndicationCB:
   2404                                          uint8 CapabilityFlags, uint8 type)
   2405          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2406            (void)ShortAddress;
   2407            (void)ExtendedAddress;
   2408          #if ZDO_NV_SAVE_RFDs
   2409            (void)CapabilityFlags;
   2410            
   2411          #else  // if !ZDO_NV_SAVE_RFDs
   2412            if (CapabilityFlags & CAPINFO_DEVICETYPE_FFD)
   2413          #endif
   2414            {
   2415              ZDApp_NVUpdate();  // Notify to save info into NV.
   2416            }
   2417          
   2418            if (ZG_SECURE_ENABLED)  // Send notification to TC of new device.
   2419            {
   2420              if (type == NWK_ASSOC_JOIN || type == NWK_ASSOC_REJOIN_UNSECURE)
   2421              {
   2422                osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 600 );
   2423              }
   2424            }
   2425          
   2426            return ZSuccess;
   \   000000                REQUIRE ?Subroutine3
   \   000000                ; // Fall through to label ?Subroutine3

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   7900         MOV     R1,#0x0
   \   000002   02....       LJMP    ?BRET
   2427          }
   2428          
   2429          /*********************************************************************
   2430           * @fn          ZDO_ConcentratorIndicationCB
   2431           *
   2432           * @brief       This function allows the next higher layer of a
   2433           *              device to be notified of existence of the concentrator.
   2434           *
   2435           * @param       nwkAddr - 16-bit NWK address of the concentrator
   2436           * @param       extAddr - pointer to extended Address
   2437           *                        NULL if not available
   2438           * @param       pktCost - PktCost from RREQ
   2439           *
   2440           * @return      void 
   2441           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2442          void ZDO_ConcentratorIndicationCB( uint16 nwkAddr, uint8 *extAddr, uint8 pktCost )
   \                     ZDO_ConcentratorIndicationCB:
   2443          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   2444            zdoConcentratorInd_t conInd;
   2445            
   2446            conInd.nwkAddr = nwkAddr;
   \   00000A   12....       LCALL   ?Subroutine10 & 0xFFFF
   2447            conInd.extAddr = extAddr;
   \                     ??CrossCallReturnLabel_109:
   \   00000D   7402         MOV     A,#0x2
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   EC           MOV     A,R4
   \   000013   F0           MOVX    @DPTR,A
   \   000014   A3           INC     DPTR
   \   000015   ED           MOV     A,R5
   \   000016   F0           MOVX    @DPTR,A
   2448            conInd.pktCost = pktCost;
   \   000017   7404         MOV     A,#0x4
   \   000019   12....       LCALL   ?XSTACK_DISP0_8
   \   00001C   E9           MOV     A,R1
   \   00001D   F0           MOVX    @DPTR,A
   2449            
   2450            if( zdoCBFunc[ZDO_CONCENTRATOR_IND_CBID] != NULL )
   \   00001E   90....       MOV     DPTR,#(zdoCBFunc + 2)
   \   000021   E0           MOVX    A,@DPTR
   \   000022   7002         JNZ     ??ZDO_ConcentratorIndicationCB_0
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \                     ??ZDO_ConcentratorIndicationCB_0:
   \   000026   6013         JZ      ??ZDO_ConcentratorIndicationCB_1
   2451            {
   2452              zdoCBFunc[ZDO_CONCENTRATOR_IND_CBID]( (void*)&conInd );
   \   000028                ; Setup parameters for indirect call
   \   000028   85..82       MOV     DPL,?XSP + 0
   \   00002B   85..83       MOV     DPH,?XSP + 1
   \   00002E   AA82         MOV     R2,DPL
   \   000030   AB83         MOV     R3,DPH
   \   000032   90....       MOV     DPTR,#(zdoCBFunc + 2)
   \   000035   12....       LCALL   ?Subroutine12 & 0xFFFF
   2453            }
   \                     ??CrossCallReturnLabel_13:
   \   000038   12....       LCALL   ?CALL_IND
   2454          }
   \                     ??ZDO_ConcentratorIndicationCB_1:
   \   00003B   80..         SJMP    ?Subroutine6
   2455          
   2456          /*********************************************************************
   2457           * @fn          ZDO_LeaveCnf
   2458           *
   2459           * @brief       This function allows the next higher layer to be
   2460           *              notified of the results of its request for this or
   2461           *              a child device to leave the network.
   2462           *
   2463           * @param       cnf - NLME_LeaveCnf_t
   2464           *
   2465           * @return      none
   2466           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2467          void ZDO_LeaveCnf( NLME_LeaveCnf_t* cnf )
   \                     ZDO_LeaveCnf:
   2468          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2469            // Check for this device
   2470            if ( osal_ExtAddrEqual( cnf->extAddr,
   2471                                    NLME_GetExtAddr() ) == TRUE )
   \   000009                ; Setup parameters for call to function sAddrExtCmp
   \   000009                ; Setup parameters for call to function NLME_GetExtAddr
   \   000009   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000C   EA           MOV     A,R2
   \   00000D   FC           MOV     R4,A
   \   00000E   EB           MOV     A,R3
   \   00000F   FD           MOV     R5,A
   \   000010   EE           MOV     A,R6
   \   000011   2402         ADD     A,#0x2
   \   000013   FA           MOV     R2,A
   \   000014   EF           MOV     A,R7
   \   000015   3400         ADDC    A,#0x0
   \   000017   FB           MOV     R3,A
   \   000018   12....       LCALL   ??sAddrExtCmp?relay
   \   00001B   E9           MOV     A,R1
   \   00001C   6401         XRL     A,#0x1
   \   00001E   7009         JNZ     ??ZDO_LeaveCnf_0
   2472            {
   2473              // Prepare to leave with reset
   2474              ZDApp_LeaveReset( cnf->rejoin );
   \   000020                ; Setup parameters for call to function ZDApp_LeaveReset
   \   000020   12....       LCALL   ?Subroutine26 & 0xFFFF
   2475            }
   \                     ??CrossCallReturnLabel_100:
   \   000023   F9           MOV     R1,A
   \   000024   12....       LCALL   ??ZDApp_LeaveReset?relay
   \   000027   8011         SJMP    ??CrossCallReturnLabel_15
   2476            else if ( ZSTACK_ROUTER_BUILD )
   2477            {
   2478              // Remove device address(optionally descendents) from data
   2479              ZDApp_LeaveUpdate( cnf->dstAddr,
   2480                                 cnf->extAddr,
   2481                                 cnf->removeChildren );
   \                     ??ZDO_LeaveCnf_0:
   \   000029                ; Setup parameters for call to function NLME_RemoveChild
   \   000029   8E82         MOV     DPL,R6
   \   00002B   8F83         MOV     DPH,R7
   \   00002D   A3           INC     DPTR
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   A3           INC     DPTR
   \   000031   A3           INC     DPTR
   \   000032   A3           INC     DPTR
   \   000033   A3           INC     DPTR
   \   000034   A3           INC     DPTR
   \   000035   A3           INC     DPTR
   \   000036   A3           INC     DPTR
   \   000037   12....       LCALL   ?Subroutine15 & 0xFFFF
   2482            }
   2483          }
   \                     ??CrossCallReturnLabel_15:
   \   00003A   02....       LJMP    ??Subroutine43_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   EE           MOV     A,R6
   \   000001   240B         ADD     A,#0xb
   \   000003                REQUIRE ??Subroutine48_0
   \   000003                ; // Fall through to label ??Subroutine48_0
   2484          
   2485          /*********************************************************************
   2486           * @fn          ZDO_LeaveInd
   2487           *
   2488           * @brief       This function allows the next higher layer of a
   2489           *              device to be notified of a remote leave request or
   2490           *              indication.
   2491           *
   2492           * @param       ind - NLME_LeaveInd_t
   2493           *
   2494           * @return      none
   2495           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2496          void ZDO_LeaveInd( NLME_LeaveInd_t* ind )
   \                     ZDO_LeaveInd:
   2497          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   2498            uint8 leave;
   2499          
   2500          
   2501            // Parent is requesting the leave - NWK layer filters out illegal
   2502            // requests
   2503            if ( ind->request == TRUE )
   \   00000E   8E82         MOV     DPL,R6
   \   000010   8F83         MOV     DPH,R7
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   A3           INC     DPTR
   \   000015   A3           INC     DPTR
   \   000016   A3           INC     DPTR
   \   000017   A3           INC     DPTR
   \   000018   A3           INC     DPTR
   \   000019   A3           INC     DPTR
   \   00001A   A3           INC     DPTR
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   6401         XRL     A,#0x1
   \   00001F   7039         JNZ     ??ZDO_LeaveInd_0
   2504            {
   2505              // Notify network of leave
   2506              if ( ZSTACK_ROUTER_BUILD )
   2507              {
   2508                NLME_LeaveRsp_t rsp;
   2509                rsp.rejoin         = ind->rejoin;
   \   000021   EE           MOV     A,R6
   \   000022   240C         ADD     A,#0xc
   \   000024   F8           MOV     R0,A
   \   000025   EF           MOV     A,R7
   \   000026   3400         ADDC    A,#0x0
   \   000028   F9           MOV     R1,A
   \   000029   88..         MOV     ?V0 + 0,R0
   \   00002B   89..         MOV     ?V0 + 1,R1
   \   00002D   8882         MOV     DPL,R0
   \   00002F   F583         MOV     DPH,A
   \   000031   E0           MOVX    A,@DPTR
   \   000032   C0E0         PUSH    A
   \   000034   7401         MOV     A,#0x1
   \   000036   12....       LCALL   ?XSTACK_DISP0_8
   \   000039   D0E0         POP     A
   \   00003B   F0           MOVX    @DPTR,A
   2510                rsp.removeChildren = ind->removeChildren;
   \   00003C   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_101:
   \   00003F   85..82       MOV     DPL,?XSP + 0
   \   000042   85..83       MOV     DPH,?XSP + 1
   \   000045   F0           MOVX    @DPTR,A
   2511                NLME_LeaveRsp( &rsp );
   \   000046                ; Setup parameters for call to function NLME_LeaveRsp
   \   000046   AA82         MOV     R2,DPL
   \   000048   AB83         MOV     R3,DPH
   \   00004A   12....       LCALL   ??NLME_LeaveRsp?relay
   2512              }
   2513          
   2514              // Prepare to leave with reset
   2515              ZDApp_LeaveReset( ind->rejoin );
   \   00004D                ; Setup parameters for call to function ZDApp_LeaveReset
   \   00004D   85..82       MOV     DPL,?V0 + 0
   \   000050   85..83       MOV     DPH,?V0 + 1
   \                     ??ZDO_LeaveInd_1:
   \   000053   E0           MOVX    A,@DPTR
   \   000054   F9           MOV     R1,A
   \   000055   12....       LCALL   ??ZDApp_LeaveReset?relay
   \   000058   8035         SJMP    ??CrossCallReturnLabel_16
   2516            }
   2517            else
   2518            {
   2519              leave = FALSE;
   2520          
   2521              // Check if this device needs to leave as a child or descendent
   2522              if ( ind->srcAddr == NLME_GetCoordShortAddr() )
   \                     ??ZDO_LeaveInd_0:
   \   00005A                ; Setup parameters for call to function NLME_GetCoordShortAddr
   \   00005A   12....       LCALL   ??NLME_GetCoordShortAddr?relay
   \   00005D   8A..         MOV     ?V0 + 0,R2
   \   00005F   8B..         MOV     ?V0 + 1,R3
   \   000061   A8..         MOV     R0,?V0 + 0
   \   000063   A9..         MOV     R1,?V0 + 1
   \   000065   8E82         MOV     DPL,R6
   \   000067   8F83         MOV     DPH,R7
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   68           XRL     A,R0
   \   00006B   7003         JNZ     ??ZDO_LeaveInd_2
   \   00006D   A3           INC     DPTR
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   69           XRL     A,R1
   \                     ??ZDO_LeaveInd_2:
   \   000070   7014         JNZ     ??ZDO_LeaveInd_3
   2523              {
   2524                if ( ( ind->removeChildren == TRUE               ) ||
   2525                     ( ZDO_Config_Node_Descriptor.LogicalType ==
   2526                       NODETYPE_DEVICE                           )    )
   \   000072   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_102:
   \   000075   6401         XRL     A,#0x1
   \   000077   6005         JZ      ??ZDO_LeaveInd_4
   \   000079   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   00007C   7008         JNZ     ??ZDO_LeaveInd_3
   2527                {
   2528                  leave = TRUE;
   2529                }
   2530              }
   2531              else if ( ind->removeChildren == TRUE )
   2532              {
   2533                // Check NWK address allocation algorithm
   2534                //leave = RTG_ANCESTOR(nwkAddr,thisAddr);
   2535              }
   2536          
   2537              if ( leave == TRUE )
   2538              {
   2539                // Prepare to leave with reset
   2540                ZDApp_LeaveReset( ind->rejoin );
   \                     ??ZDO_LeaveInd_4:
   \   00007E                ; Setup parameters for call to function ZDApp_LeaveReset
   \   00007E   EE           MOV     A,R6
   \   00007F   240C         ADD     A,#0xc
   \   000081   12....       LCALL   ??Subroutine46_0 & 0xFFFF
   2541              }
   \                     ??CrossCallReturnLabel_87:
   \   000084   80CD         SJMP    ??ZDO_LeaveInd_1
   2542              else
   2543              {
   2544                // Remove device address(optionally descendents) from data
   2545                ZDApp_LeaveUpdate( ind->srcAddr,
   2546                                   ind->extAddr,
   2547                                   ind->removeChildren );
   \                     ??ZDO_LeaveInd_3:
   \   000086                ; Setup parameters for call to function NLME_RemoveChild
   \   000086   EE           MOV     A,R6
   \   000087   240B         ADD     A,#0xb
   \   000089   12....       LCALL   ??Subroutine46_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_88:
   \   00008C   12....       LCALL   ?Subroutine15 & 0xFFFF
   2548              }
   2549            }
   2550          }
   \                     ??CrossCallReturnLabel_16:
   \   00008F   02....       LJMP    ?Subroutine1 & 0xFFFF
   2551          
   2552          /*********************************************************************
   2553           * @fn          ZDO_SyncIndicationCB
   2554           *
   2555           * @brief       This function allows the next higher layer of a
   2556           *              coordinator to be notified of a loss of synchronization
   2557           *                          with the parent/child device.
   2558           *
   2559           * @param       type: 0 - child; 1 - parent
   2560           *
   2561           *
   2562           * @return      none
   2563           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2564          void ZDO_SyncIndicationCB( uint8 type, uint16 shortAddr )
   \                     ZDO_SyncIndicationCB:
   2565          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   2566            (void)shortAddr;  // Remove this line if this parameter is used.
   2567            
   2568            if ( ZSTACK_END_DEVICE_BUILD
   2569              || (ZSTACK_ROUTER_BUILD && ((_NIB.CapabilityFlags & ZMAC_ASSOC_CAPINFO_FFD_TYPE) == 0)))
   \   000007   90....       MOV     DPTR,#(_NIB + 14)
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   4013         JC      ??CrossCallReturnLabel_27
   2570            {
   2571              if ( type == 1 )
   \   00000F   7401         MOV     A,#0x1
   \   000011   6E           XRL     A,R6
   \   000012   700E         JNZ     ??CrossCallReturnLabel_27
   2572              {
   2573                // We lost contact with our parent.  Clear the neighbor Table.
   2574                nwkNeighborInitTable();
   \   000014                ; Setup parameters for call to function nwkNeighborInitTable
   \   000014   12....       LCALL   ??nwkNeighborInitTable?relay
   2575                
   2576                // Start the rejoin process.
   2577                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_REQ, sizeof(osal_event_hdr_t), NULL );
   \   000017                ; Setup parameters for call to function ZDApp_SendMsg
   \   000017   7C00         MOV     R4,#0x0
   \   000019   7D00         MOV     R5,#0x0
   \   00001B   7B02         MOV     R3,#0x2
   \   00001D   7A03         MOV     R2,#0x3
   \   00001F   12....       LCALL   ?Subroutine20 & 0xFFFF
   2578              }
   2579            }
   2580          }
   \                     ??CrossCallReturnLabel_27:
   \   000022   02....       LJMP    ??Subroutine43_0 & 0xFFFF
   2581          
   2582          /*********************************************************************
   2583           * @fn          ZDO_ManytoOneFailureIndicationCB
   2584           *
   2585           * @brief       This function allows the next higher layer of a
   2586           *              concentrator to be notified of a many-to-one route 
   2587           *              failure. 
   2588           *
   2589           * @param       none
   2590           *
   2591           *
   2592           * @return      none
   2593           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2594          void ZDO_ManytoOneFailureIndicationCB()
   \                     ZDO_ManytoOneFailureIndicationCB:
   2595          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2596            // By default, the concentrator automatically redo many-to-one route 
   2597            // discovery to update all many-to-one routes in the network
   2598            // If you want anything processing other than the default,
   2599            // please replace the following code.
   2600            
   2601            RTG_MTORouteReq();
   \   000004                ; Setup parameters for call to function RTG_MTORouteReq
   \   000004   12....       LCALL   ??RTG_MTORouteReq?relay
   2602          }
   \   000007   02....       LJMP    ?Subroutine2 & 0xFFFF
   2603          
   2604          /*********************************************************************
   2605           * @fn          ZDO_PollConfirmCB
   2606           *
   2607           * @brief       This function allows the next higher layer to be
   2608           *              notified of a Poll Confirm.
   2609           *
   2610           * @param       none
   2611           *
   2612           * @return      none
   2613           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2614          void ZDO_PollConfirmCB( uint8 status )
   \                     ZDO_PollConfirmCB:
   2615          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2616            (void)status;  // Remove this line if this parameter is used.
   2617            return;
   \   000000   02....       LJMP    ?BRET
   2618          }
   2619          
   2620          /******************************************************************************
   2621           * @fn          ZDApp_NwkWriteNVRequest (stubs AddrMgrWriteNVRequest)
   2622           *
   2623           * @brief       Stub routine implemented by NHLE. NHLE should call
   2624           *              <AddrMgrWriteNV> when appropriate.
   2625           *
   2626           * @param       none
   2627           *
   2628           * @return      none
   2629           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2630          void ZDApp_NwkWriteNVRequest( void )
   \                     AddrMgrWriteNVRequest:
   2631          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2632          #if defined ( NV_RESTORE )  
   2633            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   2634            {
   2635              // Trigger to save info into NV
   2636              ZDApp_NVUpdate();
   2637            }
   2638          #endif
   2639          }
   \   000000   02....       LJMP    ?BRET
   2640          
   2641          /*********************************************************************
   2642           * Call Back Functions from Security  - API
   2643           */
   2644          
   2645           /*********************************************************************
   2646           * @fn          ZDO_UpdateDeviceIndication
   2647           *
   2648           * @brief       This function notifies the "Trust Center" of a
   2649           *              network when a device joins or leaves the network.
   2650           *
   2651           * @param       extAddr - pointer to 64 bit address of new device
   2652           * @param       status  - 0 if a new device joined securely
   2653           *                      - 1 if a new device joined un-securely
   2654           *                      - 2 if a device left the network
   2655           *
   2656           * @return      true if newly joined device should be allowed to
   2657           *                                              remain on network
   2658           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2659          ZStatus_t ZDO_UpdateDeviceIndication( uint8 *extAddr, uint8 status )
   \                     ZDO_UpdateDeviceIndication:
   2660          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2661            // can implement a network access policy based on the
   2662            // IEEE address of newly joining devices...
   2663            (void)extAddr;
   2664            (void)status;
   2665            
   2666            return ZSuccess;
   \   000000   02....       LJMP    ?Subroutine3 & 0xFFFF
   2667          }
   2668          
   2669          /*********************************************************************
   2670           * @fn          ZDApp_InMsgCB
   2671           *
   2672           * @brief       This function is called to pass up any message that is
   2673           *              not yet supported.  This allows for the developer to
   2674           *              support features themselves..
   2675           *
   2676           * @return      none
   2677           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2678          void ZDApp_InMsgCB( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_InMsgCB:
   2679          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2680            if ( inMsg->clusterID & ZDO_RESPONSE_BIT )
   \   000009   EE           MOV     A,R6
   \   00000A   240C         ADD     A,#0xc
   \   00000C   12....       LCALL   ??Subroutine46_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_89:
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   5480         ANL     A,#0x80
   \   000013   F9           MOV     R1,A
   \   000014   E4           CLR     A
   \   000015   7001         JNZ     ??ZDApp_InMsgCB_0
   \   000017   E9           MOV     A,R1
   \                     ??ZDApp_InMsgCB_0:
   \   000018   704B         JNZ     ??ZDApp_InMsgCB_1
   2681            {
   2682              // Handle the response message
   2683            }
   2684            else
   2685            {
   2686              // Handle the request message by sending a generic "not supported".
   2687              // Device Announce doesn't have a response.
   2688              if ( !(inMsg->wasBroadcast) && inMsg->clusterID != Device_annce )
   \   00001A   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_103:
   \   00001D   7046         JNZ     ??ZDApp_InMsgCB_1
   \   00001F   EE           MOV     A,R6
   \   000020   240C         ADD     A,#0xc
   \   000022   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_97:
   \   000025   6413         XRL     A,#0x13
   \   000027   7002         JNZ     ??ZDApp_InMsgCB_2
   \   000029   A3           INC     DPTR
   \   00002A   E0           MOVX    A,@DPTR
   \                     ??ZDApp_InMsgCB_2:
   \   00002B   6038         JZ      ??ZDApp_InMsgCB_1
   2689              {
   2690                ZDP_GenericRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZDP_NOT_SUPPORTED, 0,
   2691                                (uint16)(inMsg->clusterID | ZDO_RESPONSE_BIT), inMsg->SecurityUse );
   \   00002D                ; Setup parameters for call to function ZDP_GenericRsp
   \   00002D   12....       LCALL   ?Subroutine25 & 0xFFFF
   2692              }
   2693            }
   \                     ??CrossCallReturnLabel_33:
   \   000030   4480         ORL     A,#0x80
   \   000032   F5..         MOV     ?V0 + 1,A
   \   000034   78..         MOV     R0,#?V0 + 0
   \   000036   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000039   75..00       MOV     ?V0 + 0,#0x0
   \   00003C   75..00       MOV     ?V0 + 1,#0x0
   \   00003F   78..         MOV     R0,#?V0 + 0
   \   000041   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000044   EE           MOV     A,R6
   \   000045   240E         ADD     A,#0xe
   \   000047   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_98:
   \   00004A   FD           MOV     R5,A
   \   00004B   7C84         MOV     R4,#-0x7c
   \   00004D   EE           MOV     A,R6
   \   00004E   2402         ADD     A,#0x2
   \   000050   0A           INC     R2
   \   000051   0A           INC     R2
   \   000052   EF           MOV     A,R7
   \   000053   3400         ADDC    A,#0x0
   \   000055   FB           MOV     R3,A
   \   000056   EE           MOV     A,R6
   \   000057   240F         ADD     A,#0xf
   \   000059   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_99:
   \   00005C   F9           MOV     R1,A
   \   00005D   12....       LCALL   ??ZDP_GenericRsp?relay
   \   000060   7404         MOV     A,#0x4
   \   000062   12....       LCALL   ?DEALLOC_XSTACK8
   2694          }
   \                     ??ZDApp_InMsgCB_1:
   \   000065   02....       LJMP    ??Subroutine42_0 & 0xFFFF
   2695          
   2696          
   2697          /*********************************************************************
   2698           * @fn      ZDApp_ChangeMatchDescRespPermission()
   2699           *
   2700           * @brief   Changes the Match Descriptor Response permission.
   2701           *
   2702           * @param   endpoint - endpoint to allow responses
   2703           * @param   action - true to allow responses, false to not
   2704           *
   2705           * @return  none
   2706           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2707          void ZDApp_ChangeMatchDescRespPermission( uint8 endpoint, uint8 action )
   \                     ZDApp_ChangeMatchDescRespPermission:
   2708          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   2709            // Store the action
   2710            afSetMatch( endpoint, action );
   \   000005                ; Setup parameters for call to function afSetMatch
   \   000005   12....       LCALL   ??afSetMatch?relay
   2711          }
   \   000008   02....       LJMP    ??Subroutine43_0 & 0xFFFF
   2712          
   2713          /*********************************************************************
   2714           * @fn      ZDApp_NetworkInit()
   2715           *
   2716           * @brief   Used to start the network joining process
   2717           *
   2718           * @param   delay - mSec delay to wait before starting
   2719           *
   2720           * @return  none
   2721           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2722          void ZDApp_NetworkInit( uint16 delay )
   \                     ZDApp_NetworkInit:
   2723          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2724            if ( delay )
   \   000004   EA           MOV     A,R2
   \   000005   7001         JNZ     ??ZDApp_NetworkInit_0
   \   000007   EB           MOV     A,R3
   \                     ??ZDApp_NetworkInit_0:
   \   000008   600B         JZ      ??ZDApp_NetworkInit_1
   2725            {
   2726              // Wait awhile before starting the device
   2727              osal_start_timerEx( ZDAppTaskID, ZDO_NETWORK_INIT, delay );
   \   00000A                ; Setup parameters for call to function osal_start_timerEx
   \   00000A   EA           MOV     A,R2
   \   00000B   FC           MOV     R4,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FD           MOV     R5,A
   \   00000E   7A01         MOV     R2,#0x1
   \   000010   12....       LCALL   ?Subroutine19 & 0xFFFF
   2728            }
   \                     ??CrossCallReturnLabel_73:
   \   000013   8005         SJMP    ??CrossCallReturnLabel_55
   2729            else
   2730            {
   2731              osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \                     ??ZDApp_NetworkInit_1:
   \   000015                ; Setup parameters for call to function osal_set_event
   \   000015   7A01         MOV     R2,#0x1
   \   000017   12....       LCALL   ??Subroutine35_0 & 0xFFFF
   2732            }
   2733          }
   \                     ??CrossCallReturnLabel_55:
   \   00001A   02....       LJMP    ?Subroutine2 & 0xFFFF
   2734          
   2735          /*********************************************************************
   2736           * @fn      ZDApp_NwkStateUpdateCB()
   2737           *
   2738           * @brief   This function notifies that this device's network 
   2739           *          state info has been changed.
   2740           *
   2741           * @param   none
   2742           *
   2743           * @return  none
   2744           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2745          void ZDApp_NwkStateUpdateCB( void )
   \                     ZDApp_NwkStateUpdateCB:
   2746          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2747            // Notify to save info into NV
   2748            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   \   000004                ; Setup parameters for call to function osal_get_timeoutEx
   \   000004   7A00         MOV     R2,#0x0
   \   000006   7B02         MOV     R3,#0x2
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_get_timeoutEx?relay
   2749            {
   2750              // Trigger to save info into NV
   2751              ZDApp_NVUpdate();
   2752            }
   2753          }
   \   000010   02....       LJMP    ?Subroutine2 & 0xFFFF
   2754          
   2755          /*********************************************************************
   2756           * @fn      ZDApp_NodeProfileSync()
   2757           *
   2758           * @brief   Sync node with stack profile.
   2759           *
   2760           * @param   stackProfile - stack profile of the network to join
   2761           *
   2762           * @return  none
   2763           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2764          void ZDApp_NodeProfileSync( uint8 stackProfile )
   \                     ZDApp_NodeProfileSync:
   2765          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   2766            if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_DEVICETYPE_FFD  )
   \   000007   90....       MOV     DPTR,#(ZDO_Config_Node_Descriptor + 2)
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   501A         JNC     ??ZDApp_NodeProfileSync_0
   2767            {
   2768              if ( stackProfile != zgStackProfile )
   \   00000F   90....       MOV     DPTR,#zgStackProfile
   \   000012   E0           MOVX    A,@DPTR
   \   000013   6E           XRL     A,R6
   \   000014   6013         JZ      ??ZDApp_NodeProfileSync_0
   2769              {
   2770                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   000016   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   54F8         ANL     A,#0xf8
   \   00001C   4402         ORL     A,#0x2
   \   00001E   F0           MOVX    @DPTR,A
   2771                ZDO_Config_Node_Descriptor.CapabilityFlags = CAPINFO_DEVICETYPE_RFD | CAPINFO_POWER_AC | CAPINFO_RCVR_ON_IDLE;
   \   00001F   740C         MOV     A,#0xc
   \   000021   90....       MOV     DPTR,#(ZDO_Config_Node_Descriptor + 2)
   \   000024   F0           MOVX    @DPTR,A
   2772                NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \   000025                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   000025   F9           MOV     R1,A
   \   000026   12....       LCALL   ??NLME_SetBroadcastFilter?relay
   2773              }
   2774            }
   2775          }
   \                     ??ZDApp_NodeProfileSync_0:
   \   000029   02....       LJMP    ??Subroutine43_0 & 0xFFFF
   2776          
   2777          /*********************************************************************
   2778           * @fn      ZDApp_StartJoiningCycle()
   2779           *
   2780           * @brief   Starts the joining cycle of a device.  This will only 
   2781           *          continue an already started (or stopped) joining cycle.
   2782           *
   2783           * @param   none
   2784           *
   2785           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2786           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2787          uint8 ZDApp_StartJoiningCycle( void )
   \                     ZDApp_StartJoiningCycle:
   2788          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2789            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StartJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7011         JNZ     ??ZDApp_StartJoiningCycle_1
   2790            {
   2791              continueJoining = TRUE;
   \                     ??ZDApp_StartJoiningCycle_0:
   \   000011   7401         MOV     A,#0x1
   \   000013   90....       MOV     DPTR,#continueJoining
   \   000016   F0           MOVX    @DPTR,A
   2792              ZDApp_NetworkInit( 0 );
   \   000017                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000017   7A00         MOV     R2,#0x0
   \   000019   7B00         MOV     R3,#0x0
   \   00001B   12....       LCALL   ??ZDApp_NetworkInit?relay
   2793          
   2794              return ( TRUE );
   \   00001E   7901         MOV     R1,#0x1
   \   000020   8002         SJMP    ??ZDApp_StartJoiningCycle_2
   2795            }
   2796            else
   2797              return ( FALSE );
   \                     ??ZDApp_StartJoiningCycle_1:
   \   000022   7900         MOV     R1,#0x0
   \                     ??ZDApp_StartJoiningCycle_2:
   \   000024   02....       LJMP    ?Subroutine2 & 0xFFFF
   2798          }
   2799          
   2800          /*********************************************************************
   2801           * @fn      ZDApp_StopJoiningCycle()
   2802           *
   2803           * @brief   Stops the joining or rejoining process of a device.
   2804           *
   2805           * @param   none
   2806           *
   2807           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2808           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2809          uint8 ZDApp_StopJoiningCycle( void )
   \                     ZDApp_StopJoiningCycle:
   2810          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2811            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StopJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7009         JNZ     ??ZDApp_StopJoiningCycle_1
   2812            {
   2813              continueJoining = FALSE;
   \                     ??ZDApp_StopJoiningCycle_0:
   \   000011   E4           CLR     A
   \   000012   90....       MOV     DPTR,#continueJoining
   \   000015   F0           MOVX    @DPTR,A
   2814              return ( TRUE );
   \   000016   7901         MOV     R1,#0x1
   \   000018   8002         SJMP    ??ZDApp_StopJoiningCycle_2
   2815            }
   2816            else
   2817              return ( FALSE );
   \                     ??ZDApp_StopJoiningCycle_1:
   \   00001A   7900         MOV     R1,#0x0
   \                     ??ZDApp_StopJoiningCycle_2:
   \   00001C   02....       LJMP    ?Subroutine2 & 0xFFFF
   2818          }
   2819          
   2820          /*********************************************************************
   2821           * @fn      ZDApp_AnnounceNewAddress()
   2822           *
   2823           * @brief   Send Device Announce and hold all transmissions for 
   2824           *          new address timeout.
   2825           *
   2826           * @param   none
   2827           *
   2828           * @return  none
   2829           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2830          void ZDApp_AnnounceNewAddress( void )
   \                     ZDApp_AnnounceNewAddress:
   2831          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2832          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2833            // Turn off data request hold
   2834            APSME_HoldDataRequests( 0 );
   \   000005                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000005   7A00         MOV     R2,#0x0
   \   000007   7B00         MOV     R3,#0x0
   \   000009   12....       LCALL   ??APSME_HoldDataRequests?relay
   2835          #endif
   2836            
   2837            ZDP_DeviceAnnce( NLME_GetShortAddr(), NLME_GetExtAddr(),
   2838                               ZDO_Config_Node_Descriptor.CapabilityFlags, 0 );
   \   00000C                ; Setup parameters for call to function NLME_GetExtAddr
   \   00000C   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000F   8A..         MOV     ?V0 + 0,R2
   \   000011   8B..         MOV     ?V0 + 1,R3
   \   000013   AE..         MOV     R6,?V0 + 0
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   000018   75..00       MOV     ?V0 + 0,#0x0
   \   00001B   78..         MOV     R0,#?V0 + 0
   \   00001D   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000020   90....       MOV     DPTR,#(ZDO_Config_Node_Descriptor + 2)
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F9           MOV     R1,A
   \   000025   EE           MOV     A,R6
   \   000026   FC           MOV     R4,A
   \   000027   AD..         MOV     R5,?V0 + 1
   \   000029   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   00002C   7401         MOV     A,#0x1
   \   00002E   12....       LCALL   ?DEALLOC_XSTACK8
   2839            
   2840          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2841            // Setup the timeout
   2842            APSME_HoldDataRequests( ZDAPP_HOLD_DATA_REQUESTS_TIMEOUT );
   \   000031                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000031   7A00         MOV     R2,#0x0
   \   000033   7B00         MOV     R3,#0x0
   \   000035   12....       LCALL   ??APSME_HoldDataRequests?relay
   2843          #endif  
   2844          }
   \   000038   02....       LJMP    ??Subroutine42_0 & 0xFFFF
   2845          
   2846          /*********************************************************************
   2847           * @fn          ZDApp_NVUpdate
   2848           *
   2849           * @brief       Set the NV Update Timer.
   2850           *
   2851           * @param       none
   2852           *
   2853           * @return      none
   2854           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2855          void ZDApp_NVUpdate( void )
   \                     ZDApp_NVUpdate:
   2856          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2857          #if defined ( NV_RESTORE )
   2858            osal_start_timerEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV, ZDAPP_UPDATE_NWK_NV_TIME );
   2859          #endif
   2860          }
   \   000000   02....       LJMP    ?BRET
   2861          
   2862          /*********************************************************************
   2863           * @fn      ZDApp_CoordStartPANIDConflictCB()
   2864           *
   2865           * @brief   Returns a PAN ID for the network layer to use during
   2866           *          a coordinator start and there is another network with 
   2867           *          the intended PANID.
   2868           *
   2869           * @param   panid - the intended PAN ID
   2870           *
   2871           * @return  PANID to try
   2872           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2873          uint16 ZDApp_CoordStartPANIDConflictCB( uint16 panid )
   \                     ZDApp_CoordStartPANIDConflictCB:
   2874          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2875            return ( panid + 1 );
   \   000000   7401         MOV     A,#0x1
   \   000002   2A           ADD     A,R2
   \   000003   0A           INC     R2
   \   000004   E4           CLR     A
   \   000005   3B           ADDC    A,R3
   \   000006   FB           MOV     R3,A
   \   000007   02....       LJMP    ?BRET
   2876          }
   2877          
   2878          /*********************************************************************
   2879           * @fn          ZDO_SrcRtgIndCB
   2880           *
   2881           * @brief       This function notifies the ZDO available src route record received.
   2882           *
   2883           * @param       srcAddr - source address of the source route
   2884           * @param       relayCnt - number of devices in the relay list
   2885           * @param       relayList - relay list of the source route
   2886           *
   2887           * @return      none
   2888           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2889          void ZDO_SrcRtgIndCB (uint16 srcAddr, uint8 relayCnt, uint16* pRelayList )
   \                     ZDO_SrcRtgIndCB:
   2890          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   2891            zdoSrcRtg_t srcRtg;
   2892            
   2893            srcRtg.srcAddr = srcAddr;
   \   00000A   12....       LCALL   ?Subroutine10 & 0xFFFF
   2894            srcRtg.relayCnt = relayCnt;
   \                     ??CrossCallReturnLabel_110:
   \   00000D   7402         MOV     A,#0x2
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   E9           MOV     A,R1
   \   000013   F0           MOVX    @DPTR,A
   2895            srcRtg.pRelayList = pRelayList;
   \   000014   7403         MOV     A,#0x3
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   EC           MOV     A,R4
   \   00001A   F0           MOVX    @DPTR,A
   \   00001B   A3           INC     DPTR
   \   00001C   ED           MOV     A,R5
   \   00001D   F0           MOVX    @DPTR,A
   2896            
   2897            if( zdoCBFunc[ZDO_SRC_RTG_IND_CBID] != NULL )
   \   00001E   90....       MOV     DPTR,#zdoCBFunc
   \   000021   E0           MOVX    A,@DPTR
   \   000022   7002         JNZ     ??ZDO_SrcRtgIndCB_0
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \                     ??ZDO_SrcRtgIndCB_0:
   \   000026   6013         JZ      ??ZDO_SrcRtgIndCB_1
   2898            {
   2899              zdoCBFunc[ZDO_SRC_RTG_IND_CBID]( (void*)&srcRtg );
   \   000028                ; Setup parameters for indirect call
   \   000028   85..82       MOV     DPL,?XSP + 0
   \   00002B   85..83       MOV     DPH,?XSP + 1
   \   00002E   AA82         MOV     R2,DPL
   \   000030   AB83         MOV     R3,DPH
   \   000032   90....       MOV     DPTR,#zdoCBFunc
   \   000035   12....       LCALL   ?Subroutine12 & 0xFFFF
   2900            }
   \                     ??CrossCallReturnLabel_14:
   \   000038   12....       LCALL   ?CALL_IND
   2901          }
   \                     ??ZDO_SrcRtgIndCB_1:
   \   00003B   02....       LJMP    ?Subroutine6 & 0xFFFF
   2902          
   2903          /*********************************************************************
   2904           * @fn          ZDApp_InitZdoCBFunc
   2905           *
   2906           * @brief       Call this function to initialize zdoCBFunc[]
   2907           *
   2908           * @param       none
   2909           *
   2910           * @return      none
   2911           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2912          void ZDApp_InitZdoCBFunc( void )
   \                     ZDApp_InitZdoCBFunc:
   2913          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2914            uint8 i;
   2915            
   2916            for ( i=0; i< MAX_ZDO_CB_FUNC; i++ )
   \   000004   7A00         MOV     R2,#0x0
   2917            {
   2918              zdoCBFunc[i] = NULL;
   \                     ??ZDApp_InitZdoCBFunc_0:
   \   000006   12....       LCALL   ?Subroutine31 & 0xFFFF
   2919            }
   \                     ??CrossCallReturnLabel_40:
   \   000009   0A           INC     R2
   \   00000A   EA           MOV     A,R2
   \   00000B   C3           CLR     C
   \   00000C   9405         SUBB    A,#0x5
   \   00000E   40F6         JC      ??ZDApp_InitZdoCBFunc_0
   2920          }
   \   000010   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine31:
   \   000000   EA           MOV     A,R2
   \   000001   12....       LCALL   ?Subroutine34 & 0xFFFF
   \                     ??CrossCallReturnLabel_47:
   \   000004   E4           CLR     A
   \   000005   F0           MOVX    @DPTR,A
   \   000006   A3           INC     DPTR
   \   000007   F0           MOVX    @DPTR,A
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine34:
   \   000000   C3           CLR     C
   \   000001   33           RLC     A
   \   000002   F8           MOV     R0,A
   \   000003   E4           CLR     A
   \   000004   33           RLC     A
   \   000005   F9           MOV     R1,A
   \   000006   E8           MOV     A,R0
   \   000007   24..         ADD     A,#(zdoCBFunc & 0xff)
   \   000009   F582         MOV     DPL,A
   \   00000B   E9           MOV     A,R1
   \   00000C   34..         ADDC    A,#((zdoCBFunc >> 8) & 0xff)
   \   00000E   F583         MOV     DPH,A
   \   000010   22           RET
   2921          
   2922          /*********************************************************************
   2923           * @fn          ZDO_RegisterForZdoCB
   2924           *
   2925           * @brief       Call this function to register the higher layer (for 
   2926           *              example, the Application layer or MT layer) with ZDO 
   2927           *              callbacks to get notified of some ZDO indication like
   2928           *              existence of a concentrator or receipt of a source 
   2929           *              route record.
   2930           *
   2931           * @param       indID - ZDO Indication ID
   2932           * @param       pFn   - Callback function pointer
   2933           *
   2934           * @return      ZSuccess - successful, ZInvalidParameter if not
   2935           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2936          ZStatus_t ZDO_RegisterForZdoCB( uint8 indID, pfnZdoCb pFn )
   \                     ZDO_RegisterForZdoCB:
   2937          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FC           MOV     R4,A
   2938            // Check the range of the indication ID
   2939            if ( indID < MAX_ZDO_CB_FUNC )
   \   000006   C3           CLR     C
   \   000007   9405         SUBB    A,#0x5
   \   000009   500B         JNC     ??ZDO_RegisterForZdoCB_0
   2940            {
   2941              zdoCBFunc[indID] = pFn;
   \   00000B   EC           MOV     A,R4
   \   00000C   12....       LCALL   ?Subroutine34 & 0xFFFF
   \                     ??CrossCallReturnLabel_46:
   \   00000F   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   2942              return ZSuccess;
   \                     ??CrossCallReturnLabel_107:
   \   000012   7900         MOV     R1,#0x0
   \   000014   8002         SJMP    ??ZDO_RegisterForZdoCB_1
   2943            }
   2944            
   2945            return ZInvalidParameter;
   \                     ??ZDO_RegisterForZdoCB_0:
   \   000016   7902         MOV     R1,#0x2
   \                     ??ZDO_RegisterForZdoCB_1:
   \   000018   02....       LJMP    ?Subroutine2 & 0xFFFF
   2946          }
   2947          
   2948          /*********************************************************************
   2949           * @fn          ZDO_DeregisterForZdoCB
   2950           *
   2951           * @brief       Call this function to de-register the higher layer (for 
   2952           *              example, the Application layer or MT layer) with ZDO 
   2953           *              callbacks to get notified of some ZDO indication like
   2954           *              existence of a concentrator or receipt of a source 
   2955           *              route record.
   2956           *
   2957           * @param       indID - ZDO Indication ID
   2958           *
   2959           * @return      ZSuccess - successful, ZInvalidParameter if not
   2960           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2961          ZStatus_t ZDO_DeregisterForZdoCB( uint8 indID )
   \                     ZDO_DeregisterForZdoCB:
   2962          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FA           MOV     R2,A
   2963            // Check the range of the indication ID
   2964            if ( indID < MAX_ZDO_CB_FUNC )
   \   000006   C3           CLR     C
   \   000007   9405         SUBB    A,#0x5
   \   000009   5006         JNC     ??ZDO_DeregisterForZdoCB_0
   2965            {
   2966              zdoCBFunc[indID] = NULL;
   \   00000B   12....       LCALL   ?Subroutine31 & 0xFFFF
   2967              return ZSuccess;
   \                     ??CrossCallReturnLabel_41:
   \   00000E   F9           MOV     R1,A
   \   00000F   8002         SJMP    ??ZDO_DeregisterForZdoCB_1
   2968            }
   2969            
   2970            return ZInvalidParameter;
   \                     ??ZDO_DeregisterForZdoCB_0:
   \   000011   7902         MOV     R1,#0x2
   \                     ??ZDO_DeregisterForZdoCB_1:
   \   000013   02....       LJMP    ?Subroutine2 & 0xFFFF
   2971          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F9           MOV     R1,A
   \   000002   EE           MOV     A,R6
   \   000003   2402         ADD     A,#0x2
   \   000005   FA           MOV     R2,A
   \   000006   EF           MOV     A,R7
   \   000007   3400         ADDC    A,#0x0
   \   000009   FB           MOV     R3,A
   \   00000A   12....       LCALL   ??NLME_RemoveChild?relay
   \   00000D   22           RET

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zdoDiscCounter>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for continueJoining>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for devState>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for devStartMode>`:
   \   000000   02           DB 2

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_epDesc>`:
   \   000000   00           DB 0
   \   000001   ....0000     DW ZDAppTaskID, 0H
   \   000005   00           DB 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_SavedPollRate>`:
   \   000000   E803         DW 1000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_1:
   \   000000   01000000     DD 1

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_0:
   \   000000   00000000     DD 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SecInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SecInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_event_loop?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDOInitDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDOInitDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ReadNetworkRestoreState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ReadNetworkRestoreState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppDetermineDeviceType?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppDetermineDeviceType

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkStartEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkStartEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_DeviceAuthEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_DeviceAuthEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNetworkStateEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNetworkStateEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNetworkState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNetworkState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitUserDesc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitUserDesc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppCheckForHoldKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppCheckForHoldKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessOSALMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessOSALMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessMsgCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessMsgCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RegisterCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RegisterCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessNetworkJoin?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessNetworkJoin

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerStart?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerStart

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerCancel?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerCancel

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlSet?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlSet

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlBypass?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlBypass

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlStartup?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlStartup

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkDiscoveryReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkDiscoveryReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_JoinReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_JoinReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendEventMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendEventMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkDiscoveryConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkDiscoveryConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkDescListProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkDescListProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkFormationConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkFormationConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_beaconNotifyIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_beaconNotifyIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_StartRouterConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_StartRouterConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_AddrChangeIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_AddrChangeIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ConcentratorIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ConcentratorIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveCnf?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveCnf

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveInd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveInd

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SyncIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SyncIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ManytoOneFailureIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ManytoOneFailureIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_PollConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_PollConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AddrMgrWriteNVRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AddrMgrWriteNVRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_UpdateDeviceIndication?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_UpdateDeviceIndication

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InMsgCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InMsgCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ChangeMatchDescRespPermission?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ChangeMatchDescRespPermission

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkStateUpdateCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkStateUpdateCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NodeProfileSync?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NodeProfileSync

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StartJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StartJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StopJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StopJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_AnnounceNewAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_AnnounceNewAddress

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NVUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NVUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_CoordStartPANIDConflictCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_CoordStartPANIDConflictCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SrcRtgIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SrcRtgIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitZdoCBFunc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitZdoCBFunc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_RegisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_RegisterForZdoCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_DeregisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_DeregisterForZdoCB
   2972          
   2973          /*********************************************************************
   2974          *********************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     AddrMgrWriteNVRequest              0      0      0
     ZDAppCheckForHoldKey               2      0      9
       -> HalKeyRead                    4      0      0
     ZDAppDetermineDeviceType           2      0     12
       -> nwk_ExtPANIDValid             4      0      0
     ZDApp_AnnounceNewAddress           0      0     23
       -> APSME_HoldDataRequests        0      0     20
       -> NLME_GetExtAddr               0      0     20
       -> NLME_GetShortAddr             0      0     20
       -> ZDP_DeviceAnnce               0      0     22
       -> APSME_HoldDataRequests        0      0     20
     ZDApp_ChangeMatchDescRespPermission
                                        0      0      9
       -> afSetMatch                    0      0     18
     ZDApp_CoordStartPANIDConflictCB
                                        0      0      0
     ZDApp_DeviceAuthEvt                2      0      9
       -> ZDApp_ResetTimerCancel        4      0      0
       -> osal_set_event                4      0      0
       -> NLME_StartRouterRequest       4      0      0
       -> ZDApp_SaveNwkKey              4      0      0
       -> ZDApp_AnnounceNewAddress      4      0      0
       -> NLME_SetPollRate              4      0      0
     ZDApp_InMsgCB                      0      0     14
       -> ZDP_GenericRsp                0      0     28
     ZDApp_Init                         0      0      9
       -> NLME_GetExtAddr               0      0     18
       -> ZDAppCheckForHoldKey          0      0     18
       -> ZDO_Init                      0      0     18
       -> afRegister                    0      0     18
       -> ZDApp_InitUserDesc            0      0     18
       -> ZDOInitDevice                 0      0     18
       -> ZDOInitDevice                 0      0     18
       -> HalLedBlink                   0      0     18
       -> ZDApp_InitZdoCBFunc           0      0     18
       -> ZDApp_RegisterCBs             0      0     18
     ZDApp_InitUserDesc                 0      0     40
       -> osal_memset                   0      0     54
       -> osal_nv_item_init             0      0     58
       -> osal_nv_read                  0      0     62
     ZDApp_InitZdoCBFunc                2      0      9
     ZDApp_JoinReq                      0      0     22
       -> ZDApp_NodeProfileSync         0      0     28
       -> NLME_JoinRequest              0      0     36
     ZDApp_LeaveCtrlBypass              2      0      0
     ZDApp_LeaveCtrlInit                0      0     26
       -> osal_nv_item_init             0      0     24
       -> osal_nv_read                  0      0     28
     ZDApp_LeaveCtrlSet                 0      0     23
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveCtrlStartup             1      0     26
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveReset                   0      0     21
       -> ZDApp_LeaveCtrlSet            0      0     18
       -> ZDApp_ResetTimerStart         0      0     18
     ZDApp_LeaveUpdate                  0      0      9
       -> NLME_RemoveChild              0      0     18
     ZDApp_NVUpdate                     0      0      0
     ZDApp_NetworkDiscoveryReq          0      0     12
       -> NLME_NetworkDiscoveryRequest
                                        0      0     24
     ZDApp_NetworkInit                  2      0     12
       -> osal_start_timerEx            4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NetworkStartEvt              2      0     10
       -> osal_pwrmgr_device            4      0      0
       -> osal_set_event                4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_SetEnergyThreshold       4      0      0
       -> osal_set_event                4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NodeProfileSync              0      0     23
       -> NLME_SetBroadcastFilter       0      0     18
     ZDApp_NwkDescListProcessing        0      0     14
       -> nwk_getNwkDescList            0      0     28
       -> nwk_getNwkDescList            0      0     28
       -> nwk_ExtPANIDValid             0      0     28
       -> sAddrExtCmp                   0      0     28
     ZDApp_NwkStateUpdateCB             2      0      0
       -> osal_get_timeoutEx            4      0      0
     ZDApp_ProcessMsgCBs                0      0     54
       -> ZDO_ParseAddrRsp              0      0    108
       -> ZDO_UpdateAddrManager         0      0    108
       -> osal_mem_free                 0      0    108
       -> ZDO_ParseBindUnbindReq        0      0    108
       -> ZDO_ProcessBindUnbindReq      0      0    108
       -> ZDMatchSendState              0      0    108
       -> ZDO_ParseEndDeviceBindReq     0      0    108
       -> ZDO_MatchEndDeviceBind        0      0    108
       -> osal_mem_free                 0      0    108
       -> osal_mem_free                 0      0    108
     ZDApp_ProcessNetworkJoin           0      0     12
       -> osal_set_event                0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> NLME_StartRouterRequest       0      0     24
       -> NLME_GetShortAddr             0      0     24
       -> ZMacSetReq                    0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> osal_set_event                0      0     24
       -> NLME_SetPollRate              0      0     24
       -> NLME_SetQueuedPollRate        0      0     24
       -> NLME_SetResponseRate          0      0     24
       -> NLME_StartRouterRequest       0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> osal_set_event                0      0     24
     ZDApp_ProcessOSALMsg               2      0     10
       -> ZDP_IncomingData              4      0      0
       -> ZDApp_ProcessMsgCBs           4      0      0
     ZDApp_ProcessSecEvent              0      0      9
       -> ZDSecMgrNewDeviceEvent        0      0     18
       -> osal_start_timerEx            0      0     18
       -> ZDApp_DeviceAuthEvt           0      0     18
       -> ZDApp_SaveNwkKey              0      0     18
       -> ZDSecMgrSaveTCLinkKey         0      0     18
     ZDApp_ProcessSecMsg                2      0      0
       -> ZDSecMgrUpdateDeviceInd       4      0      0
     ZDApp_ReadNetworkRestoreState      0      0      9
       -> zgReadStartupOptions          0      0     18
     ZDApp_RegisterCBs                  2      0      9
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
     ZDApp_ResetNwkKey                  0      0     35
       -> osal_memset                   0      0     62
       -> osal_nv_write                 0      0     70
     ZDApp_ResetTimerCancel             2      0      0
       -> osal_stop_timerEx             4      0      0
     ZDApp_ResetTimerStart              2      0      9
       -> osal_start_timerEx            4      0      0
     ZDApp_RestoreNetworkState          0      0      9
       -> NLME_InitNV                   0      0     18
       -> NLME_RestoreFromNV            0      0     18
       -> NLME_GetShortAddr             0      0     18
       -> sAddrExtCpy                   0      0     18
     ZDApp_RestoreNwkKey                2      0     37
       -> osal_nv_read                  0      0     74
       -> osal_memset                   0      0     66
     ZDApp_SaveNetworkStateEvt          0      0      0
     ZDApp_SaveNwkKey                   0      0     46
       -> SSP_ReadNwkActiveKey          0      0     66
       -> osal_nv_write                 0      0     74
       -> osal_memset                   0      0     66
     ZDApp_SecInit                      0      0      9
       -> ZDSecMgrInit                  0      0     18
     ZDApp_SendEventMsg                 0      0      9
       -> ZDApp_SendMsg                 0      0     18
     ZDApp_SendMsg                      1      0     33
       -> osal_msg_allocate             0      0     32
       -> osal_memcpy                   0      0     38
       -> osal_msg_send                 0      0     32
     ZDApp_StartJoiningCycle            2      0      0
       -> ZDApp_NetworkInit             4      0      0
     ZDApp_StopJoiningCycle             2      0      0
     ZDApp_event_loop                   0      0     10
       -> ZDO_StartDevice               0      0     20
       -> ZDApp_ProcessOSALMsg          0      0     20
       -> osal_msg_deallocate           0      0     20
       -> osal_msg_receive              0      0     20
       -> ZDApp_NetworkStartEvt         0      0     20
       -> osal_pwrmgr_device            0      0     20
       -> osal_set_event                0      0     20
       -> ZDO_UpdateNwkStatus           0      0     20
       -> osal_start_timerEx            0      0     20
       -> Onboard_soft_reset            0      0     20
     ZDOInitDevice                      0      0     21
       -> zgInitItems                   0      0     24
       -> ZDConfig_InitDescriptors      0      0     24
       -> ZDAppDetermineDeviceType      0      0     24
       -> osal_rand                     0      0     24
       -> ZDSecMgrInit                  0      0     24
       -> ZDApp_LeaveCtrlInit           0      0     24
       -> ZDApp_LeaveCtrlStartup        0      0     24
       -> zgWriteStartupOptions         0      0     24
       -> osal_set_event                0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> NLME_SetBroadcastFilter       0      0     24
     ZDO_AddrChangeIndicationCB         2      0      0
       -> osal_set_event                4      0      0
       -> ZDApp_AnnounceNewAddress      4      0      0
     ZDO_ConcentratorIndicationCB       1      0     14
     ZDO_DeregisterForZdoCB             2      0      0
     ZDO_JoinConfirmCB                  1      0     14
       -> HalLedSet                     0      0     28
       -> HalLedSet                     0      0     28
       -> HalLedSet                     0      0     28
       -> ZDApp_SendMsg                 0      0     28
     ZDO_JoinIndicationCB               0      0      1
     ZDO_LeaveCnf                       0      0      9
       -> NLME_GetExtAddr               0      0     18
       -> sAddrExtCmp                   0      0     18
       -> ZDApp_LeaveReset              0      0     18
       -> NLME_RemoveChild              0      0     18
     ZDO_LeaveInd                       1      0     12
       -> NLME_LeaveRsp                 0      0     24
       -> ZDApp_LeaveReset              0      0     24
       -> NLME_GetCoordShortAddr        0      0     24
       -> ZDApp_LeaveReset              0      0     24
       -> NLME_RemoveChild              0      0     24
     ZDO_ManytoOneFailureIndicationCB
                                        2      0      0
       -> RTG_MTORouteReq               4      0      0
     ZDO_NetworkDiscoveryConfirmCB      3      0      3
       -> ZDApp_SendMsg                 4      0      6
     ZDO_NetworkFormationConfirmCB      0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_PollConfirmCB                  0      0      0
     ZDO_RegisterForZdoCB               2      0      0
     ZDO_SrcRtgIndCB                    1      0     14
     ZDO_StartRouterConfirmCB           0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_SyncIndicationCB               0      0      9
       -> nwkNeighborInitTable          0      0     18
       -> ZDApp_SendMsg                 0      0     18
     ZDO_UpdateDeviceIndication         0      0      0
     ZDO_beaconNotifyIndCB              1      0     14
       -> osal_mem_alloc                0      0     28
       -> osal_memset                   0      0     28
       -> sAddrExtCpy                   0      0     28
       -> osal_memset                   0      0     28


   Segment part sizes:

     Function/Label                              Bytes
     --------------                              -----
     MatchRsps                                      1
     zdoDiscCounter                                 1
     ZDAppNwkAddr                                   9
     zdappMgmtNwkDiscRspTransSeq                    1
     zdappMgmtNwkDiscReqInProgress                  1
     zdappMgmtNwkDiscRspAddr                        9
     zdappMgmtNwkDiscStartIndex                     1
     zdappMgmtSavedNwkState                         1
     nwkFrameCounterChanges                         2
     continueJoining                                1
     _tmpRejoinState                                1
     ZDO_UseExtendedPANID                           8
     zdoCBFunc                                     10
     ZDAppTaskID                                    1
     nwkStatus                                      1
     ZDApp_AutoFindMode_epDesc                      2
     ZDApp_LeaveCtrl                                1
     devState                                       1
     devStartMode                                   1
     retryCnt                                       1
     ZDApp_epDesc                                   6
     ZDApp_SavedPollRate                            2
     ZDApp_Init                                    89
     ??Subroutine43_0                               5
     ZDApp_SecInit                                 11
     ZDApp_event_loop                             217
     ?Subroutine13                                  2
     ??Subroutine35_0                              11
     ??Subroutine40_0                               6
     ??Subroutine42_0                               5
     ZDApp_ProcessSecEvent                        141
     ?Subroutine19                                  5
     ??Subroutine45_0                               6
     ??Subroutine50_0                               6
     ZDOInitDevice                                158
     ?Subroutine1                                   2
     ??Subroutine41_0                               3
     ?Subroutine10                                  6
     ZDApp_ReadNetworkRestoreState                 21
     ZDAppDetermineDeviceType                      74
     ?Subroutine2                                   7
     ZDApp_NetworkStartEvt                         81
     ZDApp_DeviceAuthEvt                           58
     ??Subroutine36_0                               6
     ?Subroutine18                                  9
     ?Subroutine7                                  19
     ZDApp_SaveNetworkStateEvt                      3
     ZDApp_RestoreNetworkState                     76
     ZDApp_InitUserDesc                            93
     ?Subroutine24                                 32
     ZDAppCheckForHoldKey                          20
     ZDApp_ProcessOSALMsg                          61
     ?Subroutine12                                  9
     ZDApp_ProcessMsgCBs                          252
     ?Subroutine22                                  1
     ?Subroutine27                                  3
     ??Subroutine46_0                               3
     ??Subroutine47_0                               5
     ??Subroutine48_0                               3
     ??Subroutine49_0                               6
     ?Subroutine25                                 16
     ZDApp_RegisterCBs                             48
     ?Subroutine14                                  2
     ??Subroutine37_0                               9
     ZDApp_ProcessSecMsg                           40
     ZDApp_ProcessNetworkJoin                     431
     ?Subroutine8                                  12
     ZDApp_SaveNwkKey                              99
     ?Subroutine4                                   5
     ??Subroutine38_0                               5
     ?Subroutine29                                  6
     ??Subroutine39_0                               8
     ZDApp_ResetNwkKey                             40
     ZDApp_RestoreNwkKey                          157
     ZDApp_ResetTimerStart                         16
     ZDApp_ResetTimerCancel                        19
     ZDApp_LeaveCtrlInit                           64
     ?Subroutine11                                 14
     ZDApp_LeaveCtrlSet                            52
     ZDApp_LeaveCtrlBypass                         17
     ZDApp_LeaveCtrlStartup                        74
     ZDApp_LeaveReset                              17
     ZDApp_LeaveUpdate                             14
     ZDApp_NetworkDiscoveryReq                     11
     ZDApp_JoinReq                                 84
     ?Subroutine5                                   5
     ZDApp_SendEventMsg                            16
     ?Subroutine20                                  9
     ZDApp_SendMsg                                 89
     ZDO_NetworkDiscoveryConfirmCB                 78
     ZDApp_NwkDescListProcessing                  279
     ?Subroutine23                                 10
     ??Subroutine44_0                               6
     ?Subroutine17                                  4
     ?Subroutine0                                   3
     ZDO_NetworkFormationConfirmCB                 34
     ?Subroutine28                                 19
     ZDO_beaconNotifyIndCB                        595
     ?Subroutine30                                  9
     ?Subroutine21                                  4
     ?Subroutine33                                 11
     ?Subroutine16                                  8
     ?Subroutine9                                   7
     ?Subroutine32                                  9
     ZDO_StartRouterConfirmCB                      34
     ZDO_JoinConfirmCB                            107
     ?Subroutine6                                   8
     ZDO_AddrChangeIndicationCB                    13
     ZDO_JoinIndicationCB                           0
     ?Subroutine3                                   5
     ZDO_ConcentratorIndicationCB                  61
     ZDO_LeaveCnf                                  61
     ?Subroutine26                                  3
     ZDO_LeaveInd                                 146
     ZDO_SyncIndicationCB                          37
     ZDO_ManytoOneFailureIndicationCB
                                                   10
     ZDO_PollConfirmCB                              3
     AddrMgrWriteNVRequest                          3
     ZDO_UpdateDeviceIndication                     3
     ZDApp_InMsgCB                                104
     ZDApp_ChangeMatchDescRespPermission
                                                   11
     ZDApp_NetworkInit                             29
     ZDApp_NwkStateUpdateCB                        19
     ZDApp_NodeProfileSync                         44
     ZDApp_StartJoiningCycle                       39
     ZDApp_StopJoiningCycle                        31
     ZDApp_AnnounceNewAddress                      59
     ZDApp_NVUpdate                                 3
     ZDApp_CoordStartPANIDConflictCB
                                                   10
     ZDO_SrcRtgIndCB                               62
     ZDApp_InitZdoCBFunc                           19
     ?Subroutine31                                  9
     ?Subroutine34                                 17
     ZDO_RegisterForZdoCB                          27
     ZDO_DeregisterForZdoCB                        22
     ?Subroutine15                                 14
     ?<Initializer for zdoDiscCounter>              1
     ?<Initializer for continueJoining>             1
     ?<Initializer for devState>                    1
     ?<Initializer for devStartMode>                1
     ?<Initializer for ZDApp_epDesc>                6
     ?<Initializer for ZDApp_SavedPollRate>         2
     __Constant_1                                   4
     __Constant_0                                   4
     __Constant_3e8                                 4
     ??ZDApp_Init?relay                             6
     ??ZDApp_SecInit?relay                          6
     ??ZDApp_event_loop?relay                       6
     ??ZDApp_ProcessSecEvent?relay                  6
     ??ZDOInitDevice?relay                          6
     ??ZDApp_ReadNetworkRestoreState?relay          6
     ??ZDAppDetermineDeviceType?relay               6
     ??ZDApp_NetworkStartEvt?relay                  6
     ??ZDApp_DeviceAuthEvt?relay                    6
     ??ZDApp_SaveNetworkStateEvt?relay              6
     ??ZDApp_RestoreNetworkState?relay              6
     ??ZDApp_InitUserDesc?relay                     6
     ??ZDAppCheckForHoldKey?relay                   6
     ??ZDApp_ProcessOSALMsg?relay                   6
     ??ZDApp_ProcessMsgCBs?relay                    6
     ??ZDApp_RegisterCBs?relay                      6
     ??ZDApp_ProcessSecMsg?relay                    6
     ??ZDApp_ProcessNetworkJoin?relay               6
     ??ZDApp_SaveNwkKey?relay                       6
     ??ZDApp_ResetNwkKey?relay                      6
     ??ZDApp_RestoreNwkKey?relay                    6
     ??ZDApp_ResetTimerStart?relay                  6
     ??ZDApp_ResetTimerCancel?relay                 6
     ??ZDApp_LeaveCtrlInit?relay                    6
     ??ZDApp_LeaveCtrlSet?relay                     6
     ??ZDApp_LeaveCtrlBypass?relay                  6
     ??ZDApp_LeaveCtrlStartup?relay                 6
     ??ZDApp_LeaveReset?relay                       6
     ??ZDApp_LeaveUpdate?relay                      6
     ??ZDApp_NetworkDiscoveryReq?relay              6
     ??ZDApp_JoinReq?relay                          6
     ??ZDApp_SendEventMsg?relay                     6
     ??ZDApp_SendMsg?relay                          6
     ??ZDO_NetworkDiscoveryConfirmCB?relay          6
     ??ZDApp_NwkDescListProcessing?relay            6
     ??ZDO_NetworkFormationConfirmCB?relay          6
     ??ZDO_beaconNotifyIndCB?relay                  6
     ??ZDO_StartRouterConfirmCB?relay               6
     ??ZDO_JoinConfirmCB?relay                      6
     ??ZDO_AddrChangeIndicationCB?relay             6
     ??ZDO_JoinIndicationCB?relay                   6
     ??ZDO_ConcentratorIndicationCB?relay           6
     ??ZDO_LeaveCnf?relay                           6
     ??ZDO_LeaveInd?relay                           6
     ??ZDO_SyncIndicationCB?relay                   6
     ??ZDO_ManytoOneFailureIndicationCB?relay       6
     ??ZDO_PollConfirmCB?relay                      6
     ??AddrMgrWriteNVRequest?relay                  6
     ??ZDO_UpdateDeviceIndication?relay             6
     ??ZDApp_InMsgCB?relay                          6
     ??ZDApp_ChangeMatchDescRespPermission?relay    6
     ??ZDApp_NetworkInit?relay                      6
     ??ZDApp_NwkStateUpdateCB?relay                 6
     ??ZDApp_NodeProfileSync?relay                  6
     ??ZDApp_StartJoiningCycle?relay                6
     ??ZDApp_StopJoiningCycle?relay                 6
     ??ZDApp_AnnounceNewAddress?relay               6
     ??ZDApp_NVUpdate?relay                         6
     ??ZDApp_CoordStartPANIDConflictCB?relay        6
     ??ZDO_SrcRtgIndCB?relay                        6
     ??ZDApp_InitZdoCBFunc?relay                    6
     ??ZDO_RegisterForZdoCB?relay                   6
     ??ZDO_DeregisterForZdoCB?relay                 6

 
 4 983 bytes in segment BANKED_CODE
   378 bytes in segment BANK_RELAYS
    12 bytes in segment XDATA_I
    12 bytes in segment XDATA_ID
    12 bytes in segment XDATA_ROM_C
    50 bytes in segment XDATA_Z
 
 5 373 bytes of CODE  memory
     0 bytes of CONST memory (+ 12 bytes shared)
    62 bytes of XDATA memory

Errors: none
Warnings: none
