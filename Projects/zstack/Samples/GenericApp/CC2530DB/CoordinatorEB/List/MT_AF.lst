###############################################################################
#                                                                             #
# IAR C/C++ Compiler V7.60.1.40026 for 8051             08/Apr/2014  22:18:29 #
# Copyright (C) 2004-2010 IAR Systems AB.                                     #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\zigbee\projects\zstack-cc2530-coordinator\Compo #
#                          nents\mt\MT_AF.c                                   #
#    Command line       =  -f D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \Tools\CC2530DB\f8wCoord.cfg (-DCPU32MHZ           #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8       #
#                          -DMAC_CFG_RX_MAX=5 -DZDO_COORDINATOR -DRTR_NWK)    #
#                          -f D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \Tools\CC2530DB\f8wConfig.cfg (-DZIGBEEPRO         #
#                          -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR       #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0x1111                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 D:\zigbee\projects\zstack-c #
#                          c2530-coordinator\Components\mt\MT_AF.c -D         #
#                          ZAPP_P1 -D MT_TASK -D MT_SYS_FUNC -D MT_ZDO_FUNC   #
#                          -D LCD_SUPPORTED=DEBUG -lC                         #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\Coordinator #
#                          EB\List\ -lA D:\zigbee\projects\zstack-cc2530-coor #
#                          dinator\Projects\zstack\Samples\GenericApp\CC2530D #
#                          B\CoordinatorEB\List\ --diag_suppress Pe001,Pa010  #
#                          -o D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\Coordina #
#                          torEB\Obj\ -e --require_prototypes                 #
#                          --no_code_motion --debug --core=plain --dptr=16,1  #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\ -I      #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\Source\  #
#                          -I D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \ZMain\TI2530DB\ -I D:\zigbee\projects\zstack-cc25 #
#                          30-coordinator\Projects\zstack\Samples\GenericApp\ #
#                          CC2530DB\..\..\..\..\..\Components\hal\include\    #
#                          -I D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \..\..\Components\hal\target\CC2530EB\ -I          #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\mac\include\ -I                     #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\mac\high_level\ -I                  #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\mac\low_level\srf04\ -I             #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\mac\low_level\srf04\single_chip\    #
#                          -I D:\zigbee\projects\zstack-cc2530-coordinator\Pr #
#                          ojects\zstack\Samples\GenericApp\CC2530DB\..\..\.. #
#                          \..\..\Components\mt\ -I                           #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\osal\include\ -I                    #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\osal\mcu\ccsoc\ -I                  #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\services\saddr\ -I                  #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\services\sdata\ -I                  #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\af\ -I                        #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\nwk\ -I                       #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\sapi\ -I                      #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\sec\ -I                       #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\sys\ -I                       #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\stack\zdo\ -I                       #
#                          D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\..\..\..\.. #
#                          \..\Components\zmac\ -I D:\zigbee\projects\zstack- #
#                          cc2530-coordinator\Projects\zstack\Samples\Generic #
#                          App\CC2530DB\..\..\..\..\..\Components\zmac\f8w\   #
#                          -I "C:\Program Files (x86)\IAR Systems\Embedded    #
#                          Workbench 5.4\8051\INC\" -I "C:\Program Files      #
#                          (x86)\IAR Systems\Embedded Workbench               #
#                          5.4\8051\INC\CLIB\" -Ohz                           #
#    List file          =  D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\Coordinator #
#                          EB\List\MT_AF.lst                                  #
#    Object file        =  D:\zigbee\projects\zstack-cc2530-coordinator\Proje #
#                          cts\zstack\Samples\GenericApp\CC2530DB\Coordinator #
#                          EB\Obj\MT_AF.r51                                   #
#                                                                             #
#                                                                             #
###############################################################################

D:\zigbee\projects\zstack-cc2530-coordinator\Components\mt\MT_AF.c
      1          /**************************************************************************************************
      2            Filename:       MT_AF.c
      3            Revised:        $Date: 2010-08-13 18:15:16 -0700 (Fri, 13 Aug 2010) $
      4            Revision:       $Revision: 23412 $
      5          
      6          
      7            Description:    MonitorTest functions for the AF layer.
      8          
      9          
     10            Copyright 2007-2010 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com.
     39          
     40          **************************************************************************************************/
     41          
     42          /***************************************************************************************************
     43           * INCLUDES
     44           ***************************************************************************************************/
     45          #include "ZComDef.h"
     46          #include "OSAL.h"
     47          #include "MT.h"
     48          #include "MT_AF.h"
     49          #include "MT_ZDO.h"
     50          #include "nwk.h"
     51          #include "OnBoard.h"
     52          #include "MT_UART.h"
     53          
     54          #if defined INTER_PAN
     55          #include "stub_aps.h"
     56          #endif
     57          
     58          /* ------------------------------------------------------------------------------------------------
     59           *                                          Constants
     60           * ------------------------------------------------------------------------------------------------
     61           */
     62          
     63          #if !defined MT_AF_EXEC_CNT
     64          #define MT_AF_EXEC_CNT  15
     65          #endif
     66          
     67          #if !defined MT_AF_EXEC_DLY
     68          #define MT_AF_EXEC_DLY  1000
     69          #endif
     70          
     71          /* ------------------------------------------------------------------------------------------------
     72           *                                           Typedefs
     73           * ------------------------------------------------------------------------------------------------
     74           */
     75          
     76          /*
     77          typedef struct
     78          {
     79            union
     80            {
     81              uint16      shortAddr;
     82              ZLongAddr_t extAddr;
     83            } addr;
     84            afAddrMode_t addrMode;
     85            byte endPoint;
     86            uint16 panId;  // used for the INTER_PAN feature
     87          } afAddrType_t;
     88          
     89          typedef struct
     90          {
     91            byte   TransSeqNumber;
     92            uint16 DataLength;               // Number of bytes in TransData
     93            byte  *Data;
     94          } afMSGCommandFormat_t;
     95           */
     96          
     97          typedef struct
     98          {
     99            uint8 *data;
    100            afAddrType_t dstAddr;
    101            endPointDesc_t *epDesc;
    102            uint16 cId;
    103            uint16 dataLen;
    104            uint8 transId;
    105            uint8 txOpts;
    106            uint8 radius;
    107            uint8 tick;
    108          } mtAfDataReq_t;
    109          
    110          struct _mtAfInMsgList_t
    111          {
    112            struct _mtAfInMsgList_t *next;
    113            uint8 *data;
    114            uint32 timestamp;         // Receipt timestamp from MAC.
    115            uint8 tick;
    116          };
    117          typedef struct _mtAfInMsgList_t mtAfInMsgList_t;
    118          
    119          /* ------------------------------------------------------------------------------------------------
    120           *                                        Local Variables
    121           * ------------------------------------------------------------------------------------------------
    122           */
    123          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    124          mtAfInMsgList_t *pMtAfInMsgList = NULL;
   \                     pMtAfInMsgList:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    125          mtAfDataReq_t *pMtAfDataReq = NULL;
   \                     pMtAfDataReq:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    126          
    127          /* ------------------------------------------------------------------------------------------------
    128           *                                        Global Variables
    129           * ------------------------------------------------------------------------------------------------
    130           */
    131          
    132          #if defined ( MT_AF_CB_FUNC )
    133          uint16 _afCallbackSub;
    134          #endif
    135          
    136          /* ------------------------------------------------------------------------------------------------
    137           *                                        Local Functions
    138           * ------------------------------------------------------------------------------------------------
    139           */
    140          
    141          void MT_AfRegister(uint8 *pBuf);
    142          void MT_AfDataRequest(uint8 *pBuf);
    143          
    144          #if defined ( ZIGBEE_SOURCE_ROUTING )
    145          void MT_AfDataRequestSrcRtg(uint8 *pBuf);
    146          #endif
    147          
    148          #if defined INTER_PAN
    149          static void MT_AfInterPanCtl(uint8 *pBuf);
    150          #endif
    151          
    152          static void MT_AfDataRetrieve(uint8 *pBuf);
    153          static void MT_AfDataStore(uint8 *pBuf);
    154          
    155          /**************************************************************************************************
    156           * @fn          MT_AfExec
    157           *
    158           * @brief       This function is invoked by an MT timer event.
    159           *
    160           * input parameters
    161           *
    162           * None.
    163           *
    164           * output parameters
    165           *
    166           * None.
    167           *
    168           * @return      None.
    169           **************************************************************************************************
    170           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    171          void MT_AfExec(void)
   \                     MT_AfExec:
    172          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    173            mtAfInMsgList_t *pPrev, *pItem = pMtAfInMsgList;
   \                     ??MT_AfExec_0:
   \   000005   90....       MOV     DPTR,#pMtAfInMsgList
   \   000008   8008         SJMP    ??MT_AfExec_1
    174          
    175            while (pItem != NULL)
    176            {
    177              if (--(pItem->tick) == 0)
    178              {
    179                if (pMtAfInMsgList == pItem)
    180                {
    181                  pMtAfInMsgList = pItem->next;
    182                  (void)osal_mem_free(pItem);
    183                  pItem = pMtAfInMsgList;
    184                }
    185                else
    186                {
    187                  pPrev->next = pItem->next;
    188                  (void)osal_mem_free(pItem);
    189                  pItem = pPrev->next;
    190                }
    191              }
    192              else
    193              {
    194                pPrev = pItem;
   \                     ??MT_AfExec_2:
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    195                pItem = pItem->next;
   \   00000E   8A82         MOV     DPL,R2
   \   000010   8B83         MOV     DPH,R3
   \                     ??MT_AfExec_1:
   \   000012   E0           MOVX    A,@DPTR
   \   000013   FA           MOV     R2,A
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   FB           MOV     R3,A
    196              }
   \   000017   EA           MOV     A,R2
   \   000018   7001         JNZ     ??MT_AfExec_3
   \   00001A   EB           MOV     A,R3
   \                     ??MT_AfExec_3:
   \   00001B   6031         JZ      ??MT_AfExec_4
   \   00001D   EA           MOV     A,R2
   \   00001E   2408         ADD     A,#0x8
   \   000020   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_76:
   \   000023   14           DEC     A
   \   000024   F0           MOVX    @DPTR,A
   \   000025   70E3         JNZ     ??MT_AfExec_2
   \   000027   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_121:
   \   00002A   EA           MOV     A,R2
   \   00002B   68           XRL     A,R0
   \   00002C   7002         JNZ     ??MT_AfExec_5
   \   00002E   EB           MOV     A,R3
   \   00002F   69           XRL     A,R1
   \                     ??MT_AfExec_5:
   \   000030   8A82         MOV     DPL,R2
   \   000032   8B83         MOV     DPH,R3
   \   000034   7008         JNZ     ??MT_AfExec_6
   \   000036   12....       LCALL   ?Subroutine15 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   000039   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_55:
   \   00003C   80C7         SJMP    ??MT_AfExec_0
   \                     ??MT_AfExec_6:
   \   00003E   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_119:
   \   000041   8E82         MOV     DPL,R6
   \   000043   8F83         MOV     DPH,R7
   \   000045   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_56:
   \   000048   8E82         MOV     DPL,R6
   \   00004A   8F83         MOV     DPH,R7
   \   00004C   80C4         SJMP    ??MT_AfExec_1
    197            }
    198          
    199            if (pMtAfDataReq != NULL)
   \                     ??MT_AfExec_4:
   \   00004E   90....       MOV     DPTR,#pMtAfDataReq
   \   000051   E0           MOVX    A,@DPTR
   \   000052   7002         JNZ     ??MT_AfExec_7
   \   000054   A3           INC     DPTR
   \   000055   E0           MOVX    A,@DPTR
   \                     ??MT_AfExec_7:
   \   000056   600E         JZ      ??MT_AfExec_8
    200            {
    201              if (--(pMtAfDataReq->tick) == 0)
   \   000058   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_81:
   \   00005B   14           DEC     A
   \   00005C   F0           MOVX    @DPTR,A
   \   00005D   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_82:
   \   000060   7004         JNZ     ??MT_AfExec_8
    202              {
    203                (void)osal_mem_free(pMtAfDataReq);
   \   000062                ; Setup parameters for call to function osal_mem_free
   \   000062   12....       LCALL   ?Subroutine8 & 0xFFFF
    204                pMtAfDataReq = NULL;
    205              }
    206            }
   \                     ??CrossCallReturnLabel_7:
   \   000065   F0           MOVX    @DPTR,A
    207          
    208            if ((pMtAfInMsgList != NULL) || (pMtAfDataReq != NULL))
   \                     ??MT_AfExec_8:
   \   000066   90....       MOV     DPTR,#pMtAfInMsgList
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   7002         JNZ     ??MT_AfExec_9
   \   00006C   A3           INC     DPTR
   \   00006D   E0           MOVX    A,@DPTR
   \                     ??MT_AfExec_9:
   \   00006E   700A         JNZ     ??MT_AfExec_10
   \   000070   90....       MOV     DPTR,#pMtAfDataReq
   \   000073   E0           MOVX    A,@DPTR
   \   000074   7002         JNZ     ??MT_AfExec_11
   \   000076   A3           INC     DPTR
   \   000077   E0           MOVX    A,@DPTR
   \                     ??MT_AfExec_11:
   \   000078   6008         JZ      ??CrossCallReturnLabel_24
    209            {
    210              if (ZSuccess != osal_start_timerEx(MT_TaskID, MT_AF_EXEC_EVT, MT_AF_EXEC_DLY))
   \                     ??MT_AfExec_10:
   \   00007A                ; Setup parameters for call to function osal_start_timerEx
   \   00007A   12....       LCALL   ??Subroutine49_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_91:
   \   00007D   6003         JZ      ??CrossCallReturnLabel_24
    211              {
    212                osal_set_event(MT_TaskID, MT_AF_EXEC_EVT);
   \   00007F                ; Setup parameters for call to function osal_set_event
   \   00007F   12....       LCALL   ?Subroutine17 & 0xFFFF
    213              }
    214            }
    215          }
   \                     ??CrossCallReturnLabel_24:
   \   000082                REQUIRE ?Subroutine0
   \   000082                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine38:
   \   000000   F582         MOV     DPL,A
   \   000002   EB           MOV     A,R3
   \   000003                REQUIRE ??Subroutine45_0
   \   000003                ; // Fall through to label ??Subroutine45_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine45_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   E0           MOVX    A,@DPTR
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine30:
   \   000000   E8           MOV     A,R0
   \   000001   F0           MOVX    @DPTR,A
   \   000002   A3           INC     DPTR
   \   000003   E9           MOV     A,R1
   \   000004   F0           MOVX    @DPTR,A
   \   000005                ; Setup parameters for call to function osal_mem_free
   \   000005                ; Setup parameters for call to function osal_mem_free
   \   000005   12....       LCALL   ??osal_mem_free?relay
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   90....       MOV     DPTR,#pMtAfDataReq
   \   000003   E0           MOVX    A,@DPTR
   \   000004   2417         ADD     A,#0x17
   \   000006                REQUIRE ??Subroutine46_0
   \   000006                ; // Fall through to label ??Subroutine46_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine46_0:
   \   000000   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_133:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   7A08         MOV     R2,#0x8
   \   000002   7B00         MOV     R3,#0x0
   \   000004   90....       MOV     DPTR,#MT_TaskID
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F9           MOV     R1,A
   \   000009   12....       LCALL   ??osal_set_event?relay
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine49_0:
   \   000000   7CE8         MOV     R4,#-0x18
   \   000002   7D03         MOV     R5,#0x3
   \   000004   7A08         MOV     R2,#0x8
   \   000006   7B00         MOV     R3,#0x0
   \   000008   90....       MOV     DPTR,#MT_TaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_start_timerEx?relay
   \   000010   E9           MOV     A,R1
   \   000011   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine52_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F9           MOV     R1,A
   \   000003   8882         MOV     DPL,R0
   \   000005   8983         MOV     DPH,R1
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   90....       MOV     DPTR,#pMtAfInMsgList
   \   000003                REQUIRE ??Subroutine55_0
   \   000003                ; // Fall through to label ??Subroutine55_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine55_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   90....       MOV     DPTR,#pMtAfInMsgList
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   90....       MOV     DPTR,#pMtAfDataReq
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FA           MOV     R2,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FB           MOV     R3,A
   \   000008   12....       LCALL   ??osal_mem_free?relay
   \   00000B   90....       MOV     DPTR,#pMtAfDataReq
   \   00000E   E4           CLR     A
   \   00000F   F0           MOVX    @DPTR,A
   \   000010   A3           INC     DPTR
   \   000011   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine37:
   \   000000   F8           MOV     R0,A
   \   000001   A3           INC     DPTR
   \   000002   E0           MOVX    A,@DPTR
   \   000003   12....       LCALL   ??Subroutine52_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_137:
   \   000006   22           RET
    216          
    217          /***************************************************************************************************
    218           * @fn      MT_AfCommandProcessing
    219           *
    220           * @brief   Process all the AF commands that are issued by test tool
    221           *
    222           * @param   pBuf - pointer to the received buffer
    223           *
    224           * @return  status
    225           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    226          uint8 MT_AfCommandProcessing(uint8 *pBuf)
   \                     MT_AfCommandProcessing:
    227          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    228            uint8 status = MT_RPC_SUCCESS;
   \   000005   7E00         MOV     R6,#0x0
    229          
    230            switch (pBuf[MT_RPC_POS_CMD1])
   \   000007   8A82         MOV     DPL,R2
   \   000009   8B83         MOV     DPH,R3
   \   00000B   A3           INC     DPTR
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   12....       LCALL   ?UC_SWITCH_SPARSE
   \                     `?<Jumptable for MT_AfCommandProcessing>_0`:
   \   000011   01           DB        1
   \   000012   01           DB        1
   \   000013   02           DB        2
   \   000014   ....         DW        ??MT_AfCommandProcessing_0
   \   000016   04           DB        4
   \   000017   00           DB        0
   \   000018   ....         DW        ??MT_AfCommandProcessing_1
   \   00001A   03           DB        3
   \   00001B   ....         DW        ??MT_AfCommandProcessing_2
   \   00001D   11           DB        17
   \   00001E   ....         DW        ??MT_AfCommandProcessing_3
   \   000020   12           DB        18
   \   000021   ....         DW        ??MT_AfCommandProcessing_4
   \   000023   ....         DW        ??MT_AfCommandProcessing_5
    231            {
    232              case MT_AF_REGISTER:
    233                MT_AfRegister(pBuf);
   \                     ??MT_AfCommandProcessing_1:
   \   000025                ; Setup parameters for call to function MT_AfRegister
   \   000025   12....       LCALL   ??MT_AfRegister?relay
   \   000028   8016         SJMP    ??MT_AfCommandProcessing_6
    234                break;
    235          
    236              case MT_AF_DATA_REQUEST:
    237              case MT_AF_DATA_REQUEST_EXT:
    238                MT_AfDataRequest(pBuf);
   \                     ??MT_AfCommandProcessing_0:
   \   00002A                ; Setup parameters for call to function MT_AfDataRequest
   \   00002A   12....       LCALL   ??MT_AfDataRequest?relay
   \   00002D   8011         SJMP    ??MT_AfCommandProcessing_6
    239                break;
    240          
    241              case MT_AF_DATA_RETRIEVE:
    242                MT_AfDataRetrieve(pBuf);
   \                     ??MT_AfCommandProcessing_4:
   \   00002F                ; Setup parameters for call to function MT_AfDataRetrieve
   \   00002F   12....       LCALL   ??MT_AfDataRetrieve?relay
   \   000032   800C         SJMP    ??MT_AfCommandProcessing_6
    243                break;
    244                
    245              case MT_AF_DATA_STORE:
    246                MT_AfDataStore(pBuf);
   \                     ??MT_AfCommandProcessing_3:
   \   000034                ; Setup parameters for call to function MT_AfDataStore
   \   000034   12....       LCALL   ??MT_AfDataStore?relay
   \   000037   8007         SJMP    ??MT_AfCommandProcessing_6
    247                break;
    248                
    249          #if defined ( ZIGBEE_SOURCE_ROUTING )
    250              case MT_AF_DATA_REQUEST_SRCRTG:
    251                MT_AfDataRequestSrcRtg(pBuf);
   \                     ??MT_AfCommandProcessing_2:
   \   000039                ; Setup parameters for call to function MT_AfDataRequestSrcRtg
   \   000039   12....       LCALL   ??MT_AfDataRequestSrcRtg?relay
   \   00003C   8002         SJMP    ??MT_AfCommandProcessing_6
    252                break;
    253          #endif
    254                
    255          #if defined INTER_PAN
    256              case MT_AF_INTER_PAN_CTL:
    257                MT_AfInterPanCtl(pBuf);
    258                break; 
    259          #endif
    260                
    261              default:
    262                status = MT_RPC_ERR_COMMAND_ID;
   \                     ??MT_AfCommandProcessing_5:
   \   00003E   0E           INC     R6
   \   00003F   0E           INC     R6
    263                break;
    264            }
    265          
    266            return status;
   \                     ??MT_AfCommandProcessing_6:
   \   000040   EE           MOV     A,R6
   \   000041   F9           MOV     R1,A
   \   000042   80..         SJMP    ?Subroutine0
    267          }
    268          
    269          /***************************************************************************************************
    270           * @fn      MT_AfRegister
    271           *
    272           * @brief   Process AF Register command
    273           *
    274           * @param   pBuf - pointer to the received buffer
    275           *
    276           * @return  none
    277           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    278          void MT_AfRegister(uint8 *pBuf)
   \                     MT_AfRegister:
    279          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
    280            uint8 cmdId;
    281            uint8 retValue = ZMemError;
   \   00000E   7410         MOV     A,#0x10
   \   000010   12....       LCALL   ?Subroutine32 & 0xFFFF
    282            endPointDesc_t *epDesc;
    283          
    284            /* parse header */
    285            cmdId = pBuf[MT_RPC_POS_CMD1];
   \                     ??CrossCallReturnLabel_64:
   \   000013   F5..         MOV     ?V0 + 2,A
    286            pBuf += MT_RPC_FRAME_HDR_SZ;
    287          
    288            epDesc = (endPointDesc_t *)osal_mem_alloc(sizeof(endPointDesc_t));
   \   000015                ; Setup parameters for call to function osal_mem_alloc
   \   000015   7A06         MOV     R2,#0x6
   \   000017   7B00         MOV     R3,#0x0
   \   000019   12....       LCALL   ??osal_mem_alloc?relay
   \   00001C   8A..         MOV     ?V0 + 4,R2
   \   00001E   8B..         MOV     ?V0 + 5,R3
   \   000020   AE..         MOV     R6,?V0 + 4
   \   000022   AF..         MOV     R7,?V0 + 5
    289            if ( epDesc )
   \   000024   EE           MOV     A,R6
   \   000025   7001         JNZ     ??MT_AfRegister_0
   \   000027   EF           MOV     A,R7
   \                     ??MT_AfRegister_0:
   \   000028   6040         JZ      ??MT_AfRegister_1
    290            {
    291              epDesc->task_id = &MT_TaskID;
   \   00002A   8E82         MOV     DPL,R6
   \   00002C   8F83         MOV     DPH,R7
   \   00002E   A3           INC     DPTR
   \   00002F   74..         MOV     A,#(MT_TaskID & 0xff)
   \   000031   F0           MOVX    @DPTR,A
   \   000032   A3           INC     DPTR
   \   000033   74..         MOV     A,#((MT_TaskID >> 8) & 0xff)
   \   000035   F0           MOVX    @DPTR,A
    292              retValue = MT_BuildEndpointDesc( pBuf, epDesc );
   \   000036                ; Setup parameters for call to function MT_BuildEndpointDesc
   \   000036   EE           MOV     A,R6
   \   000037   FC           MOV     R4,A
   \   000038   EF           MOV     A,R7
   \   000039   FD           MOV     R5,A
   \   00003A   E5..         MOV     A,?V0 + 0
   \   00003C   2403         ADD     A,#0x3
   \   00003E   FA           MOV     R2,A
   \   00003F   E5..         MOV     A,?V0 + 1
   \   000041   3400         ADDC    A,#0x0
   \   000043   FB           MOV     R3,A
   \   000044   12....       LCALL   ??MT_BuildEndpointDesc?relay
   \   000047   E9           MOV     A,R1
   \   000048   85..82       MOV     DPL,?XSP + 0
   \   00004B   85..83       MOV     DPH,?XSP + 1
   \   00004E   F0           MOVX    @DPTR,A
    293              if ( retValue == ZSuccess )
   \   00004F   700F         JNZ     ??MT_AfRegister_2
    294              {
    295                retValue = afRegister( epDesc );
   \   000051                ; Setup parameters for call to function afRegister
   \   000051   EE           MOV     A,R6
   \   000052   FA           MOV     R2,A
   \   000053   EF           MOV     A,R7
   \   000054   FB           MOV     R3,A
   \   000055   12....       LCALL   ??afRegister?relay
   \   000058   E9           MOV     A,R1
   \   000059   85..82       MOV     DPL,?XSP + 0
   \   00005C   85..83       MOV     DPH,?XSP + 1
   \   00005F   F0           MOVX    @DPTR,A
    296              }
    297          
    298              if ( retValue != ZSuccess )
   \                     ??MT_AfRegister_2:
   \   000060   E0           MOVX    A,@DPTR
   \   000061   6007         JZ      ??MT_AfRegister_1
    299              {
    300                osal_mem_free( epDesc );
   \   000063                ; Setup parameters for call to function osal_mem_free
   \   000063   EE           MOV     A,R6
   \   000064   FA           MOV     R2,A
   \   000065   EF           MOV     A,R7
   \   000066   FB           MOV     R3,A
   \   000067   12....       LCALL   ??osal_mem_free?relay
    301              }
    302            }
    303          
    304            /* Build and send back the response */
    305            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), cmdId, 1, &retValue);
   \                     ??MT_AfRegister_1:
   \   00006A                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00006A   85..82       MOV     DPL,?XSP + 0
   \   00006D   85..83       MOV     DPH,?XSP + 1
   \   000070   AC82         MOV     R4,DPL
   \   000072   AD83         MOV     R5,DPH
   \   000074   7B01         MOV     R3,#0x1
   \   000076   AA..         MOV     R2,?V0 + 2
   \   000078   7964         MOV     R1,#0x64
   \   00007A   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    306          }
   \   00007D   7401         MOV     A,#0x1
   \   00007F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000082   7F06         MOV     R7,#0x6
   \   000084   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine39:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006                REQUIRE ??Subroutine47_0
   \   000006                ; // Fall through to label ??Subroutine47_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine47_0:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   8A82         MOV     DPL,R2
   \   000003   8B83         MOV     DPH,R3
   \   000005   A3           INC     DPTR
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine32:
   \   000000   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_84:
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   22           RET
    307          
    308          /***************************************************************************************************
    309           * @fn      MT_AfDataRequest
    310           *
    311           * @brief   Process AF Register command
    312           *
    313           * @param   pBuf - pointer to the received buffer
    314           *
    315           * @return  none
    316           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    317          void MT_AfDataRequest(uint8 *pBuf)
   \                     MT_AfDataRequest:
    318          {
   \   000000   74EA         MOV     A,#-0x16
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 22
   \   000005                ; Auto size: 14
   \   000005   74F2         MOV     A,#-0xe
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    319            #define MT_AF_REQ_MSG_LEN  10
    320            #define MT_AF_REQ_MSG_EXT  10
    321          
    322            endPointDesc_t *epDesc;
    323            afAddrType_t dstAddr;
    324            cId_t cId;
    325            uint8 transId, txOpts, radius;
    326            uint8 cmd0, cmd1;
    327            uint8 retValue = ZFailure;
   \   00000A   7401         MOV     A,#0x1
   \   00000C   12....       LCALL   ?Subroutine39 & 0xFFFF
    328            uint16 dataLen, tempLen;
    329          
    330            /* Parse header */
    331            cmd0 = pBuf[MT_RPC_POS_CMD0];
   \                     ??CrossCallReturnLabel_83:
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F5..         MOV     ?V0 + 10,A
    332            cmd1 = pBuf[MT_RPC_POS_CMD1];
   \   000012   8A82         MOV     DPL,R2
   \   000014   8B83         MOV     DPH,R3
   \   000016   A3           INC     DPTR
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 7,A
    333            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00001B   EA           MOV     A,R2
   \   00001C   2403         ADD     A,#0x3
   \   00001E   F5..         MOV     ?V0 + 4,A
   \   000020   EB           MOV     A,R3
   \   000021   3400         ADDC    A,#0x0
   \   000023   F5..         MOV     ?V0 + 5,A
    334          
    335            if (cmd1 == MT_AF_DATA_REQUEST_EXT)
   \   000025   7402         MOV     A,#0x2
   \   000027   65..         XRL     A,?V0 + 7
   \   000029   7064         JNZ     ??MT_AfDataRequest_0
    336            {
    337              dstAddr.addrMode = (afAddrMode_t)*pBuf++;
   \   00002B   85..82       MOV     DPL,?V0 + 4
   \   00002E   85..83       MOV     DPH,?V0 + 5
   \   000031   E0           MOVX    A,@DPTR
   \   000032   FA           MOV     R2,A
   \   000033   740A         MOV     A,#0xa
   \   000035   12....       LCALL   ?XSTACK_DISP0_8
   \   000038   EA           MOV     A,R2
   \   000039   12....       LCALL   ?Subroutine26 & 0xFFFF
    338          
    339              if (dstAddr.addrMode == afAddr64Bit)
   \                     ??CrossCallReturnLabel_42:
   \   00003C   7403         MOV     A,#0x3
   \   00003E   6A           XRL     A,R2
   \   00003F   7023         JNZ     ??MT_AfDataRequest_1
    340              {
    341                (void)osal_memcpy(dstAddr.addr.extAddr, pBuf, Z_EXTADDR_LEN);
   \   000041                ; Setup parameters for call to function osal_memcpy
   \   000041   85....       MOV     ?V0 + 0,?V0 + 4
   \   000044   85....       MOV     ?V0 + 1,?V0 + 5
   \   000047   75..00       MOV     ?V0 + 2,#0x0
   \   00004A   78..         MOV     R0,#?V0 + 0
   \   00004C   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00004F   7C08         MOV     R4,#0x8
   \   000051   7D00         MOV     R5,#0x0
   \   000053   7405         MOV     A,#0x5
   \   000055   12....       LCALL   ?XSTACK_DISP0_8
   \   000058   AA82         MOV     R2,DPL
   \   00005A   AB83         MOV     R3,DPH
   \   00005C   12....       LCALL   ??Subroutine54_0 & 0xFFFF
    342              }
   \                     ??CrossCallReturnLabel_115:
   \   00005F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000062   8009         SJMP    ??CrossCallReturnLabel_57
    343              else
    344              {
    345                dstAddr.addr.shortAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??MT_AfDataRequest_1:
   \   000064   12....       LCALL   ?Subroutine5 & 0xFFFF
    346              }
   \                     ??CrossCallReturnLabel_2:
   \   000067   12....       LCALL   ?XSTACK_DISP0_8
   \   00006A   12....       LCALL   ?Subroutine31 & 0xFFFF
    347              pBuf += Z_EXTADDR_LEN;
   \                     ??CrossCallReturnLabel_57:
   \   00006D   E5..         MOV     A,?V0 + 4
   \   00006F   2408         ADD     A,#0x8
   \   000071   12....       LCALL   ??Subroutine48_0 & 0xFFFF
    348          
    349              dstAddr.endPoint = *pBuf++;
   \                     ??CrossCallReturnLabel_88:
   \   000074   C0E0         PUSH    A
   \   000076   740B         MOV     A,#0xb
   \   000078   12....       LCALL   ?XSTACK_DISP0_8
   \   00007B   D0E0         POP     A
   \   00007D   F0           MOVX    @DPTR,A
   \   00007E   12....       LCALL   ?Subroutine6 & 0xFFFF
    350              dstAddr.panId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_92:
   \   000081   F8           MOV     R0,A
   \   000082   740C         MOV     A,#0xc
   \   000084   12....       LCALL   ?XSTACK_DISP0_8
   \   000087   12....       LCALL   ?Subroutine31 & 0xFFFF
    351              pBuf += 2;
   \                     ??CrossCallReturnLabel_58:
   \   00008A   12....       LCALL   ?Subroutine34 & 0xFFFF
    352            }
   \                     ??CrossCallReturnLabel_66:
   \   00008D   802F         SJMP    ??MT_AfDataRequest_2
    353            else
    354            {
    355              /* Destination address */
    356              dstAddr.addrMode = afAddr16Bit;
   \                     ??MT_AfDataRequest_0:
   \   00008F   740A         MOV     A,#0xa
   \   000091   12....       LCALL   ?XSTACK_DISP0_8
   \   000094   7402         MOV     A,#0x2
   \   000096   F0           MOVX    @DPTR,A
    357              dstAddr.addr.shortAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   000097   85..82       MOV     DPL,?V0 + 4
   \   00009A   85..83       MOV     DPH,?V0 + 5
   \   00009D   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   0000A0   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A3   12....       LCALL   ?Subroutine31 & 0xFFFF
    358              pBuf += 2;
   \                     ??CrossCallReturnLabel_59:
   \   0000A6   12....       LCALL   ?Subroutine18 & 0xFFFF
    359          
    360              /* Destination endpoint */
    361              dstAddr.endPoint = *pBuf++;
   \                     ??CrossCallReturnLabel_86:
   \   0000A9   C0E0         PUSH    A
   \   0000AB   740B         MOV     A,#0xb
   \   0000AD   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B0   D0E0         POP     A
   \   0000B2   12....       LCALL   ?Subroutine26 & 0xFFFF
    362              dstAddr.panId = 0;
   \                     ??CrossCallReturnLabel_43:
   \   0000B5   740C         MOV     A,#0xc
   \   0000B7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000BA   E4           CLR     A
   \   0000BB   F0           MOVX    @DPTR,A
   \   0000BC   A3           INC     DPTR
   \   0000BD   F0           MOVX    @DPTR,A
    363            }
    364          
    365            /* Source endpoint */
    366            epDesc = afFindEndPointDesc(*pBuf++);
   \                     ??MT_AfDataRequest_2:
   \   0000BE                ; Setup parameters for call to function afFindEndPointDesc
   \   0000BE   85..82       MOV     DPL,?V0 + 4
   \   0000C1   85..83       MOV     DPH,?V0 + 5
   \   0000C4   E0           MOVX    A,@DPTR
   \   0000C5   F9           MOV     R1,A
   \   0000C6   12....       LCALL   ??afFindEndPointDesc?relay
   \   0000C9   8A..         MOV     ?V0 + 8,R2
   \   0000CB   8B..         MOV     ?V0 + 9,R3
   \   0000CD   12....       LCALL   ?Subroutine6 & 0xFFFF
    367          
    368            /* ClusterId */
    369            cId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_93:
   \   0000D0   F5..         MOV     ?V0 + 0,A
   \   0000D2   E9           MOV     A,R1
   \   0000D3   F5..         MOV     ?V0 + 1,A
    370            pBuf +=2;
   \   0000D5   12....       LCALL   ?Subroutine18 & 0xFFFF
    371          
    372            /* TransId */
    373            transId = *pBuf++;
   \                     ??CrossCallReturnLabel_87:
   \   0000D8   C0E0         PUSH    A
   \   0000DA   7401         MOV     A,#0x1
   \   0000DC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DF   D0E0         POP     A
   \   0000E1   12....       LCALL   ?Subroutine41 & 0xFFFF
    374          
    375            /* TxOption */
    376            txOpts = *pBuf++;
   \                     ??CrossCallReturnLabel_70:
   \   0000E4   12....       LCALL   ?Subroutine10 & 0xFFFF
    377          
    378            /* Radius */
    379            radius = *pBuf++;
   \                     ??CrossCallReturnLabel_12:
   \   0000E7   A3           INC     DPTR
   \   0000E8   8582..       MOV     ?V0 + 4,DPL
   \   0000EB   8583..       MOV     ?V0 + 5,DPH
    380          
    381            /* Length */
    382            if (cmd1 == MT_AF_DATA_REQUEST_EXT)
   \   0000EE   7402         MOV     A,#0x2
   \   0000F0   65..         XRL     A,?V0 + 7
   \   0000F2   7012         JNZ     ??MT_AfDataRequest_3
    383            {
    384              dataLen = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   0000F4   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_94:
   \   0000F7   FE           MOV     R6,A
   \   0000F8   E9           MOV     A,R1
   \   0000F9   FF           MOV     R7,A
    385              tempLen = dataLen + MT_AF_REQ_MSG_LEN + MT_AF_REQ_MSG_EXT;
   \   0000FA   7414         MOV     A,#0x14
   \   0000FC   2E           ADD     A,R6
   \   0000FD   F8           MOV     R0,A
   \   0000FE   E4           CLR     A
   \   0000FF   3F           ADDC    A,R7
   \   000100   F9           MOV     R1,A
    386              pBuf += 2;
   \   000101   12....       LCALL   ?Subroutine34 & 0xFFFF
    387            }
   \                     ??CrossCallReturnLabel_67:
   \   000104   8013         SJMP    ??MT_AfDataRequest_4
    388            else
    389            {
    390              dataLen = *pBuf++;
   \                     ??MT_AfDataRequest_3:
   \   000106   E0           MOVX    A,@DPTR
   \   000107   FE           MOV     R6,A
   \   000108   7F00         MOV     R7,#0x0
   \   00010A   A3           INC     DPTR
   \   00010B   8582..       MOV     ?V0 + 4,DPL
   \   00010E   8583..       MOV     ?V0 + 5,DPH
    391              tempLen = dataLen + MT_AF_REQ_MSG_LEN;
   \   000111   740A         MOV     A,#0xa
   \   000113   2E           ADD     A,R6
   \   000114   F8           MOV     R0,A
   \   000115   E4           CLR     A
   \   000116   3400         ADDC    A,#0x0
   \   000118   F9           MOV     R1,A
    392            }
    393          
    394            if ( epDesc == NULL )
   \                     ??MT_AfDataRequest_4:
   \   000119   E5..         MOV     A,?V0 + 8
   \   00011B   7001         JNZ     ??MT_AfDataRequest_5
   \   00011D   EB           MOV     A,R3
   \                     ??MT_AfDataRequest_5:
   \   00011E   7005         JNZ     ??MT_AfDataRequest_6
    395            {
    396              retValue = afStatus_INVALID_PARAMETER;
   \                     ??MT_AfDataRequest_7:
   \   000120   7402         MOV     A,#0x2
   \   000122   02....       LJMP    ??MT_AfDataRequest_8 & 0xFFFF
    397            }
    398            else if (tempLen > (uint16)MT_RPC_DATA_MAX)
   \                     ??MT_AfDataRequest_6:
   \   000125   C3           CLR     C
   \   000126   E8           MOV     A,R0
   \   000127   94FB         SUBB    A,#-0x5
   \   000129   E9           MOV     A,R1
   \   00012A   9400         SUBB    A,#0x0
   \   00012C   5003         JNC     $+5
   \   00012E   02....       LJMP    ??MT_AfDataRequest_9 & 0xFFFF
    399            {
    400              if (pMtAfDataReq != NULL)
   \   000131   90....       MOV     DPTR,#pMtAfDataReq
   \   000134   E0           MOVX    A,@DPTR
   \   000135   7002         JNZ     ??MT_AfDataRequest_10
   \   000137   A3           INC     DPTR
   \   000138   E0           MOVX    A,@DPTR
   \                     ??MT_AfDataRequest_10:
   \   000139   70E5         JNZ     ??MT_AfDataRequest_7
    401              {
    402                retValue = afStatus_INVALID_PARAMETER;
    403              }
    404              else if ((pMtAfDataReq = osal_mem_alloc(sizeof(mtAfDataReq_t) + dataLen)) == NULL)
   \   00013B                ; Setup parameters for call to function osal_mem_alloc
   \   00013B   7418         MOV     A,#0x18
   \   00013D   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_68:
   \   000140   90....       MOV     DPTR,#pMtAfDataReq
   \   000143   EA           MOV     A,R2
   \   000144   F0           MOVX    @DPTR,A
   \   000145   A3           INC     DPTR
   \   000146   EB           MOV     A,R3
   \   000147   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_49:
   \   00014A   7002         JNZ     ??MT_AfDataRequest_11
   \   00014C   A3           INC     DPTR
   \   00014D   E0           MOVX    A,@DPTR
   \                     ??MT_AfDataRequest_11:
   \   00014E   7005         JNZ     ??MT_AfDataRequest_12
    405              {
    406                retValue = afStatus_MEM_FAIL;
   \   000150   7410         MOV     A,#0x10
   \   000152   02....       LJMP    ??MT_AfDataRequest_8 & 0xFFFF
    407              }
    408              else
    409              {
    410                retValue = afStatus_SUCCESS;
   \                     ??MT_AfDataRequest_12:
   \   000155   E4           CLR     A
   \   000156   85..82       MOV     DPL,?XSP + 0
   \   000159   85..83       MOV     DPH,?XSP + 1
   \   00015C   12....       LCALL   ?Subroutine27 & 0xFFFF
    411          
    412                pMtAfDataReq->data = (uint8 *)(pMtAfDataReq+1);
   \                     ??CrossCallReturnLabel_44:
   \   00015F   2418         ADD     A,#0x18
   \   000161   FA           MOV     R2,A
   \   000162   A3           INC     DPTR
   \   000163   E0           MOVX    A,@DPTR
   \   000164   3400         ADDC    A,#0x0
   \   000166   FB           MOV     R3,A
   \   000167   12....       LCALL   ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   00016A   EA           MOV     A,R2
   \   00016B   F0           MOVX    @DPTR,A
   \   00016C   A3           INC     DPTR
   \   00016D   EB           MOV     A,R3
   \   00016E   F0           MOVX    @DPTR,A
    413                (void)osal_memcpy(&(pMtAfDataReq->dstAddr), &dstAddr, sizeof(afAddrType_t));
   \   00016F                ; Setup parameters for call to function osal_memcpy
   \   00016F   7402         MOV     A,#0x2
   \   000171   12....       LCALL   ?XSTACK_DISP0_8
   \   000174   A982         MOV     R1,DPL
   \   000176   AA83         MOV     R2,DPH
   \   000178   89..         MOV     ?V0 + 4,R1
   \   00017A   8A..         MOV     ?V0 + 5,R2
   \   00017C   75..00       MOV     ?V0 + 6,#0x0
   \   00017F   78..         MOV     R0,#?V0 + 4
   \   000181   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000184   7C0C         MOV     R4,#0xc
   \   000186   7D00         MOV     R5,#0x0
   \   000188   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   00018B   12....       LCALL   ??Subroutine54_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_116:
   \   00018E   12....       LCALL   ?DEALLOC_XSTACK8
    414                pMtAfDataReq->epDesc = epDesc;
   \   000191   90....       MOV     DPTR,#pMtAfDataReq
   \   000194   E0           MOVX    A,@DPTR
   \   000195   240E         ADD     A,#0xe
   \   000197   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_124:
   \   00019A   E5..         MOV     A,?V0 + 8
   \   00019C   F0           MOVX    @DPTR,A
   \   00019D   A3           INC     DPTR
   \   00019E   E5..         MOV     A,?V0 + 9
   \   0001A0   F0           MOVX    @DPTR,A
    415                pMtAfDataReq->cId = cId;
   \   0001A1   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_131:
   \   0001A4   E5..         MOV     A,?V0 + 0
   \   0001A6   F0           MOVX    @DPTR,A
   \   0001A7   A3           INC     DPTR
   \   0001A8   E5..         MOV     A,?V0 + 1
   \   0001AA   12....       LCALL   ?Subroutine27 & 0xFFFF
    416                pMtAfDataReq->dataLen = dataLen;
   \                     ??CrossCallReturnLabel_45:
   \   0001AD   2412         ADD     A,#0x12
   \   0001AF   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_125:
   \   0001B2   EE           MOV     A,R6
   \   0001B3   F0           MOVX    @DPTR,A
   \   0001B4   A3           INC     DPTR
   \   0001B5   EF           MOV     A,R7
   \   0001B6   F0           MOVX    @DPTR,A
    417                pMtAfDataReq->transId = transId;
   \   0001B7   7401         MOV     A,#0x1
   \   0001B9   12....       LCALL   ?XSTACK_DISP0_8
   \   0001BC   E0           MOVX    A,@DPTR
   \   0001BD   C0E0         PUSH    A
   \   0001BF   90....       MOV     DPTR,#pMtAfDataReq
   \   0001C2   E0           MOVX    A,@DPTR
   \   0001C3   2414         ADD     A,#0x14
   \   0001C5   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_126:
   \   0001C8   D0E0         POP     A
   \   0001CA   12....       LCALL   ?Subroutine27 & 0xFFFF
    418                pMtAfDataReq->txOpts = txOpts;
   \                     ??CrossCallReturnLabel_46:
   \   0001CD   2415         ADD     A,#0x15
   \   0001CF   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_127:
   \   0001D2   E5..         MOV     A,?V0 + 2
   \   0001D4   12....       LCALL   ?Subroutine27 & 0xFFFF
    419                pMtAfDataReq->radius = radius;
   \                     ??CrossCallReturnLabel_47:
   \   0001D7   2416         ADD     A,#0x16
   \   0001D9   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_128:
   \   0001DC   E5..         MOV     A,?V0 + 3
   \   0001DE   12....       LCALL   ?Subroutine27 & 0xFFFF
    420          
    421                // Setup to time-out the huge outgoing item if host does not MT_AF_DATA_STORE it.
    422                pMtAfDataReq->tick = MT_AF_EXEC_CNT;
   \                     ??CrossCallReturnLabel_48:
   \   0001E1   2417         ADD     A,#0x17
   \   0001E3   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_129:
   \   0001E6   740F         MOV     A,#0xf
   \   0001E8   12....       LCALL   ?Subroutine11 & 0xFFFF
    423                if (ZSuccess != osal_start_timerEx(MT_TaskID, MT_AF_EXEC_EVT, MT_AF_EXEC_DLY))
   \                     ??CrossCallReturnLabel_89:
   \   0001EB   604C         JZ      ??MT_AfDataRequest_13
    424                {
    425                  (void)osal_set_event(MT_TaskID, MT_AF_EXEC_EVT);
   \   0001ED                ; Setup parameters for call to function osal_set_event
   \   0001ED   12....       LCALL   ?Subroutine17 & 0xFFFF
    426                }
    427              }
    428            }
   \                     ??CrossCallReturnLabel_25:
   \   0001F0   8047         SJMP    ??MT_AfDataRequest_13
    429            else
    430            {
    431              retValue = AF_DataRequest(&dstAddr, epDesc, cId, dataLen, pBuf, &transId, txOpts, radius);
   \                     ??MT_AfDataRequest_9:
   \   0001F2                ; Setup parameters for call to function AF_DataRequest
   \   0001F2   78..         MOV     R0,#?V0 + 3
   \   0001F4   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001F7   7402         MOV     A,#0x2
   \   0001F9   12....       LCALL   ?XSTACK_DISP0_8
   \   0001FC   8582..       MOV     ?V0 + 12,DPL
   \   0001FF   8583..       MOV     ?V0 + 13,DPH
   \   000202   78..         MOV     R0,#?V0 + 12
   \   000204   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000207   78..         MOV     R0,#?V0 + 4
   \   000209   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00020C   8E..         MOV     ?V0 + 4,R6
   \   00020E   8F..         MOV     ?V0 + 5,R7
   \   000210   78..         MOV     R0,#?V0 + 4
   \   000212   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000215   78..         MOV     R0,#?V0 + 0
   \   000217   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00021A   A9..         MOV     R1,?V0 + 2
   \   00021C   AC..         MOV     R4,?V0 + 8
   \   00021E   AD..         MOV     R5,?V0 + 9
   \   000220   740B         MOV     A,#0xb
   \   000222   12....       LCALL   ?XSTACK_DISP0_8
   \   000225   AA82         MOV     R2,DPL
   \   000227   AB83         MOV     R3,DPH
   \   000229   12....       LCALL   ??AF_DataRequest?relay
   \   00022C   7409         MOV     A,#0x9
   \   00022E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000231   E9           MOV     A,R1
   \                     ??MT_AfDataRequest_8:
   \   000232   85..82       MOV     DPL,?XSP + 0
   \   000235   85..83       MOV     DPH,?XSP + 1
   \   000238   F0           MOVX    @DPTR,A
    432            }
    433          
    434            if (MT_RPC_CMD_SREQ == (cmd0 & MT_RPC_CMD_TYPE_MASK))
   \                     ??MT_AfDataRequest_13:
   \   000239   74E0         MOV     A,#-0x20
   \   00023B   55..         ANL     A,?V0 + 10
   \   00023D   6420         XRL     A,#0x20
   \   00023F   7013         JNZ     ??MT_AfDataRequest_14
    435            {
    436              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP|(uint8)MT_RPC_SYS_AF), cmd1, 1, &retValue);
   \   000241                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000241   85..82       MOV     DPL,?XSP + 0
   \   000244   85..83       MOV     DPH,?XSP + 1
   \   000247   AC82         MOV     R4,DPL
   \   000249   AD83         MOV     R5,DPH
   \   00024B   7B01         MOV     R3,#0x1
   \   00024D   AA..         MOV     R2,?V0 + 7
   \   00024F   7964         MOV     R1,#0x64
   \   000251   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    437            }
    438          }
   \                     ??MT_AfDataRequest_14:
   \   000254   740E         MOV     A,#0xe
   \   000256   12....       LCALL   ?DEALLOC_XSTACK8
   \   000259   7F0E         MOV     R7,#0xe
   \   00025B   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine34:
   \   000000   E5..         MOV     A,?V0 + 4
   \   000002   2402         ADD     A,#0x2
   \   000004   F5..         MOV     ?V0 + 4,A
   \   000006   E5..         MOV     A,?V0 + 5
   \   000008   3400         ADDC    A,#0x0
   \   00000A   F5..         MOV     ?V0 + 5,A
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine27:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   90....       MOV     DPTR,#pMtAfDataReq
   \   000004   E0           MOVX    A,@DPTR
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_71:
   \   000003   8582..       MOV     ?V0 + 4,DPL
   \   000006   8583..       MOV     ?V0 + 5,DPH
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine41:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   85..82       MOV     DPL,?V0 + 4
   \   000004   85..83       MOV     DPH,?V0 + 5
   \   000007   A3           INC     DPTR
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   E5..         MOV     A,?V0 + 4
   \   000002   2402         ADD     A,#0x2
   \   000004                REQUIRE ??Subroutine48_0
   \   000004                ; // Fall through to label ??Subroutine48_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine48_0:
   \   000000   F5..         MOV     ?V0 + 4,A
   \   000002   E5..         MOV     A,?V0 + 5
   \   000004   3400         ADDC    A,#0x0
   \   000006   F5..         MOV     ?V0 + 5,A
   \   000008   85..82       MOV     DPL,?V0 + 4
   \   00000B   F583         MOV     DPH,A
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function osal_start_timerEx
   \   000001                ; Setup parameters for call to function osal_start_timerEx
   \   000001                REQUIRE ??Subroutine49_0
   \   000001                ; // Fall through to label ??Subroutine49_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   85..82       MOV     DPL,?V0 + 4
   \   000003   85..83       MOV     DPH,?V0 + 5
   \   000006   A3           INC     DPTR
   \   000007   8582..       MOV     ?V0 + 4,DPL
   \   00000A   8583..       MOV     ?V0 + 5,DPH
   \   00000D                REQUIRE ??Subroutine50_0
   \   00000D                ; // Fall through to label ??Subroutine50_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine50_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   EA           MOV     A,R2
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   EA           MOV     A,R2
   \   000006   F8           MOV     R0,A
   \   000007   7402         MOV     A,#0x2
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine35:
   \   000000   2E           ADD     A,R6
   \   000001   FA           MOV     R2,A
   \   000002   E4           CLR     A
   \   000003   3F           ADDC    A,R7
   \   000004   FB           MOV     R3,A
   \   000005   12....       LCALL   ??osal_mem_alloc?relay
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine31:
   \   000000   E8           MOV     A,R0
   \   000001   F0           MOVX    @DPTR,A
   \   000002   A3           INC     DPTR
   \   000003   E9           MOV     A,R1
   \   000004   F0           MOVX    @DPTR,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine54_0:
   \   000000   12....       LCALL   ??osal_memcpy?relay
   \   000003   7403         MOV     A,#0x3
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F5..         MOV     ?V0 + 2,A
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   F5..         MOV     ?V0 + 3,A
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   90....       MOV     DPTR,#pMtAfDataReq
   \   000003   E0           MOVX    A,@DPTR
   \   000004   2402         ADD     A,#0x2
   \   000006   FA           MOV     R2,A
   \   000007   A3           INC     DPTR
   \   000008   E0           MOVX    A,@DPTR
   \   000009   3400         ADDC    A,#0x0
   \   00000B   FB           MOV     R3,A
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   90....       MOV     DPTR,#pMtAfDataReq
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F8           MOV     R0,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   F583         MOV     DPH,A
   \   000009   8882         MOV     DPL,R0
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   90....       MOV     DPTR,#pMtAfDataReq
   \   000003   E0           MOVX    A,@DPTR
   \   000004   2410         ADD     A,#0x10
   \   000006                REQUIRE ??Subroutine56_0
   \   000006                ; // Fall through to label ??Subroutine56_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine56_0:
   \   000000   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_134:
   \   000003   22           RET
    439          
    440          #if defined ( ZIGBEE_SOURCE_ROUTING )
    441          
    442          /***************************************************************************************************
    443           * @fn      MT_AfDataRequestSrcRtg
    444           *
    445           * @brief   Process AF Register command
    446           *
    447           * @param   pBuf - pointer to the received buffer
    448           *
    449           * @return  none
    450           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    451          void MT_AfDataRequestSrcRtg(uint8 *pBuf)
   \                     MT_AfDataRequestSrcRtg:
    452          {
   \   000000   74EC         MOV     A,#-0x14
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 20
   \   000005                ; Auto size: 14
   \   000005   74F2         MOV     A,#-0xe
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    453            uint8 cmdId, dataLen = 0;
    454            uint8 retValue = ZFailure;
   \   00000E   7401         MOV     A,#0x1
   \   000010   85..82       MOV     DPL,?XSP + 0
   \   000013   85..83       MOV     DPH,?XSP + 1
   \   000016   12....       LCALL   ?Subroutine29 & 0xFFFF
    455            endPointDesc_t *epDesc;
    456            byte transId;
    457            afAddrType_t dstAddr;
    458            cId_t cId;
    459            byte txOpts, radius, srcEP, relayCnt;
    460            uint16 *pRelayList;
    461            uint8 i;
    462          
    463            /* parse header */
    464            cmdId = pBuf[MT_RPC_POS_CMD1];
   \                     ??CrossCallReturnLabel_52:
   \   000019   A3           INC     DPTR
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F5..         MOV     ?V0 + 2,A
    465            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00001D   EE           MOV     A,R6
   \   00001E   2403         ADD     A,#0x3
   \   000020   0E           INC     R6
   \   000021   0E           INC     R6
   \   000022   0E           INC     R6
   \   000023   EF           MOV     A,R7
   \   000024   3400         ADDC    A,#0x0
   \   000026   FF           MOV     R7,A
    466          
    467            /* Destination address */
    468            /* Initialize the panID field to zero to avoid inter-pan */
    469            osal_memset( &dstAddr, 0, sizeof(afAddrType_t) ); 
   \   000027                ; Setup parameters for call to function osal_memset
   \   000027   7C0C         MOV     R4,#0xc
   \   000029   7D00         MOV     R5,#0x0
   \   00002B   7900         MOV     R1,#0x0
   \   00002D   7402         MOV     A,#0x2
   \   00002F   12....       LCALL   ?XSTACK_DISP0_8
   \   000032   AA82         MOV     R2,DPL
   \   000034   AB83         MOV     R3,DPH
   \   000036   12....       LCALL   ??osal_memset?relay
    470            dstAddr.addrMode = afAddr16Bit;
   \   000039   740A         MOV     A,#0xa
   \   00003B   12....       LCALL   ?XSTACK_DISP0_8
   \   00003E   7402         MOV     A,#0x2
   \   000040   F0           MOVX    @DPTR,A
    471            dstAddr.addr.shortAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   000041   8E82         MOV     DPL,R6
   \   000043   8F83         MOV     DPH,R7
   \   000045   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_4:
   \   000048   12....       LCALL   ?XSTACK_DISP0_8
   \   00004B   12....       LCALL   ?Subroutine31 & 0xFFFF
    472            pBuf += 2;
   \                     ??CrossCallReturnLabel_60:
   \   00004E   12....       LCALL   ?Subroutine23 & 0xFFFF
    473          
    474            /* Destination endpoint */
    475            dstAddr.endPoint = *pBuf++;
   \                     ??CrossCallReturnLabel_36:
   \   000051   C0E0         PUSH    A
   \   000053   740B         MOV     A,#0xb
   \   000055   12....       LCALL   ?XSTACK_DISP0_8
   \   000058   D0E0         POP     A
   \   00005A   12....       LCALL   ?Subroutine29 & 0xFFFF
    476          
    477            /* Source endpoint */
    478            srcEP = *pBuf++;
   \                     ??CrossCallReturnLabel_53:
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F9           MOV     R1,A
   \   00005F   A3           INC     DPTR
   \   000060   AE82         MOV     R6,DPL
   \   000062   AF83         MOV     R7,DPH
    479            epDesc = afFindEndPointDesc( srcEP );
   \   000064                ; Setup parameters for call to function afFindEndPointDesc
   \   000064   12....       LCALL   ??afFindEndPointDesc?relay
   \   000067   8A..         MOV     ?V0 + 4,R2
   \   000069   8B..         MOV     ?V0 + 5,R3
    480          
    481            /* ClusterId */
    482            cId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   00006B   8E82         MOV     DPL,R6
   \   00006D   8F83         MOV     DPH,R7
   \   00006F   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_95:
   \   000072   F5..         MOV     ?V0 + 6,A
   \   000074   E9           MOV     A,R1
   \   000075   F5..         MOV     ?V0 + 7,A
    483            pBuf +=2;
   \   000077   12....       LCALL   ?Subroutine23 & 0xFFFF
    484          
    485            /* TransId */
    486            transId = *pBuf++;
   \                     ??CrossCallReturnLabel_37:
   \   00007A   C0E0         PUSH    A
   \   00007C   7401         MOV     A,#0x1
   \   00007E   12....       LCALL   ?XSTACK_DISP0_8
   \   000081   D0E0         POP     A
   \   000083   12....       LCALL   ?Subroutine29 & 0xFFFF
    487          
    488            /* TxOption */
    489            txOpts = *pBuf++;
   \                     ??CrossCallReturnLabel_54:
   \   000086   E0           MOVX    A,@DPTR
   \   000087   F5..         MOV     ?V0 + 3,A
   \   000089   A3           INC     DPTR
    490          
    491            /* Radius */
    492            radius = *pBuf++;
   \   00008A   E0           MOVX    A,@DPTR
   \   00008B   F5..         MOV     ?V0 + 10,A
   \   00008D   A3           INC     DPTR
    493            
    494            /* Source route relay count */
    495            relayCnt = *pBuf++;
   \   00008E   E0           MOVX    A,@DPTR
   \   00008F   F5..         MOV     ?V0 + 11,A
   \   000091   A3           INC     DPTR
   \   000092   AE82         MOV     R6,DPL
   \   000094   AF83         MOV     R7,DPH
    496            
    497            /* Convert the source route relay list */
    498            if( (pRelayList = osal_mem_alloc( relayCnt * sizeof( uint16 ))) != NULL )
   \   000096                ; Setup parameters for call to function osal_mem_alloc
   \   000096   C3           CLR     C
   \   000097   33           RLC     A
   \   000098   FA           MOV     R2,A
   \   000099   E4           CLR     A
   \   00009A   33           RLC     A
   \   00009B   FB           MOV     R3,A
   \   00009C   12....       LCALL   ??osal_mem_alloc?relay
   \   00009F   8A..         MOV     ?V0 + 0,R2
   \   0000A1   8B..         MOV     ?V0 + 1,R3
   \   0000A3   EA           MOV     A,R2
   \   0000A4   7001         JNZ     ??MT_AfDataRequestSrcRtg_0
   \   0000A6   EB           MOV     A,R3
   \                     ??MT_AfDataRequestSrcRtg_0:
   \   0000A7   7003         JNZ     $+5
   \   0000A9   02....       LJMP    ??MT_AfDataRequestSrcRtg_1 & 0xFFFF
    499            {
    500              for( i = 0; i < relayCnt; i++ )
   \   0000AC   7C00         MOV     R4,#0x0
   \   0000AE   801F         SJMP    ??MT_AfDataRequestSrcRtg_2
    501              {
    502                pRelayList[i]  = BUILD_UINT16( pBuf[0], pBuf[1] );
   \                     ??MT_AfDataRequestSrcRtg_3:
   \   0000B0   E0           MOVX    A,@DPTR
   \   0000B1   F9           MOV     R1,A
   \   0000B2   E4           CLR     A
   \   0000B3   2A           ADD     A,R2
   \   0000B4   E9           MOV     A,R1
   \   0000B5   FB           MOV     R3,A
   \   0000B6   EC           MOV     A,R4
   \   0000B7   33           RLC     A
   \   0000B8   F8           MOV     R0,A
   \   0000B9   E4           CLR     A
   \   0000BA   33           RLC     A
   \   0000BB   F9           MOV     R1,A
   \   0000BC   E5..         MOV     A,?V0 + 0
   \   0000BE   28           ADD     A,R0
   \   0000BF   F582         MOV     DPL,A
   \   0000C1   E5..         MOV     A,?V0 + 1
   \   0000C3   39           ADDC    A,R1
   \   0000C4   F583         MOV     DPH,A
   \   0000C6   EA           MOV     A,R2
   \   0000C7   F0           MOVX    @DPTR,A
   \   0000C8   A3           INC     DPTR
   \   0000C9   EB           MOV     A,R3
   \   0000CA   F0           MOVX    @DPTR,A
    503                pBuf += 2;
   \   0000CB   12....       LCALL   ?Subroutine42 & 0xFFFF
    504              }
   \                     ??CrossCallReturnLabel_72:
   \   0000CE   0C           INC     R4
   \                     ??MT_AfDataRequestSrcRtg_2:
   \   0000CF   EC           MOV     A,R4
   \   0000D0   C3           CLR     C
   \   0000D1   95..         SUBB    A,?V0 + 11
   \   0000D3   8E82         MOV     DPL,R6
   \   0000D5   8F83         MOV     DPH,R7
   \   0000D7   E0           MOVX    A,@DPTR
   \   0000D8   FA           MOV     R2,A
   \   0000D9   A3           INC     DPTR
   \   0000DA   40D4         JC      ??MT_AfDataRequestSrcRtg_3
    505            
    506              /* Data payload Length */
    507              dataLen = *pBuf++;
   \   0000DC   AE82         MOV     R6,DPL
   \   0000DE   AF83         MOV     R7,DPH
    508          
    509              if ( epDesc == NULL )
   \   0000E0   E5..         MOV     A,?V0 + 4
   \   0000E2   7002         JNZ     ??MT_AfDataRequestSrcRtg_4
   \   0000E4   E5..         MOV     A,?V0 + 5
   \                     ??MT_AfDataRequestSrcRtg_4:
   \   0000E6   7004         JNZ     ??MT_AfDataRequestSrcRtg_5
    510              {
    511                retValue = afStatus_INVALID_PARAMETER;
   \   0000E8   7402         MOV     A,#0x2
   \   0000EA   8057         SJMP    ??MT_AfDataRequestSrcRtg_6
    512              }
    513              else
    514              {
    515                retValue = AF_DataRequestSrcRtg( &dstAddr, epDesc, cId, dataLen, pBuf, 
    516                                               &transId, txOpts, radius, relayCnt, pRelayList );
   \                     ??MT_AfDataRequestSrcRtg_5:
   \   0000EC                ; Setup parameters for call to function AF_DataRequestSrcRtg
   \   0000EC   78..         MOV     R0,#?V0 + 0
   \   0000EE   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000F1   E5..         MOV     A,?V0 + 11
   \   0000F3   F5..         MOV     ?V0 + 8,A
   \   0000F5   78..         MOV     R0,#?V0 + 8
   \   0000F7   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000FA   E5..         MOV     A,?V0 + 10
   \   0000FC   F5..         MOV     ?V0 + 8,A
   \   0000FE   78..         MOV     R0,#?V0 + 8
   \   000100   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000103   7405         MOV     A,#0x5
   \   000105   12....       LCALL   ?XSTACK_DISP0_8
   \   000108   8582..       MOV     ?V0 + 8,DPL
   \   00010B   8583..       MOV     ?V0 + 9,DPH
   \   00010E   78..         MOV     R0,#?V0 + 8
   \   000110   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000113   8E..         MOV     ?V0 + 8,R6
   \   000115   8F..         MOV     ?V0 + 9,R7
   \   000117   78..         MOV     R0,#?V0 + 8
   \   000119   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00011C   8A..         MOV     ?V0 + 8,R2
   \   00011E   75..00       MOV     ?V0 + 9,#0x0
   \   000121   78..         MOV     R0,#?V0 + 8
   \   000123   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000126   78..         MOV     R0,#?V0 + 6
   \   000128   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00012B   A9..         MOV     R1,?V0 + 3
   \   00012D   AC..         MOV     R4,?V0 + 4
   \   00012F   AD..         MOV     R5,?V0 + 5
   \   000131   740E         MOV     A,#0xe
   \   000133   12....       LCALL   ?XSTACK_DISP0_8
   \   000136   AA82         MOV     R2,DPL
   \   000138   AB83         MOV     R3,DPH
   \   00013A   12....       LCALL   ??AF_DataRequestSrcRtg?relay
   \   00013D   740C         MOV     A,#0xc
   \   00013F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000142   E9           MOV     A,R1
   \                     ??MT_AfDataRequestSrcRtg_6:
   \   000143   85..82       MOV     DPL,?XSP + 0
   \   000146   85..83       MOV     DPH,?XSP + 1
   \   000149   F0           MOVX    @DPTR,A
    517              }
    518              
    519              /* Free the memory allocated */
    520              osal_mem_free( pRelayList );
   \   00014A                ; Setup parameters for call to function osal_mem_free
   \   00014A   AA..         MOV     R2,?V0 + 0
   \   00014C   AB..         MOV     R3,?V0 + 1
   \   00014E   12....       LCALL   ??osal_mem_free?relay
   \   000151   8009         SJMP    ??MT_AfDataRequestSrcRtg_7
    521            }
    522            else
    523            {
    524              retValue = afStatus_MEM_FAIL;
   \                     ??MT_AfDataRequestSrcRtg_1:
   \   000153   7410         MOV     A,#0x10
   \   000155   85..82       MOV     DPL,?XSP + 0
   \   000158   85..83       MOV     DPH,?XSP + 1
   \   00015B   F0           MOVX    @DPTR,A
    525            }
    526              
    527          
    528            /* Build and send back the response */
    529            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), cmdId, 1, &retValue);
   \                     ??MT_AfDataRequestSrcRtg_7:
   \   00015C                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00015C   85..82       MOV     DPL,?XSP + 0
   \   00015F   85..83       MOV     DPH,?XSP + 1
   \   000162   AC82         MOV     R4,DPL
   \   000164   AD83         MOV     R5,DPH
   \   000166   7B01         MOV     R3,#0x1
   \   000168   AA..         MOV     R2,?V0 + 2
   \   00016A   7964         MOV     R1,#0x64
   \   00016C   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    530          }
   \   00016F   740E         MOV     A,#0xe
   \   000171   12....       LCALL   ?DEALLOC_XSTACK8
   \   000174   7F0C         MOV     R7,#0xc
   \   000176   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine29:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   12....       LCALL   ?Subroutine42 & 0xFFFF
   \                     ??CrossCallReturnLabel_73:
   \   000003   8E82         MOV     DPL,R6
   \   000005   8F83         MOV     DPH,R7
   \   000007   E0           MOVX    A,@DPTR
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine42:
   \   000000   EE           MOV     A,R6
   \   000001   2402         ADD     A,#0x2
   \   000003   0E           INC     R6
   \   000004   0E           INC     R6
   \   000005   EF           MOV     A,R7
   \   000006   3400         ADDC    A,#0x0
   \   000008   FF           MOV     R7,A
   \   000009   22           RET
    531          #endif
    532          
    533          #if defined INTER_PAN
    534          /***************************************************************************************************
    535           * @fn      MT_AfInterPanCtl
    536           *
    537           * @brief   Process the AF Inter Pan control command.
    538           *
    539           * @param   pBuf - pointer to the received buffer
    540           *
    541           * @return  none
    542           ***************************************************************************************************/
    543          static void MT_AfInterPanCtl(uint8 *pBuf)
    544          {
    545            uint8 cmd, rtrn;
    546            uint16 panId;
    547            endPointDesc_t *pEP;
    548            
    549            cmd = pBuf[MT_RPC_POS_CMD1];
    550            pBuf += MT_RPC_FRAME_HDR_SZ;
    551          
    552            switch (*pBuf++)  // Inter-pan request parameter.
    553            {
    554            case InterPanClr:
    555              rtrn = StubAPS_SetIntraPanChannel();           // Switch channel back to the NIB channel.
    556              break;
    557          
    558            case InterPanSet:
    559              rtrn = StubAPS_SetInterPanChannel(*pBuf);      // Set channel for inter-pan communication.
    560              break;
    561          
    562            case InterPanReg:
    563              if ((pEP = afFindEndPointDesc(*pBuf)))
    564              {
    565                StubAPS_RegisterApp(pEP);
    566                rtrn = SUCCESS;
    567              }
    568              else
    569              {
    570                rtrn = FAILURE;
    571              }
    572              break;
    573          
    574            case InterPanChk:
    575              panId = BUILD_UINT16(pBuf[0], pBuf[1]);
    576              rtrn = (StubAPS_InterPan(panId, pBuf[2])) ? ZSuccess : ZFailure;
    577              break;
    578          
    579            default:
    580              rtrn = afStatus_INVALID_PARAMETER;
    581              break;
    582            }
    583          
    584            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), cmd, 1, &rtrn);
    585          }
    586          #endif
    587          
    588          /***************************************************************************************************
    589           * @fn      MT_AfDataConfirm
    590           *
    591           * @brief   Process
    592           *
    593           * @param   pBuf - pointer to the received buffer
    594           *
    595           * @return  none
    596           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    597          void MT_AfDataConfirm(afDataConfirm_t *pMsg)
   \                     MT_AfDataConfirm:
    598          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 3
   \   000004   74FD         MOV     A,#-0x3
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
    599            uint8 retArray[3];
    600          
    601            retArray[0] = pMsg->hdr.status;
   \   000009   8A82         MOV     DPL,R2
   \   00000B   8B83         MOV     DPH,R3
   \   00000D   A3           INC     DPTR
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   12....       LCALL   ?Subroutine32 & 0xFFFF
    602            retArray[1] = pMsg->endpoint;
   \                     ??CrossCallReturnLabel_65:
   \   000012   C0E0         PUSH    A
   \   000014   7401         MOV     A,#0x1
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   D0E0         POP     A
   \   00001B   12....       LCALL   ??Subroutine47_0 & 0xFFFF
    603            retArray[2] = pMsg->transID;
   \                     ??CrossCallReturnLabel_85:
   \   00001E   A3           INC     DPTR
   \   00001F   A3           INC     DPTR
   \   000020   E0           MOVX    A,@DPTR
   \   000021   C0E0         PUSH    A
   \   000023   7402         MOV     A,#0x2
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   D0E0         POP     A
   \   00002A   12....       LCALL   ?Subroutine28 & 0xFFFF
    604          
    605            /* Build and send back the response */
    606            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_AF), MT_AF_DATA_CONFIRM, 3, retArray);
   \                     ??CrossCallReturnLabel_50:
   \   00002D   7B03         MOV     R3,#0x3
   \   00002F   7A80         MOV     R2,#-0x80
   \   000031   7944         MOV     R1,#0x44
   \   000033   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    607          }
   \   000036   7403         MOV     A,#0x3
   \   000038   12....       LCALL   ?DEALLOC_XSTACK8
   \   00003B   D083         POP     DPH
   \   00003D   D082         POP     DPL
   \   00003F   02....       LJMP    ?BRET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   AC82         MOV     R4,DPL
   \   000009   AD83         MOV     R5,DPH
   \   00000B   22           RET
    608          
    609          /***************************************************************************************************
    610           * @fn          MT_AfIncomingMsg
    611           *
    612           * @brief       Process the callback subscription for AF Incoming data.
    613           *
    614           * @param       pkt - Incoming AF data.
    615           *
    616           * @return      none
    617           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    618          void MT_AfIncomingMsg(afIncomingMSGPacket_t *pMsg)
   \                     MT_AfIncomingMsg:
    619          {
   \   000000   74E9         MOV     A,#-0x17
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 23
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 8,R2
   \   000007   8B..         MOV     ?V0 + 9,R3
    620            #define MT_AF_INC_MSG_LEN  17
    621            #define MT_AF_INC_MSG_EXT  10
    622          
    623            uint16 dataLen = pMsg->cmd.DataLength;  // Length of the data section in the response packet.
   \   000009   EA           MOV     A,R2
   \   00000A   241F         ADD     A,#0x1f
   \   00000C   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_77:
   \   00000F   FE           MOV     R6,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   FF           MOV     R7,A
    624            uint16 respLen = MT_AF_INC_MSG_LEN + dataLen;
   \   000013   7411         MOV     A,#0x11
   \   000015   2E           ADD     A,R6
   \   000016   F5..         MOV     ?V0 + 0,A
   \   000018   E4           CLR     A
   \   000019   3F           ADDC    A,R7
   \   00001A   F5..         MOV     ?V0 + 1,A
    625            uint8 cmd = MT_AF_INCOMING_MSG;
   \   00001C   75..81       MOV     ?V0 + 14,#-0x7f
    626            uint8 *pRsp, *pTmp;
    627            mtAfInMsgList_t *pItem = NULL;
   \   00001F   75..00       MOV     ?V0 + 10,#0x0
   \   000022   75..00       MOV     ?V0 + 11,#0x0
    628          
    629          #if defined INTER_PAN
    630            if (StubAPS_InterPan(pMsg->srcAddr.panId, pMsg->srcAddr.endPoint))
    631            {
    632              cmd = MT_AF_INCOMING_MSG_EXT;
    633            }
    634            else
    635          #endif
    636            if ((pMsg->srcAddr.addrMode == afAddr64Bit) ||
    637                (respLen > (uint16)(MT_RPC_DATA_MAX - MT_AF_INC_MSG_EXT)))
   \   000025   EA           MOV     A,R2
   \   000026   240E         ADD     A,#0xe
   \   000028   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_78:
   \   00002B   6403         XRL     A,#0x3
   \   00002D   600B         JZ      ??MT_AfIncomingMsg_0
   \   00002F   C3           CLR     C
   \   000030   E5..         MOV     A,?V0 + 0
   \   000032   94F1         SUBB    A,#-0xf
   \   000034   E5..         MOV     A,?V0 + 1
   \   000036   9400         SUBB    A,#0x0
   \   000038   400F         JC      ??MT_AfIncomingMsg_1
    638            {
    639              cmd = MT_AF_INCOMING_MSG_EXT;
   \                     ??MT_AfIncomingMsg_0:
   \   00003A   75..82       MOV     ?V0 + 14,#-0x7e
    640            }
    641          
    642            if (cmd == MT_AF_INCOMING_MSG_EXT)
    643            {
    644              respLen += MT_AF_INC_MSG_EXT;
   \   00003D   E5..         MOV     A,?V0 + 0
   \   00003F   240A         ADD     A,#0xa
   \   000041   F5..         MOV     ?V0 + 0,A
   \   000043   E5..         MOV     A,?V0 + 1
   \   000045   3400         ADDC    A,#0x0
   \   000047   F5..         MOV     ?V0 + 1,A
    645            }
    646          
    647            if (respLen > (uint16)MT_RPC_DATA_MAX)
   \                     ??MT_AfIncomingMsg_1:
   \   000049   C3           CLR     C
   \   00004A   E5..         MOV     A,?V0 + 0
   \   00004C   94FB         SUBB    A,#-0x5
   \   00004E   E5..         MOV     A,?V0 + 1
   \   000050   9400         SUBB    A,#0x0
   \   000052   402E         JC      ??MT_AfIncomingMsg_2
    648            {
    649              if ((pItem = (mtAfInMsgList_t *)osal_mem_alloc(sizeof(mtAfInMsgList_t) + dataLen)) == NULL)
   \   000054                ; Setup parameters for call to function osal_mem_alloc
   \   000054   7409         MOV     A,#0x9
   \   000056   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_69:
   \   000059   8A..         MOV     ?V0 + 10,R2
   \   00005B   8B..         MOV     ?V0 + 11,R3
   \   00005D   EA           MOV     A,R2
   \   00005E   7001         JNZ     ??MT_AfIncomingMsg_3
   \   000060   EB           MOV     A,R3
   \                     ??MT_AfIncomingMsg_3:
   \   000061   7003         JNZ     $+5
   \   000063   02....       LJMP    ??MT_AfIncomingMsg_4 & 0xFFFF
    650              {
    651                return;  // If cannot hold a huge message, cannot give indication at all.
    652              }
    653          
    654              pItem->data = (uint8 *)(pItem+1);
   \   000066   EA           MOV     A,R2
   \   000067   2409         ADD     A,#0x9
   \   000069   F8           MOV     R0,A
   \   00006A   EB           MOV     A,R3
   \   00006B   3400         ADDC    A,#0x0
   \   00006D   F9           MOV     R1,A
   \   00006E   8A82         MOV     DPL,R2
   \   000070   8B83         MOV     DPH,R3
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   12....       LCALL   ?Subroutine31 & 0xFFFF
    655              respLen -= dataLen;  // Zero data bytes are sent with an over-sized incoming indication.
   \                     ??CrossCallReturnLabel_61:
   \   000077   C3           CLR     C
   \   000078   E5..         MOV     A,?V0 + 0
   \   00007A   9E           SUBB    A,R6
   \   00007B   F5..         MOV     ?V0 + 0,A
   \   00007D   E5..         MOV     A,?V0 + 1
   \   00007F   9F           SUBB    A,R7
   \   000080   F5..         MOV     ?V0 + 1,A
    656            }
    657          
    658            // Attempt to allocate memory for the response packet.
    659            if ((pRsp = osal_mem_alloc(respLen)) == NULL)
   \                     ??MT_AfIncomingMsg_2:
   \   000082                ; Setup parameters for call to function osal_mem_alloc
   \   000082   AA..         MOV     R2,?V0 + 0
   \   000084   AB..         MOV     R3,?V0 + 1
   \   000086   12....       LCALL   ??osal_mem_alloc?relay
   \   000089   8A..         MOV     ?V0 + 12,R2
   \   00008B   8B..         MOV     ?V0 + 13,R3
   \   00008D   EA           MOV     A,R2
   \   00008E   7001         JNZ     ??MT_AfIncomingMsg_5
   \   000090   EB           MOV     A,R3
   \                     ??MT_AfIncomingMsg_5:
   \   000091   7012         JNZ     ??MT_AfIncomingMsg_6
    660            {
    661              if (pItem != NULL)
   \   000093   E5..         MOV     A,?V0 + 10
   \   000095   7002         JNZ     ??MT_AfIncomingMsg_7
   \   000097   E5..         MOV     A,?V0 + 11
   \                     ??MT_AfIncomingMsg_7:
   \   000099   7003         JNZ     $+5
   \   00009B   02....       LJMP    ??MT_AfIncomingMsg_4 & 0xFFFF
    662              {
    663                (void)osal_mem_free(pItem);
   \   00009E                ; Setup parameters for call to function osal_mem_free
   \   00009E   AA..         MOV     R2,?V0 + 10
   \   0000A0   AB..         MOV     R3,?V0 + 11
   \   0000A2   02....       LJMP    ??MT_AfIncomingMsg_8 & 0xFFFF
    664              }
    665              return;
    666            }
    667            pTmp = pRsp;
    668          
    669            /* Group ID */
    670            *pTmp++ = LO_UINT16(pMsg->groupId);
   \                     ??MT_AfIncomingMsg_6:
   \   0000A5   E5..         MOV     A,?V0 + 8
   \   0000A7   2402         ADD     A,#0x2
   \   0000A9   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_31:
   \   0000AC   E0           MOVX    A,@DPTR
   \   0000AD   8A82         MOV     DPL,R2
   \   0000AF   8B83         MOV     DPH,R3
   \   0000B1   12....       LCALL   ?Subroutine25 & 0xFFFF
    671            *pTmp++ = HI_UINT16(pMsg->groupId);
   \                     ??CrossCallReturnLabel_38:
   \   0000B4   8882         MOV     DPL,R0
   \   0000B6   8983         MOV     DPH,R1
   \   0000B8   A3           INC     DPTR
   \   0000B9   12....       LCALL   ??Subroutine53_0 & 0xFFFF
    672          
    673            /* Cluster ID */
    674            *pTmp++ = LO_UINT16(pMsg->clusterId);
   \                     ??CrossCallReturnLabel_106:
   \   0000BC   2404         ADD     A,#0x4
   \   0000BE   12....       LCALL   ?Subroutine4 & 0xFFFF
    675            *pTmp++ = HI_UINT16(pMsg->clusterId);
   \                     ??CrossCallReturnLabel_0:
   \   0000C1   12....       LCALL   ?Subroutine7 & 0xFFFF
    676          
    677            if (cmd == MT_AF_INCOMING_MSG_EXT)
   \                     ??CrossCallReturnLabel_5:
   \   0000C4   7482         MOV     A,#-0x7e
   \   0000C6   65..         XRL     A,?V0 + 14
   \   0000C8   7064         JNZ     ??MT_AfIncomingMsg_9
    678            {
    679              *pTmp++ = pMsg->srcAddr.addrMode;
   \   0000CA   E5..         MOV     A,?V0 + 8
   \   0000CC   240E         ADD     A,#0xe
   \   0000CE   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   0000D1   12....       LCALL   ?Subroutine7 & 0xFFFF
    680          
    681              if (pMsg->srcAddr.addrMode == afAddr64Bit)
   \                     ??CrossCallReturnLabel_6:
   \   0000D4   8882         MOV     DPL,R0
   \   0000D6   8983         MOV     DPH,R1
   \   0000D8   E0           MOVX    A,@DPTR
   \   0000D9   6403         XRL     A,#0x3
   \   0000DB   7024         JNZ     ??MT_AfIncomingMsg_10
    682              {
    683                (void)osal_memcpy(pTmp, pMsg->srcAddr.addr.extAddr, Z_EXTADDR_LEN);
   \   0000DD                ; Setup parameters for call to function osal_memcpy
   \   0000DD   E5..         MOV     A,?V0 + 8
   \   0000DF   2406         ADD     A,#0x6
   \   0000E1   F5..         MOV     ?V0 + 4,A
   \   0000E3   E5..         MOV     A,?V0 + 9
   \   0000E5   3400         ADDC    A,#0x0
   \   0000E7   F5..         MOV     ?V0 + 5,A
   \   0000E9   75..00       MOV     ?V0 + 6,#0x0
   \   0000EC   78..         MOV     R0,#?V0 + 4
   \   0000EE   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000F1   7C08         MOV     R4,#0x8
   \   0000F3   7D00         MOV     R5,#0x0
   \   0000F5   AA..         MOV     R2,?V0 + 2
   \   0000F7   AB..         MOV     R3,?V0 + 3
   \   0000F9   12....       LCALL   ??Subroutine54_0 & 0xFFFF
    684              }
   \                     ??CrossCallReturnLabel_117:
   \   0000FC   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000FF   8015         SJMP    ??MT_AfIncomingMsg_11
    685              else
    686              {
    687                pTmp[0] = LO_UINT16(pMsg->srcAddr.addr.shortAddr);
   \                     ??MT_AfIncomingMsg_10:
   \   000101   E5..         MOV     A,?V0 + 8
   \   000103   2406         ADD     A,#0x6
   \   000105   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_33:
   \   000108   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   00010B   F0           MOVX    @DPTR,A
    688                pTmp[1] = HI_UINT16(pMsg->srcAddr.addr.shortAddr);
   \   00010C   8882         MOV     DPL,R0
   \   00010E   8983         MOV     DPH,R1
   \   000110   A3           INC     DPTR
   \   000111   12....       LCALL   ?Subroutine14 & 0xFFFF
    689              }
   \                     ??CrossCallReturnLabel_20:
   \   000114   A3           INC     DPTR
   \   000115   F0           MOVX    @DPTR,A
    690              pTmp += Z_EXTADDR_LEN;
   \                     ??MT_AfIncomingMsg_11:
   \   000116   E5..         MOV     A,?V0 + 2
   \   000118   2408         ADD     A,#0x8
   \   00011A   F5..         MOV     ?V0 + 2,A
   \   00011C   E5..         MOV     A,?V0 + 3
   \   00011E   3400         ADDC    A,#0x0
   \   000120   F5..         MOV     ?V0 + 3,A
    691          
    692              *pTmp++ = pMsg->srcAddr.endPoint;
   \   000122   E5..         MOV     A,?V0 + 8
   \   000124   240F         ADD     A,#0xf
   \   000126   12....       LCALL   ?Subroutine13 & 0xFFFF
    693          #if defined INTER_PAN
    694              *pTmp++ = LO_UINT16(pMsg->srcAddr.panId);
    695              *pTmp++ = HI_UINT16(pMsg->srcAddr.panId);
    696          #else
    697              *pTmp++ = 0;
   \                     ??CrossCallReturnLabel_17:
   \   000129   E4           CLR     A
   \   00012A   F0           MOVX    @DPTR,A
   \   00012B   A3           INC     DPTR
    698              *pTmp++ = 0;
   \   00012C   8017         SJMP    ??CrossCallReturnLabel_21
    699          #endif
    700            }
    701            else
    702            {
    703              /* Source Address */
    704              *pTmp++ = LO_UINT16(pMsg->srcAddr.addr.shortAddr);
   \                     ??MT_AfIncomingMsg_9:
   \   00012E   E5..         MOV     A,?V0 + 8
   \   000130   2406         ADD     A,#0x6
   \   000132   12....       LCALL   ?Subroutine4 & 0xFFFF
    705              *pTmp++ = HI_UINT16(pMsg->srcAddr.addr.shortAddr);
    706          
    707              /* Source EP */
    708              *pTmp++ = pMsg->srcAddr.endPoint;
    709            }
   \                     ??CrossCallReturnLabel_1:
   \   000135   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_107:
   \   000138   240F         ADD     A,#0xf
   \   00013A   F582         MOV     DPL,A
   \   00013C   E5..         MOV     A,?V0 + 9
   \   00013E   3400         ADDC    A,#0x0
   \   000140   F583         MOV     DPH,A
   \   000142   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   000145   12....       LCALL   ?Subroutine25 & 0xFFFF
    710          
    711            /* Destination EP */
    712            *pTmp++ = pMsg->endPoint;
   \                     ??CrossCallReturnLabel_39:
   \   000148   E5..         MOV     A,?V0 + 8
   \   00014A   2414         ADD     A,#0x14
   \   00014C   12....       LCALL   ?Subroutine1 & 0xFFFF
    713          
    714            /* WasBroadCast */
    715            *pTmp++ = pMsg->wasBroadcast;
   \                     ??CrossCallReturnLabel_102:
   \   00014F   2415         ADD     A,#0x15
   \   000151   12....       LCALL   ?Subroutine1 & 0xFFFF
    716          
    717            /* LinkQuality */
    718            *pTmp++ = pMsg->LinkQuality;
   \                     ??CrossCallReturnLabel_103:
   \   000154   2416         ADD     A,#0x16
   \   000156   12....       LCALL   ?Subroutine1 & 0xFFFF
    719          
    720            /* SecurityUse */
    721            *pTmp++ = pMsg->SecurityUse;
   \                     ??CrossCallReturnLabel_104:
   \   000159   2419         ADD     A,#0x19
   \   00015B   12....       LCALL   ?Subroutine1 & 0xFFFF
    722          
    723            /* Timestamp */
    724            *pTmp++ = BREAK_UINT32(pMsg->timestamp, 0);
   \                     ??CrossCallReturnLabel_105:
   \   00015E   241A         ADD     A,#0x1a
   \   000160   FA           MOV     R2,A
   \   000161   E5..         MOV     A,?V0 + 9
   \   000163   3400         ADDC    A,#0x0
   \   000165   FB           MOV     R3,A
   \   000166   8A82         MOV     DPL,R2
   \   000168   8B83         MOV     DPH,R3
   \   00016A   78..         MOV     R0,#?V0 + 4
   \   00016C   12....       LCALL   ?L_MOV_X
   \   00016F   12....       LCALL   ?Subroutine24 & 0xFFFF
    725            *pTmp++ = BREAK_UINT32(pMsg->timestamp, 1);
   \                     ??CrossCallReturnLabel_97:
   \   000172   12....       LCALL   ?L_MOV_X
   \   000175   E5..         MOV     A,?V0 + 5
   \   000177   85..82       MOV     DPL,?V0 + 2
   \   00017A   85..83       MOV     DPH,?V0 + 3
   \   00017D   12....       LCALL   ??Subroutine51_0 & 0xFFFF
    726            *pTmp++ = BREAK_UINT32(pMsg->timestamp, 2);
   \                     ??CrossCallReturnLabel_99:
   \   000180   12....       LCALL   ?L_MOV_X
   \   000183   7410         MOV     A,#0x10
   \   000185   78..         MOV     R0,#?V0 + 4
   \   000187   12....       LCALL   ?UL_SHR
   \   00018A   12....       LCALL   ?Subroutine24 & 0xFFFF
    727            *pTmp++ = BREAK_UINT32(pMsg->timestamp, 3);
   \                     ??CrossCallReturnLabel_98:
   \   00018D   12....       LCALL   ?L_MOV_X
   \   000190   7418         MOV     A,#0x18
   \   000192   78..         MOV     R0,#?V0 + 4
   \   000194   12....       LCALL   ?UL_SHR
   \   000197   85..82       MOV     DPL,?V0 + 2
   \   00019A   85..83       MOV     DPH,?V0 + 3
   \   00019D   E5..         MOV     A,?V0 + 4
   \   00019F   12....       LCALL   ?Subroutine25 & 0xFFFF
    728          
    729          
    730            /* Data Length */
    731            if (cmd == MT_AF_INCOMING_MSG_EXT)
   \                     ??CrossCallReturnLabel_40:
   \   0001A2   7482         MOV     A,#-0x7e
   \   0001A4   65..         XRL     A,?V0 + 14
   \   0001A6   7009         JNZ     ??MT_AfIncomingMsg_12
    732            {
    733              /* Z-Tool apparently takes the last Byte before the data buffer as the dynamic length and
    734               * ignores the bigger UInt16 length of an EXT incoming message. But no data bytes will be sent
    735               * with a huge message, so it's necessary to work-around and fake-out Z-Tool with a zero here.
    736               */
    737              *pTmp++ = 0;  // TODO - workaround Z-Tool shortcoming; should be: = pMsg->cmd.TransSeqNumber;
   \   0001A8   E4           CLR     A
   \   0001A9   F0           MOVX    @DPTR,A
   \   0001AA   A3           INC     DPTR
    738              *pTmp++ = LO_UINT16(dataLen);
   \   0001AB   EE           MOV     A,R6
   \   0001AC   F0           MOVX    @DPTR,A
   \   0001AD   A3           INC     DPTR
    739              *pTmp++ = HI_UINT16(dataLen);
   \   0001AE   EF           MOV     A,R7
   \   0001AF   8008         SJMP    ??MT_AfIncomingMsg_13
    740            }
    741            else
    742            {
    743              *pTmp++ = pMsg->cmd.TransSeqNumber;
   \                     ??MT_AfIncomingMsg_12:
   \   0001B1   E5..         MOV     A,?V0 + 8
   \   0001B3   241E         ADD     A,#0x1e
   \   0001B5   12....       LCALL   ?Subroutine13 & 0xFFFF
    744              *pTmp++ = dataLen;
   \                     ??CrossCallReturnLabel_18:
   \   0001B8   EE           MOV     A,R6
    745            }
   \                     ??MT_AfIncomingMsg_13:
   \   0001B9   12....       LCALL   ?Subroutine25 & 0xFFFF
    746          
    747            /* Data */
    748            if (pItem != NULL)
   \                     ??CrossCallReturnLabel_41:
   \   0001BC   E5..         MOV     A,?V0 + 10
   \   0001BE   7002         JNZ     ??MT_AfIncomingMsg_14
   \   0001C0   E5..         MOV     A,?V0 + 11
   \                     ??MT_AfIncomingMsg_14:
   \   0001C2   6076         JZ      ??MT_AfIncomingMsg_15
    749            {
    750              // Enqueue the new huge incoming item.
    751              pItem->next = pMtAfInMsgList;
   \   0001C4   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_122:
   \   0001C7   85..82       MOV     DPL,?V0 + 10
   \   0001CA   85..83       MOV     DPH,?V0 + 11
   \   0001CD   12....       LCALL   ?Subroutine31 & 0xFFFF
    752              pMtAfInMsgList = pItem;
   \                     ??CrossCallReturnLabel_62:
   \   0001D0   90....       MOV     DPTR,#pMtAfInMsgList
   \   0001D3   E5..         MOV     A,?V0 + 10
   \   0001D5   F0           MOVX    @DPTR,A
   \   0001D6   A3           INC     DPTR
   \   0001D7   E5..         MOV     A,?V0 + 11
   \   0001D9   F0           MOVX    @DPTR,A
    753          
    754              // Setup to time-out the huge incoming item if host does not MT_AF_DATA_RETRIEVE it.
    755              pItem->tick = MT_AF_EXEC_CNT;
   \   0001DA   740F         MOV     A,#0xf
   \   0001DC   85..82       MOV     DPL,?V0 + 10
   \   0001DF   85..83       MOV     DPH,?V0 + 11
   \   0001E2   A3           INC     DPTR
   \   0001E3   A3           INC     DPTR
   \   0001E4   A3           INC     DPTR
   \   0001E5   A3           INC     DPTR
   \   0001E6   A3           INC     DPTR
   \   0001E7   A3           INC     DPTR
   \   0001E8   A3           INC     DPTR
   \   0001E9   A3           INC     DPTR
   \   0001EA   12....       LCALL   ?Subroutine11 & 0xFFFF
    756              if (ZSuccess != osal_start_timerEx(MT_TaskID, MT_AF_EXEC_EVT, MT_AF_EXEC_DLY))
   \                     ??CrossCallReturnLabel_90:
   \   0001ED   6003         JZ      ??CrossCallReturnLabel_26
    757              {
    758                (void)osal_set_event(MT_TaskID, MT_AF_EXEC_EVT);
   \   0001EF                ; Setup parameters for call to function osal_set_event
   \   0001EF   12....       LCALL   ?Subroutine17 & 0xFFFF
    759              }
    760          
    761              pItem->timestamp = pMsg->timestamp;
   \                     ??CrossCallReturnLabel_26:
   \   0001F2   E5..         MOV     A,?V0 + 8
   \   0001F4   241A         ADD     A,#0x1a
   \   0001F6   F582         MOV     DPL,A
   \   0001F8   E5..         MOV     A,?V0 + 9
   \   0001FA   3400         ADDC    A,#0x0
   \   0001FC   F583         MOV     DPH,A
   \   0001FE   78..         MOV     R0,#?V0 + 4
   \   000200   12....       LCALL   ?L_MOV_X
   \   000203   85..82       MOV     DPL,?V0 + 10
   \   000206   85..83       MOV     DPH,?V0 + 11
   \   000209   A3           INC     DPTR
   \   00020A   A3           INC     DPTR
   \   00020B   A3           INC     DPTR
   \   00020C   A3           INC     DPTR
   \   00020D   E5..         MOV     A,?V0 + 4
   \   00020F   F0           MOVX    @DPTR,A
   \   000210   A3           INC     DPTR
   \   000211   E5..         MOV     A,?V0 + 5
   \   000213   F0           MOVX    @DPTR,A
   \   000214   A3           INC     DPTR
   \   000215   E5..         MOV     A,?V0 + 6
   \   000217   F0           MOVX    @DPTR,A
   \   000218   A3           INC     DPTR
   \   000219   E5..         MOV     A,?V0 + 7
   \   00021B   F0           MOVX    @DPTR,A
    762              (void)osal_memcpy(pItem->data, pMsg->cmd.Data, dataLen);
   \   00021C                ; Setup parameters for call to function osal_memcpy
   \   00021C   12....       LCALL   ?Subroutine19 & 0xFFFF
    763            }
   \                     ??CrossCallReturnLabel_27:
   \   00021F   75..00       MOV     ?V0 + 6,#0x0
   \   000222   78..         MOV     R0,#?V0 + 4
   \   000224   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000227   EE           MOV     A,R6
   \   000228   FC           MOV     R4,A
   \   000229   EF           MOV     A,R7
   \   00022A   FD           MOV     R5,A
   \   00022B   85..82       MOV     DPL,?V0 + 10
   \   00022E   85..83       MOV     DPH,?V0 + 11
   \   000231   A3           INC     DPTR
   \   000232   A3           INC     DPTR
   \   000233   E0           MOVX    A,@DPTR
   \   000234   FA           MOV     R2,A
   \   000235   A3           INC     DPTR
   \   000236   E0           MOVX    A,@DPTR
   \   000237   FB           MOV     R3,A
   \   000238   8010         SJMP    ??MT_AfIncomingMsg_16
    764            else
    765            {
    766              (void)osal_memcpy(pTmp, pMsg->cmd.Data, dataLen);
   \                     ??MT_AfIncomingMsg_15:
   \   00023A                ; Setup parameters for call to function osal_memcpy
   \   00023A   12....       LCALL   ?Subroutine19 & 0xFFFF
    767            }
   \                     ??CrossCallReturnLabel_28:
   \   00023D   78..         MOV     R0,#?V0 + 4
   \   00023F   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000242   EE           MOV     A,R6
   \   000243   FC           MOV     R4,A
   \   000244   EF           MOV     A,R7
   \   000245   FD           MOV     R5,A
   \   000246   AA..         MOV     R2,?V0 + 2
   \   000248   AB..         MOV     R3,?V0 + 3
   \                     ??MT_AfIncomingMsg_16:
   \   00024A   12....       LCALL   ??Subroutine54_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_118:
   \   00024D   12....       LCALL   ?DEALLOC_XSTACK8
    768          
    769            /* Build and send back the response */
    770            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ|(uint8)MT_RPC_SYS_AF), cmd, respLen, pRsp);
   \   000250                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000250   AC..         MOV     R4,?V0 + 12
   \   000252   AD..         MOV     R5,?V0 + 13
   \   000254   AB..         MOV     R3,?V0 + 0
   \   000256   AA..         MOV     R2,?V0 + 14
   \   000258   7944         MOV     R1,#0x44
   \   00025A   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    771          
    772            (void)osal_mem_free(pRsp);
   \   00025D                ; Setup parameters for call to function osal_mem_free
   \   00025D   AA..         MOV     R2,?V0 + 12
   \   00025F   AB..         MOV     R3,?V0 + 13
   \                     ??MT_AfIncomingMsg_8:
   \   000261   12....       LCALL   ??osal_mem_free?relay
    773          }
   \                     ??MT_AfIncomingMsg_4:
   \   000264   7F0F         MOV     R7,#0xf
   \   000266   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_100:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine40:
   \   000000   12....       LCALL   ?Subroutine44 & 0xFFFF
   \                     ??CrossCallReturnLabel_111:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   85..82       MOV     DPL,?V0 + 2
   \   000003   85..83       MOV     DPH,?V0 + 3
   \   000006   E5..         MOV     A,?V0 + 4
   \   000008                REQUIRE ??Subroutine51_0
   \   000008                ; // Fall through to label ??Subroutine51_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine51_0:
   \   000000   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_101:
   \   000003   8A82         MOV     DPL,R2
   \   000005   8B83         MOV     DPH,R3
   \   000007   78..         MOV     R0,#?V0 + 4
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   F8           MOV     R0,A
   \   000001   12....       LCALL   ?Subroutine43 & 0xFFFF
   \                     ??CrossCallReturnLabel_136:
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine43:
   \   000000   E5..         MOV     A,?V0 + 9
   \   000002                REQUIRE ??Subroutine52_0
   \   000002                ; // Fall through to label ??Subroutine52_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   E5..         MOV     A,?V0 + 8
   \   000002   2421         ADD     A,#0x21
   \   000004   F582         MOV     DPL,A
   \   000006   E5..         MOV     A,?V0 + 9
   \   000008   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_75:
   \   00000B   F5..         MOV     ?V0 + 4,A
   \   00000D   A3           INC     DPTR
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   F5..         MOV     ?V0 + 5,A
   \   000011   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   85..82       MOV     DPL,?V0 + 2
   \   000004   85..83       MOV     DPH,?V0 + 3
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   F582         MOV     DPL,A
   \   000002   E5..         MOV     A,?V0 + 9
   \   000004   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_74:
   \   000007   85..82       MOV     DPL,?V0 + 2
   \   00000A   85..83       MOV     DPH,?V0 + 3
   \   00000D   F0           MOVX    @DPTR,A
   \   00000E   A3           INC     DPTR
   \   00000F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_109:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine36:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   85..82       MOV     DPL,?V0 + 2
   \   000004   85..83       MOV     DPH,?V0 + 3
   \   000007   12....       LCALL   ?Subroutine44 & 0xFFFF
   \                     ??CrossCallReturnLabel_112:
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine44:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   8582..       MOV     ?V0 + 2,DPL
   \   000005   8583..       MOV     ?V0 + 3,DPH
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   08           INC     R0
   \   000001   08           INC     R0
   \   000002   12....       LCALL   ?Subroutine43 & 0xFFFF
   \                     ??CrossCallReturnLabel_135:
   \   000005   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_108:
   \   000008   8882         MOV     DPL,R0
   \   00000A   8983         MOV     DPH,R1
   \   00000C   A3           INC     DPTR
   \   00000D   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   F582         MOV     DPL,A
   \   000002   E5..         MOV     A,?V0 + 9
   \   000004   3400         ADDC    A,#0x0
   \   000006   F583         MOV     DPH,A
   \   000008                REQUIRE ??Subroutine53_0
   \   000008                ; // Fall through to label ??Subroutine53_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine53_0:
   \   000000   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_110:
   \   000003   E5..         MOV     A,?V0 + 8
   \   000005   22           RET
    774          
    775          /**************************************************************************************************
    776           * @fn          MT_AfDataRetrieve
    777           *
    778           * @brief   Process AF Data Retrieve command to incrementally read out a very large
    779           *          incoming AF message.
    780           *
    781           * input parameters
    782           *
    783           * @param pBuf - pointer to the received buffer
    784           *
    785           * output parameters
    786           *
    787           * @param rtrn - AF-Status of the operation.
    788           *
    789           * @return      None.
    790           **************************************************************************************************
    791           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    792          void MT_AfDataRetrieve(uint8 *pBuf)
   \                     MT_AfDataRetrieve:
    793          {
   \   000000   74EB         MOV     A,#-0x15
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 21
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
    794            #define MT_AF_RTV_HDR_SZ  2
    795          
    796            uint32 timestamp;
    797            mtAfInMsgList_t *pPrev, *pItem = pMtAfInMsgList;
   \   000007   90....       MOV     DPTR,#pMtAfInMsgList
   \   00000A   12....       LCALL   ?Subroutine10 & 0xFFFF
    798            uint8 rtrn = afStatus_FAILED;
   \                     ??CrossCallReturnLabel_13:
   \   00000D   7A01         MOV     R2,#0x1
    799            uint8 len = 0;
   \   00000F   75..00       MOV     ?V0 + 12,#0x0
    800          
    801            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000012   E5..         MOV     A,?V0 + 0
   \   000014   2403         ADD     A,#0x3
   \   000016   F5..         MOV     ?V0 + 0,A
   \   000018   EB           MOV     A,R3
   \   000019   12....       LCALL   ?Subroutine22 & 0xFFFF
    802            timestamp = BUILD_UINT32(pBuf[0], pBuf[1], pBuf[2], pBuf[3]);
   \                     ??CrossCallReturnLabel_34:
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F5..         MOV     ?V0 + 4,A
   \   00001F   75..00       MOV     ?V0 + 5,#0x0
   \   000022   75..00       MOV     ?V0 + 6,#0x0
   \   000025   75..00       MOV     ?V0 + 7,#0x0
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F5..         MOV     ?V0 + 8,A
   \   00002C   75..00       MOV     ?V0 + 9,#0x0
   \   00002F   75..00       MOV     ?V0 + 10,#0x0
   \   000032   75..00       MOV     ?V0 + 11,#0x0
   \   000035   7408         MOV     A,#0x8
   \   000037   78..         MOV     R0,#?V0 + 8
   \   000039   12....       LCALL   ?L_SHL
   \   00003C   78..         MOV     R0,#?V0 + 4
   \   00003E   79..         MOV     R1,#?V0 + 8
   \   000040   12....       LCALL   ?L_ADD
   \   000043   85..82       MOV     DPL,?V0 + 0
   \   000046   85..83       MOV     DPH,?V0 + 1
   \   000049   A3           INC     DPTR
   \   00004A   A3           INC     DPTR
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   F5..         MOV     ?V0 + 8,A
   \   00004E   75..00       MOV     ?V0 + 9,#0x0
   \   000051   7410         MOV     A,#0x10
   \   000053   78..         MOV     R0,#?V0 + 8
   \   000055   12....       LCALL   ?L_SHL
   \   000058   78..         MOV     R0,#?V0 + 4
   \   00005A   79..         MOV     R1,#?V0 + 8
   \   00005C   12....       LCALL   ?L_ADD
   \   00005F   85..82       MOV     DPL,?V0 + 0
   \   000062   85..83       MOV     DPH,?V0 + 1
   \   000065   A3           INC     DPTR
   \   000066   A3           INC     DPTR
   \   000067   A3           INC     DPTR
   \   000068   E0           MOVX    A,@DPTR
   \   000069   F5..         MOV     ?V0 + 8,A
   \   00006B   75..00       MOV     ?V0 + 10,#0x0
   \   00006E   7418         MOV     A,#0x18
   \   000070   78..         MOV     R0,#?V0 + 8
   \   000072   12....       LCALL   ?L_SHL
   \   000075   78..         MOV     R0,#?V0 + 4
   \   000077   79..         MOV     R1,#?V0 + 8
   \   000079   12....       LCALL   ?L_ADD
   \   00007C   8007         SJMP    ??CrossCallReturnLabel_14
    803          
    804            while (pItem != NULL)
    805            {
    806              pPrev = pItem;
    807              if (pItem->timestamp == timestamp)
    808              {
    809                break;
    810              }
    811              pItem = pItem->next;
   \                     ??MT_AfDataRetrieve_0:
   \   00007E   8C82         MOV     DPL,R4
   \   000080   8D83         MOV     DPH,R5
   \   000082   12....       LCALL   ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000085   E5..         MOV     A,?V0 + 2
   \   000087   7002         JNZ     ??MT_AfDataRetrieve_1
   \   000089   E5..         MOV     A,?V0 + 3
   \                     ??MT_AfDataRetrieve_1:
   \   00008B   605A         JZ      ??MT_AfDataRetrieve_2
   \   00008D   AC..         MOV     R4,?V0 + 2
   \   00008F   AD..         MOV     R5,?V0 + 3
   \   000091   8C82         MOV     DPL,R4
   \   000093   8D83         MOV     DPH,R5
   \   000095   A3           INC     DPTR
   \   000096   A3           INC     DPTR
   \   000097   A3           INC     DPTR
   \   000098   A3           INC     DPTR
   \   000099   78..         MOV     R0,#?V0 + 4
   \   00009B   12....       LCALL   ?L_EQ_X
   \   00009E   70DE         JNZ     ??MT_AfDataRetrieve_0
    812            }
    813          
    814            if (pItem != NULL)
    815            {
    816              uint16 idx;
    817              uint8 *pRsp;
    818          
    819              pBuf += 4;
   \   0000A0   E5..         MOV     A,?V0 + 0
   \   0000A2   2404         ADD     A,#0x4
   \   0000A4   F5..         MOV     ?V0 + 0,A
   \   0000A6   E5..         MOV     A,?V0 + 1
   \   0000A8   12....       LCALL   ?Subroutine22 & 0xFFFF
    820              idx = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_35:
   \   0000AB   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_96:
   \   0000AE   F5..         MOV     ?V0 + 4,A
   \   0000B0   E9           MOV     A,R1
   \   0000B1   F5..         MOV     ?V0 + 5,A
    821              len = pBuf[2];
   \   0000B3   85..82       MOV     DPL,?V0 + 0
   \   0000B6   85..83       MOV     DPH,?V0 + 1
   \   0000B9   A3           INC     DPTR
   \   0000BA   A3           INC     DPTR
   \   0000BB   E0           MOVX    A,@DPTR
   \   0000BC   F5..         MOV     ?V0 + 12,A
    822          
    823              if (len == 0)  // Indication to delete the afIncomingMSGPacket.
   \   0000BE   7045         JNZ     ??MT_AfDataRetrieve_3
    824              {
    825                if (pMtAfInMsgList == pItem)
   \   0000C0   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_123:
   \   0000C3   EC           MOV     A,R4
   \   0000C4   68           XRL     A,R0
   \   0000C5   7002         JNZ     ??MT_AfDataRetrieve_4
   \   0000C7   ED           MOV     A,R5
   \   0000C8   69           XRL     A,R1
   \                     ??MT_AfDataRetrieve_4:
   \   0000C9   8C82         MOV     DPL,R4
   \   0000CB   8D83         MOV     DPH,R5
   \   0000CD   7005         JNZ     ??MT_AfDataRetrieve_5
    826                {
    827                  pMtAfInMsgList = pItem->next;
   \   0000CF   12....       LCALL   ?Subroutine15 & 0xFFFF
    828                }
   \                     ??CrossCallReturnLabel_23:
   \   0000D2   8007         SJMP    ??MT_AfDataRetrieve_6
    829                else
    830                {
    831                  pPrev->next = pItem->next;
   \                     ??MT_AfDataRetrieve_5:
   \   0000D4   12....       LCALL   ??Subroutine55_0 & 0xFFFF
    832                }
   \                     ??CrossCallReturnLabel_120:
   \   0000D7   8C82         MOV     DPL,R4
   \   0000D9   8D83         MOV     DPH,R5
   \                     ??MT_AfDataRetrieve_6:
   \   0000DB   12....       LCALL   ?Subroutine31 & 0xFFFF
    833                (void)osal_mem_free(pItem);
   \                     ??CrossCallReturnLabel_63:
   \   0000DE                ; Setup parameters for call to function osal_mem_free
   \   0000DE   AA..         MOV     R2,?V0 + 2
   \   0000E0   AB..         MOV     R3,?V0 + 3
   \   0000E2   12....       LCALL   ??osal_mem_free?relay
    834                rtrn = afStatus_SUCCESS;
   \   0000E5   7A00         MOV     R2,#0x0
    835              }
    836              else if ((pRsp = osal_mem_alloc(len + MT_AF_RTV_HDR_SZ)) == NULL)
    837              {
    838                rtrn = afStatus_MEM_FAIL;
    839                len = 0;
    840              }
    841              else
    842              {
    843                pRsp[0] = ZSuccess;
    844                pRsp[1] = len;
    845                (void)osal_memcpy(pRsp + MT_AF_RTV_HDR_SZ, pItem->data+idx, len);
    846                MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), 
    847                                                     MT_AF_DATA_RETRIEVE, len + MT_AF_RTV_HDR_SZ, pRsp);
    848                (void)osal_mem_free(pRsp);
    849                return;
    850              }
    851            }
    852          
    853            pBuf[0] = rtrn;
   \                     ??MT_AfDataRetrieve_2:
   \   0000E7   EA           MOV     A,R2
   \   0000E8   85..82       MOV     DPL,?V0 + 0
   \   0000EB   85..83       MOV     DPH,?V0 + 1
   \   0000EE   F0           MOVX    @DPTR,A
    854            pBuf[1] = len;
   \   0000EF   A3           INC     DPTR
   \   0000F0   E5..         MOV     A,?V0 + 12
   \   0000F2   F0           MOVX    @DPTR,A
    855            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), 
    856                                                 MT_AF_DATA_RETRIEVE, MT_AF_RTV_HDR_SZ, pBuf);
   \   0000F3                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000F3   AC..         MOV     R4,?V0 + 0
   \   0000F5   AD..         MOV     R5,?V0 + 1
   \   0000F7   7B02         MOV     R3,#0x2
   \   0000F9   7A12         MOV     R2,#0x12
   \   0000FB   7964         MOV     R1,#0x64
   \   0000FD   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    857          }
   \                     ??MT_AfDataRetrieve_7:
   \   000100   7F0D         MOV     R7,#0xd
   \   000102   02....       LJMP    ?BANKED_LEAVE_XDATA
   \                     ??MT_AfDataRetrieve_3:
   \   000105                ; Setup parameters for call to function osal_mem_alloc
   \   000105   F5..         MOV     ?V0 + 6,A
   \   000107   7402         MOV     A,#0x2
   \   000109   25..         ADD     A,?V0 + 6
   \   00010B   FA           MOV     R2,A
   \   00010C   E4           CLR     A
   \   00010D   3400         ADDC    A,#0x0
   \   00010F   FB           MOV     R3,A
   \   000110   12....       LCALL   ??osal_mem_alloc?relay
   \   000113   8A..         MOV     ?V0 + 6,R2
   \   000115   8B..         MOV     ?V0 + 7,R3
   \   000117   AE..         MOV     R6,?V0 + 6
   \   000119   AF..         MOV     R7,?V0 + 7
   \   00011B   EE           MOV     A,R6
   \   00011C   7001         JNZ     ??MT_AfDataRetrieve_8
   \   00011E   EF           MOV     A,R7
   \                     ??MT_AfDataRetrieve_8:
   \   00011F   7007         JNZ     ??MT_AfDataRetrieve_9
   \   000121   7A10         MOV     R2,#0x10
   \   000123   75..00       MOV     ?V0 + 12,#0x0
   \   000126   80BF         SJMP    ??MT_AfDataRetrieve_2
   \                     ??MT_AfDataRetrieve_9:
   \   000128   E4           CLR     A
   \   000129   8E82         MOV     DPL,R6
   \   00012B   8F83         MOV     DPH,R7
   \   00012D   F0           MOVX    @DPTR,A
   \   00012E   A3           INC     DPTR
   \   00012F   E5..         MOV     A,?V0 + 12
   \   000131   F0           MOVX    @DPTR,A
   \   000132                ; Setup parameters for call to function osal_memcpy
   \   000132   85..82       MOV     DPL,?V0 + 2
   \   000135   85..83       MOV     DPH,?V0 + 3
   \   000138   A3           INC     DPTR
   \   000139   A3           INC     DPTR
   \   00013A   E0           MOVX    A,@DPTR
   \   00013B   25..         ADD     A,?V0 + 4
   \   00013D   F5..         MOV     ?V0 + 0,A
   \   00013F   A3           INC     DPTR
   \   000140   E0           MOVX    A,@DPTR
   \   000141   35..         ADDC    A,?V0 + 5
   \   000143   F5..         MOV     ?V0 + 1,A
   \   000145   75..00       MOV     ?V0 + 2,#0x0
   \   000148   78..         MOV     R0,#?V0 + 0
   \   00014A   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00014D   AC..         MOV     R4,?V0 + 12
   \   00014F   7D00         MOV     R5,#0x0
   \   000151   EE           MOV     A,R6
   \   000152   2402         ADD     A,#0x2
   \   000154   0A           INC     R2
   \   000155   0A           INC     R2
   \   000156   EF           MOV     A,R7
   \   000157   3400         ADDC    A,#0x0
   \   000159   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_113:
   \   00015C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00015F                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00015F   EE           MOV     A,R6
   \   000160   FC           MOV     R4,A
   \   000161   EF           MOV     A,R7
   \   000162   FD           MOV     R5,A
   \   000163   7402         MOV     A,#0x2
   \   000165   25..         ADD     A,?V0 + 12
   \   000167   FB           MOV     R3,A
   \   000168   7A12         MOV     R2,#0x12
   \   00016A   7964         MOV     R1,#0x64
   \   00016C   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   00016F                ; Setup parameters for call to function osal_mem_free
   \   00016F   EE           MOV     A,R6
   \   000170   FA           MOV     R2,A
   \   000171   EF           MOV     A,R7
   \   000172   FB           MOV     R3,A
   \   000173   12....       LCALL   ??osal_mem_free?relay
   \   000176   8088         SJMP    ??MT_AfDataRetrieve_7

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine33:
   \   000000   FB           MOV     R3,A
   \   000001                REQUIRE ??Subroutine54_0
   \   000001                ; // Fall through to label ??Subroutine54_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F5..         MOV     ?V0 + 1,A
   \   000004   85..82       MOV     DPL,?V0 + 0
   \   000007   F583         MOV     DPH,A
   \   000009   22           RET
    858          
    859          /**************************************************************************************************
    860           * @fn          MT_AfDataStore
    861           *
    862           * @brief   Process AF Data Store command to incrementally store the data buffer for very large
    863           *          outgoing AF message.
    864           *
    865           * input parameters
    866           *
    867           * @param pBuf - pointer to the received buffer
    868           *
    869           * output parameters
    870           *
    871           * @param rtrn - AF-Status of the operation.
    872           *
    873           * @return      None.
    874           **************************************************************************************************
    875           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    876          void MT_AfDataStore(uint8 *pBuf)
   \                     MT_AfDataStore:
    877          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    878            uint16 idx;
    879            uint8 len, rtrn = afStatus_FAILED;
   \   00000A   7401         MOV     A,#0x1
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   F0           MOVX    @DPTR,A
    880          
    881            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000013   EA           MOV     A,R2
   \   000014   2403         ADD     A,#0x3
   \   000016   0A           INC     R2
   \   000017   0A           INC     R2
   \   000018   0A           INC     R2
   \   000019   EB           MOV     A,R3
   \   00001A   12....       LCALL   ?Subroutine20 & 0xFFFF
    882            idx = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_29:
   \   00001D   F8           MOV     R0,A
   \   00001E   E4           CLR     A
   \   00001F   C8           XCH     A,R0
   \   000020   F9           MOV     R1,A
   \   000021   EC           MOV     A,R4
   \   000022   FE           MOV     R6,A
   \   000023   E9           MOV     A,R1
   \   000024   FF           MOV     R7,A
    883            len = pBuf[2];
   \   000025   8A82         MOV     DPL,R2
   \   000027   8B83         MOV     DPH,R3
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   FC           MOV     R4,A
    884            pBuf += 3;
   \   00002D   EA           MOV     A,R2
   \   00002E   2403         ADD     A,#0x3
   \   000030   0A           INC     R2
   \   000031   0A           INC     R2
   \   000032   0A           INC     R2
   \   000033   EB           MOV     A,R3
   \   000034   3400         ADDC    A,#0x0
   \   000036   FB           MOV     R3,A
    885          
    886            if (pMtAfDataReq == NULL)
   \   000037   90....       MOV     DPTR,#pMtAfDataReq
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   7002         JNZ     ??MT_AfDataStore_0
   \   00003D   A3           INC     DPTR
   \   00003E   E0           MOVX    A,@DPTR
   \                     ??MT_AfDataStore_0:
   \   00003F   7005         JNZ     ??MT_AfDataStore_1
    887            {
    888              rtrn = afStatus_MEM_FAIL;
   \   000041   7410         MOV     A,#0x10
   \   000043   02....       LJMP    ??MT_AfDataStore_2 & 0xFFFF
    889            }
    890            else if (len == 0)  // Indication to send the message.
   \                     ??MT_AfDataStore_1:
   \   000046   EC           MOV     A,R4
   \   000047   706A         JNZ     ??MT_AfDataStore_3
    891            {
    892              rtrn = AF_DataRequest(&(pMtAfDataReq->dstAddr), pMtAfDataReq->epDesc, pMtAfDataReq->cId, 
    893                                      pMtAfDataReq->dataLen,  pMtAfDataReq->data, 
    894                                    &(pMtAfDataReq->transId), pMtAfDataReq->txOpts, pMtAfDataReq->radius);
   \   000049                ; Setup parameters for call to function AF_DataRequest
   \   000049   90....       MOV     DPTR,#pMtAfDataReq
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   2416         ADD     A,#0x16
   \   00004F   12....       LCALL   ??Subroutine46_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_79:
   \   000052   F5..         MOV     ?V0 + 0,A
   \   000054   78..         MOV     R0,#?V0 + 0
   \   000056   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000059   90....       MOV     DPTR,#pMtAfDataReq
   \   00005C   E0           MOVX    A,@DPTR
   \   00005D   2414         ADD     A,#0x14
   \   00005F   F5..         MOV     ?V0 + 0,A
   \   000061   A3           INC     DPTR
   \   000062   E0           MOVX    A,@DPTR
   \   000063   3400         ADDC    A,#0x0
   \   000065   F5..         MOV     ?V0 + 1,A
   \   000067   78..         MOV     R0,#?V0 + 0
   \   000069   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006C   12....       LCALL   ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   00006F   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000072   90....       MOV     DPTR,#pMtAfDataReq
   \   000075   E0           MOVX    A,@DPTR
   \   000076   2412         ADD     A,#0x12
   \   000078   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_130:
   \   00007B   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   00007E   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_132:
   \   000081   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000084   90....       MOV     DPTR,#pMtAfDataReq
   \   000087   E0           MOVX    A,@DPTR
   \   000088   2415         ADD     A,#0x15
   \   00008A   12....       LCALL   ??Subroutine46_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_80:
   \   00008D   F9           MOV     R1,A
   \   00008E   90....       MOV     DPTR,#pMtAfDataReq
   \   000091   E0           MOVX    A,@DPTR
   \   000092   240E         ADD     A,#0xe
   \   000094   FA           MOV     R2,A
   \   000095   A3           INC     DPTR
   \   000096   E0           MOVX    A,@DPTR
   \   000097   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_30:
   \   00009A   FD           MOV     R5,A
   \   00009B   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   00009E   12....       LCALL   ??AF_DataRequest?relay
   \   0000A1   7409         MOV     A,#0x9
   \   0000A3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000A6   E9           MOV     A,R1
   \   0000A7   85..82       MOV     DPL,?XSP + 0
   \   0000AA   85..83       MOV     DPH,?XSP + 1
   \   0000AD   F0           MOVX    @DPTR,A
    895              (void)osal_mem_free(pMtAfDataReq);
   \   0000AE                ; Setup parameters for call to function osal_mem_free
   \   0000AE   12....       LCALL   ?Subroutine8 & 0xFFFF
    896              pMtAfDataReq = NULL;
    897            }
   \                     ??CrossCallReturnLabel_8:
   \   0000B1   8023         SJMP    ??MT_AfDataStore_4
    898            else
    899            {
    900              (void)osal_memcpy(pMtAfDataReq->data+idx, pBuf, len);
   \                     ??MT_AfDataStore_3:
   \   0000B3                ; Setup parameters for call to function osal_memcpy
   \   0000B3   8A..         MOV     ?V0 + 0,R2
   \   0000B5   8B..         MOV     ?V0 + 1,R3
   \   0000B7   88..         MOV     ?V0 + 2,R0
   \   0000B9   78..         MOV     R0,#?V0 + 0
   \   0000BB   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000BE   7D00         MOV     R5,#0x0
   \   0000C0   12....       LCALL   ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   2E           ADD     A,R6
   \   0000C5   FA           MOV     R2,A
   \   0000C6   A3           INC     DPTR
   \   0000C7   E0           MOVX    A,@DPTR
   \   0000C8   3F           ADDC    A,R7
   \   0000C9   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_114:
   \   0000CC   12....       LCALL   ?DEALLOC_XSTACK8
    901              rtrn = afStatus_SUCCESS;
   \   0000CF   E4           CLR     A
   \                     ??MT_AfDataStore_2:
   \   0000D0   85..82       MOV     DPL,?XSP + 0
   \   0000D3   85..83       MOV     DPH,?XSP + 1
    902            }
   \                     ??MT_AfDataStore_4:
   \   0000D6   12....       LCALL   ?Subroutine28 & 0xFFFF
    903          
    904            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), 
    905                                                                          MT_AF_DATA_STORE, 1, &rtrn);
   \                     ??CrossCallReturnLabel_51:
   \   0000D9   7B01         MOV     R3,#0x1
   \   0000DB   7A11         MOV     R2,#0x11
   \   0000DD   7964         MOV     R1,#0x64
   \   0000DF   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    906          }
   \   0000E2   7401         MOV     A,#0x1
   \   0000E4   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E7   7F03         MOV     R7,#0x3
   \   0000E9   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   3400         ADDC    A,#0x0
   \   000002   FB           MOV     R3,A
   \   000003   8A82         MOV     DPL,R2
   \   000005   8B83         MOV     DPH,R3
   \   000007   E0           MOVX    A,@DPTR
   \   000008   FC           MOV     R4,A
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   22           RET

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfExec?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfExec

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfCommandProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfCommandProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfRegister?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfRegister

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfDataRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfDataRequestSrcRtg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataRequestSrcRtg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfDataConfirm?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataConfirm

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfIncomingMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfIncomingMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfDataRetrieve?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataRetrieve

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_AfDataStore?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataStore
    907          
    908          /***************************************************************************************************
    909          ***************************************************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     MT_AfCommandProcessing             0      0      9
       -> MT_AfRegister                 0      0     18
       -> MT_AfDataRequest              0      0     18
       -> MT_AfDataRetrieve             0      0     18
       -> MT_AfDataStore                0      0     18
       -> MT_AfDataRequestSrcRtg        0      0     18
     MT_AfDataConfirm                   3      0      3
       -> MT_BuildAndSendZToolResponse
                                        4      0      6
     MT_AfDataRequest                   1      0     54
       -> osal_memcpy                   0      0     78
       -> afFindEndPointDesc            0      0     72
       -> osal_mem_alloc                0      0     72
       -> osal_memcpy                   0      0     78
       -> osal_start_timerEx            0      0     72
       -> osal_set_event                0      0     72
       -> AF_DataRequest                0      0     90
       -> MT_BuildAndSendZToolResponse
                                        0      0     72
     MT_AfDataRequestSrcRtg             1      0     55
       -> osal_memset                   0      0     68
       -> afFindEndPointDesc            0      0     68
       -> osal_mem_alloc                0      0     68
       -> AF_DataRequestSrcRtg          0      0     92
       -> osal_mem_free                 0      0     68
       -> MT_BuildAndSendZToolResponse
                                        0      0     68
     MT_AfDataRetrieve                  1      0     33
       -> osal_mem_free                 0      0     42
       -> MT_BuildAndSendZToolResponse
                                        0      0     42
       -> osal_mem_alloc                0      0     42
       -> osal_memcpy                   0      0     48
       -> MT_BuildAndSendZToolResponse
                                        0      0     42
       -> osal_mem_free                 0      0     42
     MT_AfDataStore                     1      0     30
       -> AF_DataRequest                0      0     42
       -> osal_mem_free                 0      0     24
       -> osal_memcpy                   0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     24
     MT_AfExec                          0      0      9
       -> osal_mem_free                 0      0     18
       -> osal_mem_free                 0      0     18
       -> osal_mem_free                 0      0     18
       -> osal_start_timerEx            0      0     18
       -> osal_set_event                0      0     18
     MT_AfIncomingMsg                   1      0     26
       -> osal_mem_alloc                0      0     46
       -> osal_mem_alloc                0      0     46
       -> osal_mem_free                 0      0     46
       -> osal_memcpy                   0      0     52
       -> osal_start_timerEx            0      0     46
       -> osal_set_event                0      0     46
       -> osal_memcpy                   0      0     52
       -> osal_memcpy                   0      0     52
       -> MT_BuildAndSendZToolResponse
                                        0      0     46
       -> osal_mem_free                 0      0     46
     MT_AfRegister                      1      0     24
       -> osal_mem_alloc                0      0     30
       -> MT_BuildEndpointDesc          0      0     30
       -> afRegister                    0      0     30
       -> osal_mem_free                 0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     30


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     pMtAfInMsgList                    2
     pMtAfDataReq                      2
     MT_AfExec                       130
     ?Subroutine0                      5
     ?Subroutine38                     3
     ??Subroutine45_0                  6
     ?Subroutine30                     9
     ?Subroutine2                      6
     ??Subroutine46_0                  5
     ?Subroutine17                    13
     ??Subroutine49_0                 18
     ??Subroutine52_0                  8
     ?Subroutine16                     3
     ??Subroutine55_0                  6
     ?Subroutine15                     9
     ?Subroutine8                     18
     ?Subroutine37                     7
     MT_AfCommandProcessing           68
     MT_AfRegister                   135
     ?Subroutine39                     6
     ??Subroutine47_0                  7
     ?Subroutine32                     6
     MT_AfDataRequest                606
     ?Subroutine34                    13
     ?Subroutine27                     6
     ?Subroutine26                    10
     ?Subroutine41                     9
     ?Subroutine18                     4
     ??Subroutine48_0                 15
     ?Subroutine11                     1
     ?Subroutine6                     13
     ??Subroutine50_0                  7
     ?Subroutine5                     10
     ?Subroutine35                     9
     ?Subroutine31                     6
     ??Subroutine54_0                  6
     ?Subroutine10                     8
     ?Subroutine12                    13
     ?Subroutine9                     12
     ?Subroutine3                      6
     ??Subroutine56_0                  4
     MT_AfDataRequestSrcRtg          377
     ?Subroutine29                     7
     ?Subroutine23                     9
     ?Subroutine42                    10
     MT_AfDataConfirm                 66
     ?Subroutine28                    12
     MT_AfIncomingMsg                617
     ?Subroutine25                     4
     ?Subroutine40                     4
     ?Subroutine24                     8
     ??Subroutine51_0                 10
     ?Subroutine21                     5
     ?Subroutine43                     2
     ?Subroutine19                    18
     ?Subroutine14                     8
     ?Subroutine13                    16
     ?Subroutine7                      4
     ?Subroutine36                    11
     ?Subroutine44                     9
     ?Subroutine4                     14
     ?Subroutine1                      8
     ??Subroutine53_0                  6
     MT_AfDataRetrieve               376
     ?Subroutine33                     1
     ?Subroutine22                    10
     MT_AfDataStore                  236
     ?Subroutine20                    12
     ??MT_AfExec?relay                 6
     ??MT_AfCommandProcessing?relay    6
     ??MT_AfRegister?relay             6
     ??MT_AfDataRequest?relay          6
     ??MT_AfDataRequestSrcRtg?relay    6
     ??MT_AfDataConfirm?relay          6
     ??MT_AfIncomingMsg?relay          6
     ??MT_AfDataRetrieve?relay         6
     ??MT_AfDataStore?relay            6

 
 3 086 bytes in segment BANKED_CODE
    54 bytes in segment BANK_RELAYS
     4 bytes in segment XDATA_Z
 
 3 140 bytes of CODE  memory
     4 bytes of XDATA memory

Errors: none
Warnings: none
